import{a as e,u as a,r as l,o as t,b as s,e as o,f as i,t as u,y as n,n as r,M as v,I as c,J as d,N as p,K as h,s as m,j as b}from"./vendor-GAldOsJ5.js";import{_ as f}from"./index-CE9ZUSgX.js";import"./qr-DE_AbQYC.js";const y={class:"audio-visualizer"},g={class:"tool-header"},z={class:"visualizer-container"},w={class:"audio-input-section"},$={class:"input-methods"},V={class:"method-tabs"},k={class:"tab-name"},M={class:"tab-name"},x={key:0,class:"file-upload-section"},C={class:"drop-content"},A={key:1,class:"microphone-section"},U={class:"microphone-controls"},D=["disabled"],S={class:"mic-icon"},L={class:"mic-text"},T={key:0,class:"mic-error"},F={key:0,class:"audio-info"},R={class:"file-info"},E={class:"file-details"},I={class:"file-name"},q={class:"file-meta"},B={class:"file-size"},j={class:"file-type"},O={key:0,class:"audio-controls"},_={class:"player-controls"},P={class:"time-display"},W={class:"current-time"},G={class:"duration"},K={class:"progress-bar"},N=["value","max"],J={class:"volume-control"},H={class:"volume-value"},Q={class:"visualization-section"},X={class:"visualization-controls"},Y={class:"control-group"},Z={value:"bars"},ee={value:"wave"},ae={value:"circle"},le={value:"spectrum"},te={class:"control-group"},se={value:"rainbow"},oe={value:"blue"},ie={value:"red"},ue={value:"green"},ne={value:"purple"},re={class:"control-group"},ve={class:"sensitivity-value"},ce={class:"control-group"},de={class:"checkbox-label"},pe={class:"canvas-container"},he=["width","height"],me={key:0,class:"canvas-placeholder"},be={class:"placeholder-text"},fe={key:0,class:"frequency-info"},ye={class:"frequency-bands"},ge={class:"band-info"},ze={class:"band-label"},we={class:"band-meter"},$e={class:"band-value"},Ve={class:"band-info"},ke={class:"band-label"},Me={class:"band-meter"},xe={class:"band-value"},Ce={class:"band-info"},Ae={class:"band-label"},Ue={class:"band-meter"},De={class:"band-value"},Se={key:1,class:"export-section"},Le={class:"export-buttons"},Te=["disabled"],Fe=f(e({__name:"AudioVisualizer",setup(e){const{t:f}=a(),Fe=l("file"),Re=l(!1),Ee=l(null),Ie=l(null),qe=l(null),Be=l(null),je=l(null),Oe=l(null),_e=l(!1),Pe=l(0),We=l(0),Ge=l(.7),Ke=l(!1),Ne=l(!1),Je=l(null),He=l("bars"),Qe=l("rainbow"),Xe=l(1.5),Ye=l(!0),Ze=l(800),ea=l(400),aa=l(null),la=l(null),ta=l(0),sa=l(0),oa=l(0),ia=l(!1),ua=l(null),na=l([]),ra=l();t(()=>{Ke.value=!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),va(),window.addEventListener("resize",va)}),s(()=>{ka(),Je.value&&Je.value.getTracks().forEach(e=>e.stop()),window.removeEventListener("resize",va)});const va=()=>{const e=document.querySelector(".canvas-container");e&&(Ze.value=Math.min(800,e.clientWidth-40),ea.value=Math.min(400,.5*Ze.value))},ca=e=>{e.preventDefault(),Re.value=!1;const a=Array.from(e.dataTransfer?.files||[]).find(e=>e.type.startsWith("audio/"));a&&ha(a)},da=e=>{const a=e.target,l=Array.from(a.files||[]);l.length>0&&ha(l[0])},pa=()=>{ra.value?.click()},ha=async e=>{Ee.value=e,Ie.value&&(Ie.value.pause(),Ie.value=null);const a=new Audio;a.src=URL.createObjectURL(e),a.crossOrigin="anonymous",a.addEventListener("loadedmetadata",()=>{We.value=a.duration}),a.addEventListener("timeupdate",()=>{Pe.value=a.currentTime}),a.addEventListener("ended",()=>{_e.value=!1}),Ie.value=a,await ma()},ma=async()=>{try{qe.value&&qe.value.close(),qe.value=new(window.AudioContext||window.webkitAudioContext),Be.value=qe.value.createAnalyser(),Be.value.fftSize=256;const e=Be.value.frequencyBinCount;je.value=new Uint8Array(e),Ie.value&&(Oe.value=qe.value.createMediaElementSource(Ie.value),Oe.value.connect(Be.value),Be.value.connect(qe.value.destination)),Va()}catch(e){}},ba=async()=>{Ne.value?ya():await fa()},fa=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});Je.value=e,Ne.value=!0,qe.value&&qe.value.close(),qe.value=new(window.AudioContext||window.webkitAudioContext),Be.value=qe.value.createAnalyser(),Be.value.fftSize=256;const a=Be.value.frequencyBinCount;je.value=new Uint8Array(a),Oe.value=qe.value.createMediaStreamSource(e),Oe.value&&Be.value&&Oe.value.connect(Be.value),Va()}catch(e){Ne.value=!1}},ya=()=>{Je.value&&(Je.value.getTracks().forEach(e=>e.stop()),Je.value=null),Ne.value=!1,ka()},ga=()=>{Ie.value&&(_e.value?(Ie.value.pause(),_e.value=!1):(Ie.value.play(),_e.value=!0))},za=()=>{Ie.value&&(Ie.value.pause(),Ie.value.currentTime=0,Pe.value=0,_e.value=!1)},wa=e=>{if(!Ie.value)return;const a=e.target;Ie.value.currentTime=parseFloat(a.value)},$a=()=>{Ie.value&&(Ie.value.volume=Ge.value)},Va=()=>{if(!aa.value||!Be.value||!je.value)return;const e=aa.value.getContext("2d");if(!e)return;const a=()=>{if(!Be.value||!je.value)return;Be.value.getByteFrequencyData(je.value);const l=Math.floor(.1*je.value.length),t=Math.floor(.5*je.value.length);ta.value=Math.round(Ma(je.value,0,l)),sa.value=Math.round(Ma(je.value,l,t)),oa.value=Math.round(Ma(je.value,t,je.value.length)),xa(e,je.value),la.value=requestAnimationFrame(a)};a()},ka=()=>{la.value&&(cancelAnimationFrame(la.value),la.value=null)},Ma=(e,a,l)=>{let t=0;for(let s=a;s<l;s++)t+=e[s];return t/(l-a)/255*100},xa=(e,a)=>{const l=Ze.value,t=ea.value;switch(e.clearRect(0,0,l,t),He.value){case"bars":Ca(e,a,l,t);break;case"wave":Aa(e,a,l,t);break;case"circle":Ua(e,a,l,t);break;case"spectrum":Da(e,a,l,t)}},Ca=(e,a,l,t)=>{const s=l/a.length;for(let o=0;o<a.length;o++){const l=a[o]/255*t*Xe.value,i=o*s,u=t-l;e.fillStyle=Sa(o,a.length),e.fillRect(i,u,s-1,l)}},Aa=(e,a,l,t)=>{e.beginPath(),e.strokeStyle=Sa(0,1),e.lineWidth=2;const s=l/a.length;let o=0;for(let i=0;i<a.length;i++){const l=t/2+(a[i]/255*Xe.value-.5)*t;0===i?e.moveTo(o,l):e.lineTo(o,l),o+=s}e.stroke()},Ua=(e,a,l,t)=>{const s=l/2,o=t/2,i=Math.min(l,t)/4;e.beginPath(),e.arc(s,o,i,0,2*Math.PI),e.strokeStyle="#333",e.stroke();for(let u=0;u<a.length;u++){const l=u/a.length*2*Math.PI,t=a[u]/255*i*Xe.value,n=s+Math.cos(l)*i,r=o+Math.sin(l)*i,v=s+Math.cos(l)*(i+t),c=o+Math.sin(l)*(i+t);e.beginPath(),e.moveTo(n,r),e.lineTo(v,c),e.strokeStyle=Sa(u,a.length),e.lineWidth=2,e.stroke()}},Da=(e,a,l,t)=>{const s=e.createImageData(l,t);for(let o=0;o<l;o++){const e=a[Math.floor(o/l*a.length)]/255*Xe.value;for(let a=0;a<t;a++){const i=4*(a*l+o),u=a<t*e?255:0,n=La(o,l);s.data[i]=n.r*(u/255),s.data[i+1]=n.g*(u/255),s.data[i+2]=n.b*(u/255),s.data[i+3]=255}}e.putImageData(s,0,0)},Sa=(e,a)=>{const l=e/a*360;switch(Qe.value){case"rainbow":default:return`hsl(${l}, 70%, 50%)`;case"blue":return`hsl(240, 70%, ${50+e/a*30}%)`;case"red":return`hsl(0, 70%, ${50+e/a*30}%)`;case"green":return`hsl(120, 70%, ${50+e/a*30}%)`;case"purple":return`hsl(280, 70%, ${50+e/a*30}%)`}},La=(e,a)=>{const l=e/a*360,t=.7*(1-Math.abs(0)),s=t*(1-Math.abs(l/60%2-1)),o=.5-t/2;let i=0,u=0,n=0;return l>=0&&l<60?(i=t,u=s,n=0):l>=60&&l<120?(i=s,u=t,n=0):l>=120&&l<180?(i=0,u=t,n=s):l>=180&&l<240?(i=0,u=s,n=t):l>=240&&l<300?(i=s,u=0,n=t):l>=300&&l<360&&(i=t,u=0,n=s),{r:Math.round(255*(i+o)),g:Math.round(255*(u+o)),b:Math.round(255*(n+o))}},Ta=()=>{},Fa=()=>{if(!aa.value)return;const e=document.createElement("a");e.download=`audio-visualization-${Date.now()}.png`,e.href=aa.value.toDataURL(),e.click()},Ra=async()=>{if(aa.value)try{const e=aa.value.captureStream(30);ua.value=new MediaRecorder(e,{mimeType:"video/webm;codecs=vp9"}),na.value=[],ua.value.ondataavailable=e=>{e.data.size>0&&na.value.push(e.data)},ua.value.onstop=()=>{const e=new Blob(na.value,{type:"video/webm"}),a=URL.createObjectURL(e),l=document.createElement("a");l.download=`audio-visualization-${Date.now()}.webm`,l.href=a,l.click(),URL.revokeObjectURL(a)},ua.value.start(),ia.value=!0}catch(e){}},Ea=()=>{ua.value&&ia.value&&(ua.value.stop(),ia.value=!1)},Ia=e=>{if(0===e)return"0 B";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(1))+" "+["B","KB","MB","GB"][a]},qa=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`;return(e,a)=>{return b(),o("div",y,[i("div",g,[i("h1",null,u(e.$t("tools.audioVisualizer.title")),1),i("p",null,u(e.$t("tools.audioVisualizer.description")),1)]),i("div",z,[i("div",w,[i("div",$,[i("div",V,[i("button",{class:r([{active:"file"===Fe.value},"method-tab"]),onClick:a[0]||(a[0]=e=>Fe.value="file")},[a[9]||(a[9]=i("div",{class:"tab-icon"}," ðŸ“ ",-1)),i("div",k,u(e.$t("tools.audioVisualizer.uploadFile")),1)],2),i("button",{class:r([{active:"microphone"===Fe.value},"method-tab"]),onClick:a[1]||(a[1]=e=>Fe.value="microphone")},[a[10]||(a[10]=i("div",{class:"tab-icon"}," ðŸŽ¤ ",-1)),i("div",M,u(e.$t("tools.audioVisualizer.microphone")),1)],2)]),"file"===Fe.value?(b(),o("div",x,[i("div",{class:r(["drop-zone",{"drag-over":Re.value}]),onDrop:ca,onDragover:a[2]||(a[2]=v(()=>{},["prevent"])),onDragenter:a[3]||(a[3]=v(()=>{},["prevent"]))},[i("div",C,[a[11]||(a[11]=i("div",{class:"drop-icon"}," ðŸŽµ ",-1)),i("h3",null,u(e.$t("tools.audioVisualizer.dragDropAudio")),1),i("p",null,u(e.$t("tools.audioVisualizer.supportedFormats"))+": MP3, WAV, OGG, M4A",1),i("button",{class:"select-btn",onClick:pa},u(e.$t("tools.audioVisualizer.selectFile")),1),i("input",{ref_key:"fileInput",ref:ra,type:"file",accept:"audio/*",style:{display:"none"},onChange:da},null,544)])],34)])):n("",!0),"microphone"===Fe.value?(b(),o("div",A,[i("div",U,[i("button",{disabled:!Ke.value,class:r(["mic-btn",{active:Ne.value}]),onClick:ba},[i("div",S,u(Ne.value?"ðŸ”´":"ðŸŽ¤"),1),i("div",L,u(Ne.value?e.$t("tools.audioVisualizer.stopMicrophone"):e.$t("tools.audioVisualizer.startMicrophone")),1)],10,D),Ke.value?n("",!0):(b(),o("div",T,u(e.$t("tools.audioVisualizer.microphoneNotSupported")),1))])])):n("",!0)]),Ee.value?(b(),o("div",F,[i("div",R,[a[12]||(a[12]=i("div",{class:"file-icon"}," ðŸŽµ ",-1)),i("div",E,[i("div",I,u(Ee.value.name),1),i("div",q,[i("span",B,u(Ia(Ee.value.size)),1),i("span",j,u((l=Ee.value.type,l.split("/")[1]?.toUpperCase()||"AUDIO")),1)])])])])):n("",!0)]),Ie.value?(b(),o("div",O,[i("div",_,[i("button",{class:"control-btn play-pause",onClick:ga},u(_e.value?"â¸ï¸":"â–¶ï¸"),1),i("button",{class:"control-btn stop",onClick:za}," â¹ï¸ "),i("div",P,[i("span",W,u(qa(Pe.value)),1),a[13]||(a[13]=i("span",{class:"separator"},"/",-1)),i("span",G,u(qa(We.value)),1)])]),i("div",K,[i("input",{type:"range",value:Pe.value,max:We.value,class:"progress-slider",onInput:wa},null,40,N)]),i("div",J,[a[14]||(a[14]=i("span",{class:"volume-icon"},"ðŸ”Š",-1)),c(i("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>Ge.value=e),type:"range",min:"0",max:"1",step:"0.01",class:"volume-slider",onInput:$a},null,544),[[d,Ge.value,void 0,{number:!0}]]),i("span",H,u(Math.round(100*Ge.value))+"%",1)])])):n("",!0),i("div",Q,[i("div",X,[i("div",Y,[i("label",null,u(e.$t("tools.audioVisualizer.visualizationType")),1),c(i("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>He.value=e),class:"viz-select",onChange:Ta},[i("option",Z,u(e.$t("tools.audioVisualizer.bars")),1),i("option",ee,u(e.$t("tools.audioVisualizer.waveform")),1),i("option",ae,u(e.$t("tools.audioVisualizer.circular")),1),i("option",le,u(e.$t("tools.audioVisualizer.spectrum")),1)],544),[[p,He.value]])]),i("div",te,[i("label",null,u(e.$t("tools.audioVisualizer.colorScheme")),1),c(i("select",{"onUpdate:modelValue":a[6]||(a[6]=e=>Qe.value=e),class:"color-select",onChange:Ta},[i("option",se,u(e.$t("tools.audioVisualizer.rainbow")),1),i("option",oe,u(e.$t("tools.audioVisualizer.blue")),1),i("option",ie,u(e.$t("tools.audioVisualizer.red")),1),i("option",ue,u(e.$t("tools.audioVisualizer.green")),1),i("option",ne,u(e.$t("tools.audioVisualizer.purple")),1)],544),[[p,Qe.value]])]),i("div",re,[i("label",null,u(e.$t("tools.audioVisualizer.sensitivity")),1),c(i("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>Xe.value=e),type:"range",min:"0.1",max:"3",step:"0.1",class:"sensitivity-slider"},null,512),[[d,Xe.value,void 0,{number:!0}]]),i("span",ve,u(Xe.value.toFixed(1)),1)]),i("div",ce,[i("label",de,[c(i("input",{"onUpdate:modelValue":a[8]||(a[8]=e=>Ye.value=e),type:"checkbox"},null,512),[[h,Ye.value]]),i("span",null,u(e.$t("tools.audioVisualizer.showFrequencyLabels")),1)])])]),i("div",pe,[i("canvas",{ref_key:"visualizerCanvas",ref:aa,class:"visualizer-canvas",width:Ze.value,height:ea.value},null,8,he),qe.value?n("",!0):(b(),o("div",me,[a[15]||(a[15]=i("div",{class:"placeholder-icon"}," ðŸŽµ ",-1)),i("div",be,u(e.$t("tools.audioVisualizer.selectAudioToVisualize")),1)]))]),qe.value?(b(),o("div",fe,[i("div",ye,[i("div",ge,[i("span",ze,u(e.$t("tools.audioVisualizer.bass")),1),i("div",we,[i("div",{class:"band-fill",style:m({width:`${ta.value}%`})},null,4)]),i("span",$e,u(ta.value)+"%",1)]),i("div",Ve,[i("span",ke,u(e.$t("tools.audioVisualizer.mid")),1),i("div",Me,[i("div",{class:"band-fill",style:m({width:`${sa.value}%`})},null,4)]),i("span",xe,u(sa.value)+"%",1)]),i("div",Ce,[i("span",Ae,u(e.$t("tools.audioVisualizer.treble")),1),i("div",Ue,[i("div",{class:"band-fill",style:m({width:`${oa.value}%`})},null,4)]),i("span",De,u(oa.value)+"%",1)])])])):n("",!0)]),qe.value?(b(),o("div",Se,[i("h3",null,u(e.$t("tools.audioVisualizer.exportOptions")),1),i("div",Le,[i("button",{class:"export-btn",onClick:Fa},u(e.$t("tools.audioVisualizer.captureFrame")),1),i("button",{disabled:ia.value,class:"export-btn",onClick:Ra},u(ia.value?e.$t("tools.audioVisualizer.recording"):e.$t("tools.audioVisualizer.recordVideo")),9,Te),ia.value?(b(),o("button",{key:0,class:"export-btn stop",onClick:Ea},u(e.$t("tools.audioVisualizer.stopRecording")),1)):n("",!0)])])):n("",!0)])]);var l}}}),[["__scopeId","data-v-00a91687"]]);export{Fe as default};
