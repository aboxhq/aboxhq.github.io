import{a as t,r as o,L as e,c as a,o as l,b as s,e as n,f as c,y as i,t as u,n as r,I as d,J as p,N as v,s as h,F as b,g as m,q as g,j as A}from"./vendor-GAldOsJ5.js";import{F as w,C as F}from"./utils-CpTIjOSr.js";import{b as $}from"./qr-DE_AbQYC.js";import{_ as f}from"./index-DcaCmn-e.js";const k={class:"two-factor-auth"},S={class:"tool-header"},y={class:"auth-tabs"},C={key:0,class:"tab-content"},H={class:"totp-section"},U={class:"input-section"},I={class:"input-group"},P={class:"secret-input-wrapper"},x=["placeholder"],V={class:"options-grid"},M={class:"option-group"},D={class:"option-group"},T={class:"option-group"},q={key:0,class:"totp-display"},E={class:"totp-code"},W={class:"code-label"},j={class:"code-value"},B={class:"code-timer"},K={class:"timer-bar"},L={class:"timer-text"},O={class:"qr-section"},J={class:"qr-label"},_={class:"qr-url"},N={key:1,class:"tab-content"},R={class:"hotp-section"},X={class:"input-section"},Y={class:"input-group"},G=["placeholder"],Q={class:"input-group"},Z={class:"counter-wrapper"},z={class:"options-grid"},tt={class:"option-group"},ot={class:"option-group"},et={key:0,class:"hotp-display"},at={class:"hotp-code"},lt={class:"code-label"},st={class:"code-value"},nt={class:"counter-display"},ct={key:2,class:"tab-content"},it={class:"backup-section"},ut={class:"backup-controls"},rt={class:"control-group"},dt={class:"control-group"},pt={key:0,class:"backup-codes"},vt={class:"codes-header"},ht={class:"codes-actions"},bt={class:"codes-grid"},mt={class:"backup-warning"},gt={class:"info-section"},At={class:"info-content"},wt={class:"info-item"},Ft={class:"info-item"},$t={class:"info-item"},ft=f(t({__name:"TwoFactorAuth",setup(t){const f=o("totp"),ft=o("JBSWY3DPEHPK3PXP"),kt=o("JBSWY3DPEHPK3PXP"),St=o(0),yt=o(""),Ct=o(""),Ht=o(30),Ut=o([]),It=o(),Pt=e({digits:6,period:30,algorithm:"SHA1"}),xt=e({digits:6,algorithm:"SHA1"}),Vt=e({count:10,length:10});let Mt=null;const Dt=a(()=>Ht.value/Pt.period*100),Tt=a(()=>{if(!ft.value)return"";return`otpauth://totp/Example:user@example.com?issuer=Example&${new URLSearchParams({secret:ft.value,digits:Pt.digits.toString(),period:Pt.period.toString(),algorithm:Pt.algorithm}).toString()}`}),qt=(t,o,e,a)=>{try{const l=(t=>{let o=0,e=0,a=[];for(let l=0;l<t.length;l++){const s=t[l].toUpperCase();if("="===s)break;const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(s);-1!==n&&(e=e<<5|n,o+=5,o>=8&&(a.push(e>>>o-8&255),o-=8))}return new Uint8Array(a)})(t.replace(/\s/g,"")),s=new Uint8Array(8);for(let t=7;t>=0;t--)s[t]=255&o,o>>>=8;const n=((t,o,e)=>{const a=F.lib.WordArray.create(o),l=F.lib.WordArray.create(e);let s;switch(t){case"SHA256":s=F.HmacSHA256(l,a);break;case"SHA512":s=F.HmacSHA512(l,a);break;default:s=F.HmacSHA1(l,a)}const n=new Uint8Array(4*s.words.length);for(let c=0;c<s.words.length;c++){const t=s.words[c];n[4*c]=t>>>24&255,n[4*c+1]=t>>>16&255,n[4*c+2]=t>>>8&255,n[4*c+3]=255&t}return n})(a,l,s),c=15&n[n.length-1],i=(127&n[c])<<24|(255&n[c+1])<<16|(255&n[c+2])<<8|255&n[c+3];return(i%Math.pow(10,e)).toString().padStart(e,"0")}catch(l){return"000000"}},Et=()=>{if(!ft.value)return void(yt.value="");const t=Math.floor(Date.now()/1e3),o=Math.floor(t/Pt.period);yt.value=qt(ft.value,o,Pt.digits,Pt.algorithm),It.value&&$.toCanvas(It.value,Tt.value,{width:200})},Wt=()=>{kt.value?Ct.value=qt(kt.value,St.value,xt.digits,xt.algorithm):Ct.value=""},jt=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";let o="";for(let e=0;e<32;e++)o+=t[Math.floor(32*Math.random())];ft.value=o,Et()},Bt=()=>{St.value++,Wt()},Kt=()=>{const t=[],o="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(let e=0;e<Vt.count;e++){let e="";for(let t=0;t<Vt.length;t++)e+=o[Math.floor(36*Math.random())];t.push(e)}Ut.value=t},Lt=async()=>{const t=Ut.value.join("\n");try{await navigator.clipboard.writeText(t)}catch(o){}},Ot=()=>{const t=`Two-Factor Authentication Backup Codes\nGenerated: ${(new Date).toISOString()}\n\n${Ut.value.join("\n")}\n\nIMPORTANT: Store these codes in a safe place. Each code can only be used once.`,o=new Blob([t],{type:"text/plain;charset=utf-8"});w.saveAs(o,"backup-codes.txt")};return l(()=>{Et(),Wt(),(()=>{Mt&&clearInterval(Mt);const t=()=>{const t=Math.floor(Date.now()/1e3);Ht.value=Pt.period-t%Pt.period,Ht.value===Pt.period&&Et()};t(),Mt=setInterval(t,1e3)})()}),s(()=>{Mt&&clearInterval(Mt)}),(t,o)=>(A(),n("div",k,[c("div",S,[c("h1",null,u(t.$t("tools.twoFactorAuth.title")),1),c("p",null,u(t.$t("tools.twoFactorAuth.description")),1)]),c("div",y,[c("button",{class:r([{active:"totp"===f.value},"tab-btn"]),onClick:o[0]||(o[0]=t=>f.value="totp")},u(t.$t("tools.twoFactorAuth.totp")),3),c("button",{class:r([{active:"hotp"===f.value},"tab-btn"]),onClick:o[1]||(o[1]=t=>f.value="hotp")},u(t.$t("tools.twoFactorAuth.hotp")),3),c("button",{class:r([{active:"backup"===f.value},"tab-btn"]),onClick:o[2]||(o[2]=t=>f.value="backup")},u(t.$t("tools.twoFactorAuth.backupCodes")),3)]),"totp"===f.value?(A(),n("div",C,[c("div",H,[c("div",U,[c("div",I,[c("label",null,u(t.$t("tools.twoFactorAuth.secretKey")),1),c("div",P,[d(c("input",{"onUpdate:modelValue":o[3]||(o[3]=t=>ft.value=t),type:"text",class:"secret-input",placeholder:t.$t("tools.twoFactorAuth.secretPlaceholder"),onInput:Et},null,40,x),[[p,ft.value]]),c("button",{class:"generate-secret-btn",onClick:jt},u(t.$t("tools.twoFactorAuth.generateSecret")),1)])]),c("div",V,[c("div",M,[c("label",null,u(t.$t("tools.twoFactorAuth.digits")),1),d(c("select",{"onUpdate:modelValue":o[4]||(o[4]=t=>Pt.digits=t),class:"option-select",onChange:Et},[...o[13]||(o[13]=[c("option",{value:"6"}," 6 ",-1),c("option",{value:"8"}," 8 ",-1)])],544),[[v,Pt.digits,void 0,{number:!0}]])]),c("div",D,[c("label",null,u(t.$t("tools.twoFactorAuth.period")),1),d(c("select",{"onUpdate:modelValue":o[5]||(o[5]=t=>Pt.period=t),class:"option-select",onChange:Et},[...o[14]||(o[14]=[c("option",{value:"30"}," 30s ",-1),c("option",{value:"60"}," 60s ",-1)])],544),[[v,Pt.period,void 0,{number:!0}]])]),c("div",T,[c("label",null,u(t.$t("tools.twoFactorAuth.algorithm")),1),d(c("select",{"onUpdate:modelValue":o[6]||(o[6]=t=>Pt.algorithm=t),class:"option-select",onChange:Et},[...o[15]||(o[15]=[c("option",{value:"SHA1"}," SHA1 ",-1),c("option",{value:"SHA256"}," SHA256 ",-1),c("option",{value:"SHA512"}," SHA512 ",-1)])],544),[[v,Pt.algorithm]])])])]),ft.value?(A(),n("div",q,[c("div",E,[c("div",W,u(t.$t("tools.twoFactorAuth.currentCode")),1),c("div",j,u(yt.value),1),c("div",B,[c("div",K,[c("div",{class:"timer-fill",style:h({width:Dt.value+"%"})},null,4)]),c("div",L,u(Ht.value)+"s ",1)])]),c("div",O,[c("div",J,u(t.$t("tools.twoFactorAuth.qrCode")),1),c("canvas",{ref_key:"qrCanvas",ref:It,class:"qr-canvas"},null,512),c("div",_,u(Tt.value),1)])])):i("",!0)])])):i("",!0),"hotp"===f.value?(A(),n("div",N,[c("div",R,[c("div",X,[c("div",Y,[c("label",null,u(t.$t("tools.twoFactorAuth.secretKey")),1),d(c("input",{"onUpdate:modelValue":o[7]||(o[7]=t=>kt.value=t),type:"text",class:"secret-input",placeholder:t.$t("tools.twoFactorAuth.secretPlaceholder"),onInput:Wt},null,40,G),[[p,kt.value]])]),c("div",Q,[c("label",null,u(t.$t("tools.twoFactorAuth.counter")),1),c("div",Z,[d(c("input",{"onUpdate:modelValue":o[8]||(o[8]=t=>St.value=t),type:"number",min:"0",class:"counter-input",onInput:Wt},null,544),[[p,St.value,void 0,{number:!0}]]),c("button",{class:"increment-btn",onClick:Bt},u(t.$t("tools.twoFactorAuth.increment")),1)])]),c("div",z,[c("div",tt,[c("label",null,u(t.$t("tools.twoFactorAuth.digits")),1),d(c("select",{"onUpdate:modelValue":o[9]||(o[9]=t=>xt.digits=t),class:"option-select",onChange:Wt},[...o[16]||(o[16]=[c("option",{value:"6"}," 6 ",-1),c("option",{value:"8"}," 8 ",-1)])],544),[[v,xt.digits,void 0,{number:!0}]])]),c("div",ot,[c("label",null,u(t.$t("tools.twoFactorAuth.algorithm")),1),d(c("select",{"onUpdate:modelValue":o[10]||(o[10]=t=>xt.algorithm=t),class:"option-select",onChange:Wt},[...o[17]||(o[17]=[c("option",{value:"SHA1"}," SHA1 ",-1),c("option",{value:"SHA256"}," SHA256 ",-1),c("option",{value:"SHA512"}," SHA512 ",-1)])],544),[[v,xt.algorithm]])])])]),kt.value?(A(),n("div",et,[c("div",at,[c("div",lt,u(t.$t("tools.twoFactorAuth.hotpCode")),1),c("div",st,u(Ct.value),1),c("div",nt,u(t.$t("tools.twoFactorAuth.counterValue"))+": "+u(St.value),1)])])):i("",!0)])])):i("",!0),"backup"===f.value?(A(),n("div",ct,[c("div",it,[c("div",ut,[c("div",rt,[c("label",null,u(t.$t("tools.twoFactorAuth.numberOfCodes")),1),d(c("input",{"onUpdate:modelValue":o[11]||(o[11]=t=>Vt.count=t),type:"number",min:"5",max:"20",class:"control-input"},null,512),[[p,Vt.count,void 0,{number:!0}]])]),c("div",dt,[c("label",null,u(t.$t("tools.twoFactorAuth.codeLength")),1),d(c("input",{"onUpdate:modelValue":o[12]||(o[12]=t=>Vt.length=t),type:"number",min:"8",max:"16",class:"control-input"},null,512),[[p,Vt.length,void 0,{number:!0}]])]),c("button",{class:"generate-btn",onClick:Kt},u(t.$t("tools.twoFactorAuth.generateCodes")),1)]),Ut.value.length>0?(A(),n("div",pt,[c("div",vt,[c("h3",null,u(t.$t("tools.twoFactorAuth.backupCodesList")),1),c("div",ht,[c("button",{class:"action-btn",onClick:Lt},u(t.$t("common.buttons.copy")),1),c("button",{class:"action-btn",onClick:Ot},u(t.$t("common.buttons.download")),1)])]),c("div",bt,[(A(!0),n(b,null,m(Ut.value,(t,o)=>(A(),n("div",{key:o,class:"backup-code"},u(t),1))),128))]),c("div",mt,[c("strong",null,u(t.$t("tools.twoFactorAuth.warning"))+":",1),g(" "+u(t.$t("tools.twoFactorAuth.backupWarning")),1)])])):i("",!0)])])):i("",!0),c("div",gt,[c("h3",null,u(t.$t("tools.twoFactorAuth.howToUse")),1),c("div",At,[c("div",wt,[c("h4",null,u(t.$t("tools.twoFactorAuth.totpInfo")),1),c("p",null,u(t.$t("tools.twoFactorAuth.totpDescription")),1)]),c("div",Ft,[c("h4",null,u(t.$t("tools.twoFactorAuth.hotpInfo")),1),c("p",null,u(t.$t("tools.twoFactorAuth.hotpDescription")),1)]),c("div",$t,[c("h4",null,u(t.$t("tools.twoFactorAuth.backupInfo")),1),c("p",null,u(t.$t("tools.twoFactorAuth.backupDescription")),1)])])])]))}}),[["__scopeId","data-v-2dbd55ba"]]);export{ft as default};
