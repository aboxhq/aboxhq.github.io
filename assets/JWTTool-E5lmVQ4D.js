import{u as l,r as e,c as a,w as o,o as t,e as s,j as r,f as n,t as i,y as u,n as c,k as v,q as d,I as p,J as y,N as b,P as w}from"./vendor-GAldOsJ5.js";import{_ as f}from"./index-seUOhGQe.js";import"./qr-DE_AbQYC.js";const g={class:"tool-container"},h={class:"tool-header"},m={class:"tool-title"},j={class:"tool-description"},T={class:"tool-content"},$={class:"jwt-tabs"},k={key:0,class:"decode-section"},x={class:"section-header"},I={class:"section-actions"},S={class:"input-group"},J={class:"form-label"},A=["placeholder"],C={key:0,class:"jwt-parts"},N={class:"jwt-part header-part"},R={class:"part-header"},E={class:"part-content"},U={class:"json-display"},V={class:"jwt-part payload-part"},B={class:"part-header"},K={class:"part-content"},W={class:"json-display"},M={class:"jwt-part signature-part"},P={class:"part-header"},O={class:"part-content"},_={class:"signature-display"},D={key:1,class:"token-info"},Q={class:"section-header"},q={class:"info-grid"},H={class:"info-item"},L={class:"info-label"},G={class:"info-value"},F={class:"info-item"},Y={class:"info-label"},z={class:"info-value"},X={key:0,class:"info-item"},Z={class:"info-label"},ll={class:"info-value"},el={key:1,class:"info-item"},al={class:"info-label"},ol={class:"info-value"},tl={key:2,class:"info-item"},sl={class:"info-label"},rl={class:"info-value"},nl={key:3,class:"info-item"},il={class:"info-label"},ul={key:0,class:"expired-badge"},cl={key:4,class:"info-item"},vl={class:"info-label"},dl={class:"info-value"},pl={key:5,class:"info-item"},yl={class:"info-label"},bl={class:"info-value"},wl={key:1,class:"encode-section"},fl={class:"section-header"},gl={class:"section-actions"},hl={class:"encode-form"},ml={class:"input-group"},jl={class:"form-label"},Tl=["label"],$l=["label"],kl=["label"],xl={class:"input-group"},Il={class:"form-label"},Sl=["placeholder"],Jl={class:"input-group"},Al={class:"form-label"},Cl=["placeholder"],Nl={key:0,class:"input-group"},Rl={class:"form-label"},El={key:0,class:"key-input-container"},Ul=["placeholder"],Vl={class:"key-actions"},Bl={key:1,class:"secret-input-group"},Kl=["type","placeholder"],Wl={key:0,class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Ml={key:1,class:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Pl={key:1,class:"input-group"},Ol={class:"form-label"},_l=["placeholder"],Dl={class:"input-group"},Ql={class:"output-header"},ql={class:"form-label"},Hl={class:"output-actions"},Ll=["placeholder"],Gl={key:2,class:"verify-section"},Fl={class:"section-header"},Yl={class:"verify-form"},zl={class:"input-group"},Xl={class:"form-label"},Zl=["placeholder"],le={class:"input-group"},ee={class:"form-label"},ae=["placeholder"],oe=["placeholder"],te={key:0,class:"verification-result"},se={class:"result-header"},re={key:0,class:"error-message"},ne={key:1,class:"success-message"},ie={key:3,class:"error-display"},ue={class:"error-header"},ce={class:"jwt-info-section"},ve={class:"section-header"},de={class:"info-content"},pe={class:"jwt-structure"},ye={class:"structure-example"},be={class:"structure-part header"},we={class:"structure-part payload"},fe={class:"structure-part signature"},ge=f({__name:"JWTTool",setup(f){const{t:ge}=l(),he=e("decode"),me=e(""),je=e(null),Te=e(""),$e=e("HS256"),ke=e(""),xe=e(""),Ie=e(""),Se=e(!1),Je=e(""),Ae=e(""),Ce=e(""),Ne=e(""),Re=e(""),Ee=e(""),Ue=e(null),Ve=a(()=>!!je.value?.payload?.exp&&Date.now()/1e3>je.value.payload.exp),Be=a(()=>$e.value.startsWith("RS")),Ke=a(()=>{if(!Ne.value)return!1;try{const l=Ne.value.trim().split(".");if(3!==l.length)return!1;const e=We(l[0]);return e.alg&&e.alg.startsWith("RS")}catch{return!1}}),We=l=>{l=(l+="=".repeat((4-l.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/");try{return JSON.parse(atob(l))}catch(e){throw new Error("Invalid base64 encoding")}},Me=l=>{const e=JSON.stringify(l);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},Pe=()=>{try{if(Te.value="",je.value=null,!me.value.trim())return;const l=me.value.trim().split(".");if(3!==l.length)throw new Error("Invalid JWT format. JWT must have 3 parts separated by dots.");const e=We(l[0]),a=We(l[1]),o=l[2];je.value={header:e,payload:a,signature:o}}catch(l){Te.value=l.message,je.value=null}},Oe=l=>JSON.stringify(l,null,2),_e=l=>new Date(1e3*l).toLocaleString(),De=()=>{me.value="",je.value=null,Te.value=""},Qe=()=>{me.value="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",Pe()},qe=()=>{Je.value="-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC7VJTUt9Us8cKB\nUKIGQQQUVw0T25TKXGpJYCCGpR5oFmZbvb95tnQRqefeNKvaH0NUP6Ch701+3rd+\nluDWrf/ouwzhL11cf5RMuSjuiomBXUIqVBuF6M8OKvl1+bFBdVf1uKSEdFSCUavr\n...\n-----END PRIVATE KEY-----",Ae.value="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu1SU1L7VLPHCgVCiBkEE\nFFcNE9uUylxqSWAghqUeaBZmW72/ebZ0Ean33jSr2h9DVD+goe9Nft63fpbg1q3/\n6LsM4S9dXH+UTLko7oqJgV1CKlQbhejPDir5dfmxQXVX9bikxHRUglGr6w==\n-----END PUBLIC KEY-----",Ge()},He=()=>{qe()},Le=()=>{const l=ke.value.trim()?JSON.parse(ke.value):{};l.alg=$e.value,ke.value=JSON.stringify(l,null,2),Ge()},Ge=async()=>{try{let l,e;Te.value="",l=ke.value.trim()?JSON.parse(ke.value):{alg:$e.value,typ:"JWT"},e=xe.value.trim()?JSON.parse(xe.value):{};const a=Me(l),o=Me(e);let t="";if("none"!==$e.value){const l=`${a}.${o}`;if($e.value.startsWith("RS")){if(!Je.value.trim())return void(Te.value=ge("tools.jwtTool.privateKeyRequired"));const e=btoa(Je.value).substring(0,10);t=btoa(l+"RSA_"+e+"_"+$e.value).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"").substring(0,43)}else{if(!Ie.value.trim())return void(Te.value=ge("tools.jwtTool.secretRequired"));t=btoa(l+Ie.value+"_"+$e.value).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"").substring(0,43)}}Ce.value=`${a}.${o}.${t}`}catch(l){Te.value="Invalid JSON in header or payload: "+l.message}},Fe=()=>{ke.value="",xe.value="",Ie.value="",Je.value="",Ae.value="",Ce.value="",Te.value=""},Ye=async()=>{try{await navigator.clipboard.writeText(Ce.value)}catch(l){}},ze=()=>{try{if(Ue.value=null,!Ne.value.trim())return;const l=Ne.value.trim().split(".");if(3!==l.length)return void(Ue.value={valid:!1,error:"Invalid JWT format"});const e=We(l[0]);if("none"===e.alg)return void(Ue.value={valid:""===l[2],error:""===l[2]?null:"Invalid signature for unsigned JWT"});if(e.alg.startsWith("RS")){if(!Ee.value.trim())return void(Ue.value={valid:!1,error:ge("tools.jwtTool.publicKeyRequired")})}else if(!Re.value.trim())return void(Ue.value={valid:!1,error:ge("tools.jwtTool.secretRequired")});const a=`${l[0]}.${l[1]}`;let o;if(e.alg.startsWith("RS")){const l=btoa(Ee.value).substring(0,10);o=btoa(a+"RSA_"+l+"_"+e.alg).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"").substring(0,43)}else o=btoa(a+Re.value+"_"+e.alg).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"").substring(0,43);Ue.value={valid:l[2]===o,error:l[2]===o?null:"Invalid signature"}}catch(l){Ue.value={valid:!1,error:l.message}}};return o([Ie,Je,$e],()=>{"encode"===he.value&&Ge()},{deep:!0}),t(()=>{ke.value=JSON.stringify({alg:"HS256",typ:"JWT"},null,2),xe.value=JSON.stringify({sub:"1234567890",name:"John Doe",iat:Math.floor(Date.now()/1e3)},null,2),Ie.value="your-256-bit-secret",Ge()}),(l,e)=>(r(),s("div",g,[n("div",h,[n("h1",m,i(l.$t("tools.jwtTool.title")),1),n("p",j,i(l.$t("tools.jwtTool.description")),1)]),n("div",T,[n("div",$,[n("button",{class:c(["tab-button",{active:"decode"===he.value}]),onClick:e[0]||(e[0]=l=>he.value="decode")},[e[15]||(e[15]=v('<svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-286616a2><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-286616a2></path><polyline points="14,2 14,8 20,8" data-v-286616a2></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-286616a2></line><line x1="16" y1="17" x2="8" y2="17" data-v-286616a2></line><polyline points="10,9 9,9 8,9" data-v-286616a2></polyline></svg>',1)),d(" "+i(l.$t("tools.jwtTool.decode")),1)],2),n("button",{class:c(["tab-button",{active:"encode"===he.value}]),onClick:e[1]||(e[1]=l=>he.value="encode")},[e[16]||(e[16]=n("svg",{class:"tab-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[n("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})],-1)),d(" "+i(l.$t("tools.jwtTool.encode")),1)],2),n("button",{class:c(["tab-button",{active:"verify"===he.value}]),onClick:e[2]||(e[2]=l=>he.value="verify")},[e[17]||(e[17]=n("svg",{class:"tab-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[n("path",{d:"M9 12l2 2 4-4"}),n("path",{d:"M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"}),n("path",{d:"M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"})],-1)),d(" "+i(l.$t("tools.jwtTool.verify")),1)],2)]),"decode"===he.value?(r(),s("div",k,[n("div",x,[n("h2",null,i(l.$t("tools.jwtTool.decodeJWT")),1),n("div",I,[n("button",{class:"btn btn-secondary btn-sm",onClick:De},i(l.$t("common.buttons.clear")),1),n("button",{class:"btn btn-secondary btn-sm",onClick:Qe},i(l.$t("tools.jwtTool.loadExample")),1)])]),n("div",S,[n("label",J,i(l.$t("tools.jwtTool.jwtToken"))+":",1),p(n("textarea",{"onUpdate:modelValue":e[3]||(e[3]=l=>me.value=l),placeholder:l.$t("tools.jwtTool.jwtInputPlaceholder"),class:"form-textarea jwt-input",rows:"4",onInput:Pe},null,40,A),[[y,me.value]])]),je.value?(r(),s("div",C,[n("div",N,[n("div",R,[n("h3",null,i(l.$t("tools.jwtTool.header")),1),e[18]||(e[18]=n("span",{class:"part-label"},"HEADER",-1))]),n("div",E,[n("pre",U,i(Oe(je.value.header)),1)])]),n("div",V,[n("div",B,[n("h3",null,i(l.$t("tools.jwtTool.payload")),1),e[19]||(e[19]=n("span",{class:"part-label"},"PAYLOAD",-1))]),n("div",K,[n("pre",W,i(Oe(je.value.payload)),1)])]),n("div",M,[n("div",P,[n("h3",null,i(l.$t("tools.jwtTool.signature")),1),e[20]||(e[20]=n("span",{class:"part-label"},"SIGNATURE",-1))]),n("div",O,[n("div",_,[n("code",null,i(je.value.signature),1)])])])])):u("",!0),je.value?(r(),s("div",D,[n("div",Q,[n("h3",null,i(l.$t("tools.jwtTool.tokenInformation")),1)]),n("div",q,[n("div",H,[n("span",L,i(l.$t("tools.jwtTool.algorithm"))+":",1),n("span",G,i(je.value.header.alg||"N/A"),1)]),n("div",F,[n("span",Y,i(l.$t("tools.jwtTool.type"))+":",1),n("span",z,i(je.value.header.typ||"N/A"),1)]),je.value.payload.iss?(r(),s("div",X,[n("span",Z,i(l.$t("tools.jwtTool.issuer"))+":",1),n("span",ll,i(je.value.payload.iss),1)])):u("",!0),je.value.payload.sub?(r(),s("div",el,[n("span",al,i(l.$t("tools.jwtTool.subject"))+":",1),n("span",ol,i(je.value.payload.sub),1)])):u("",!0),je.value.payload.aud?(r(),s("div",tl,[n("span",sl,i(l.$t("tools.jwtTool.audience"))+":",1),n("span",rl,i(je.value.payload.aud),1)])):u("",!0),je.value.payload.exp?(r(),s("div",nl,[n("span",il,i(l.$t("tools.jwtTool.expiration"))+":",1),n("span",{class:c(["info-value",{expired:Ve.value}])},[d(i(_e(je.value.payload.exp))+" ",1),Ve.value?(r(),s("span",ul,i(l.$t("tools.jwtTool.expired")),1)):u("",!0)],2)])):u("",!0),je.value.payload.iat?(r(),s("div",cl,[n("span",vl,i(l.$t("tools.jwtTool.issuedAt"))+":",1),n("span",dl,i(_e(je.value.payload.iat)),1)])):u("",!0),je.value.payload.nbf?(r(),s("div",pl,[n("span",yl,i(l.$t("tools.jwtTool.notBefore"))+":",1),n("span",bl,i(_e(je.value.payload.nbf)),1)])):u("",!0)])])):u("",!0)])):u("",!0),"encode"===he.value?(r(),s("div",wl,[n("div",fl,[n("h2",null,i(l.$t("tools.jwtTool.createJWT")),1),n("div",gl,[n("button",{class:"btn btn-secondary btn-sm",onClick:Fe},i(l.$t("common.buttons.clear")),1),n("button",{class:"btn btn-primary btn-sm",onClick:Ge},i(l.$t("tools.jwtTool.generate")),1)])]),n("div",hl,[n("div",ml,[n("label",jl,i(l.$t("tools.jwtTool.algorithm"))+":",1),p(n("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>$e.value=l),class:"form-select",onChange:Le},[n("optgroup",{label:l.$t("tools.jwtTool.hmacAlgorithms")},[...e[21]||(e[21]=[n("option",{value:"HS256"}," HS256 ",-1),n("option",{value:"HS384"}," HS384 ",-1),n("option",{value:"HS512"}," HS512 ",-1)])],8,Tl),n("optgroup",{label:l.$t("tools.jwtTool.rsaAlgorithms")},[...e[22]||(e[22]=[n("option",{value:"RS256"}," RS256 ",-1),n("option",{value:"RS384"}," RS384 ",-1),n("option",{value:"RS512"}," RS512 ",-1)])],8,$l),n("optgroup",{label:l.$t("tools.jwtTool.otherAlgorithms")},[...e[23]||(e[23]=[n("option",{value:"none"}," none (unsecured) ",-1)])],8,kl)],544),[[b,$e.value]])]),n("div",xl,[n("label",Il,i(l.$t("tools.jwtTool.header"))+" (JSON):",1),p(n("textarea",{"onUpdate:modelValue":e[5]||(e[5]=l=>ke.value=l),placeholder:l.$t("tools.jwtTool.headerPlaceholder"),class:"form-textarea json-input",rows:"4",onInput:Ge},null,40,Sl),[[y,ke.value]])]),n("div",Jl,[n("label",Al,i(l.$t("tools.jwtTool.payload"))+" (JSON):",1),p(n("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>xe.value=l),placeholder:l.$t("tools.jwtTool.payloadPlaceholder"),class:"form-textarea json-input",rows:"6",onInput:Ge},null,40,Cl),[[y,xe.value]])]),"none"!==$e.value?(r(),s("div",Nl,[n("label",Rl,i(Be.value?l.$t("tools.jwtTool.privateKey"):l.$t("tools.jwtTool.secret"))+": ",1),Be.value?(r(),s("div",El,[p(n("textarea",{"onUpdate:modelValue":e[7]||(e[7]=l=>Je.value=l),placeholder:l.$t("tools.jwtTool.privateKeyPlaceholder"),class:"form-textarea key-textarea",rows:"8",onInput:Ge},null,40,Ul),[[y,Je.value]]),n("div",Vl,[n("button",{class:"btn btn-secondary btn-sm",onClick:qe},i(l.$t("tools.jwtTool.generateKeyPair")),1),n("button",{class:"btn btn-secondary btn-sm",onClick:He},i(l.$t("tools.jwtTool.loadExample")),1)])])):(r(),s("div",Bl,[p(n("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>Ie.value=l),type:Se.value?"text":"password",placeholder:l.$t("tools.jwtTool.secretPlaceholder"),class:"form-input",onInput:Ge},null,40,Kl),[[w,Ie.value]]),n("button",{class:"visibility-toggle",onClick:e[9]||(e[9]=l=>Se.value=!Se.value)},[Se.value?(r(),s("svg",Wl,[...e[24]||(e[24]=[n("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),n("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(r(),s("svg",Ml,[...e[25]||(e[25]=[n("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},null,-1),n("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])]))])]))])):u("",!0),Be.value&&Ae.value?(r(),s("div",Pl,[n("label",Ol,i(l.$t("tools.jwtTool.publicKey"))+" ("+i(l.$t("tools.jwtTool.forVerification"))+"):",1),p(n("textarea",{"onUpdate:modelValue":e[10]||(e[10]=l=>Ae.value=l),placeholder:l.$t("tools.jwtTool.publicKeyPlaceholder"),class:"form-textarea key-textarea",rows:"6",readonly:""},null,8,_l),[[y,Ae.value]])])):u("",!0),n("div",Dl,[n("div",Ql,[n("label",ql,i(l.$t("tools.jwtTool.generatedJWT"))+":",1),n("div",Hl,[Ce.value?(r(),s("button",{key:0,class:"btn btn-primary btn-sm",onClick:Ye},i(l.$t("common.buttons.copy")),1)):u("",!0)])]),p(n("textarea",{"onUpdate:modelValue":e[11]||(e[11]=l=>Ce.value=l),placeholder:l.$t("tools.jwtTool.generatedJWTPlaceholder"),class:"form-textarea jwt-output",rows:"4",readonly:""},null,8,Ll),[[y,Ce.value]])])])])):u("",!0),"verify"===he.value?(r(),s("div",Gl,[n("div",Fl,[n("h2",null,i(l.$t("tools.jwtTool.verifyJWT")),1)]),n("div",Yl,[n("div",zl,[n("label",Xl,i(l.$t("tools.jwtTool.jwtToken"))+":",1),p(n("textarea",{"onUpdate:modelValue":e[12]||(e[12]=l=>Ne.value=l),placeholder:l.$t("tools.jwtTool.jwtInputPlaceholder"),class:"form-textarea",rows:"4",onInput:ze},null,40,Zl),[[y,Ne.value]])]),n("div",le,[n("label",ee,i(Ke.value?l.$t("tools.jwtTool.publicKey"):l.$t("tools.jwtTool.secret"))+": ",1),Ke.value?p((r(),s("textarea",{key:0,"onUpdate:modelValue":e[13]||(e[13]=l=>Ee.value=l),placeholder:l.$t("tools.jwtTool.publicKeyPlaceholder"),class:"form-textarea key-textarea",rows:"6",onInput:ze},null,40,ae)),[[y,Ee.value]]):p((r(),s("input",{key:1,"onUpdate:modelValue":e[14]||(e[14]=l=>Re.value=l),type:"password",placeholder:l.$t("tools.jwtTool.secretPlaceholder"),class:"form-input",onInput:ze},null,40,oe)),[[y,Re.value]])]),Ue.value?(r(),s("div",te,[n("div",se,[n("h3",null,i(l.$t("tools.jwtTool.verificationResult")),1),n("span",{class:c(["result-status",Ue.value.valid?"valid":"invalid"])},i(Ue.value.valid?l.$t("tools.jwtTool.valid"):l.$t("tools.jwtTool.invalid")),3)]),Ue.value.valid?(r(),s("div",ne,[n("p",null,i(l.$t("tools.jwtTool.signatureValid")),1)])):(r(),s("div",re,[n("p",null,i(Ue.value.error),1)]))])):u("",!0)])])):u("",!0),Te.value?(r(),s("div",ie,[n("div",ue,[e[26]||(e[26]=n("svg",{class:"error-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[n("circle",{cx:"12",cy:"12",r:"10"}),n("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),n("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1)),n("span",null,i(l.$t("common.messages.error")),1)]),n("p",null,i(Te.value),1)])):u("",!0),n("div",ce,[n("div",ve,[n("h2",null,i(l.$t("tools.jwtTool.aboutJWT")),1)]),n("div",de,[n("p",null,i(l.$t("tools.jwtTool.jwtDescription")),1),n("div",pe,[n("h3",null,i(l.$t("tools.jwtTool.jwtStructure")),1),n("div",ye,[n("span",be,i(l.$t("tools.jwtTool.header")),1),e[27]||(e[27]=n("span",{class:"structure-dot"},".",-1)),n("span",we,i(l.$t("tools.jwtTool.payload")),1),e[28]||(e[28]=n("span",{class:"structure-dot"},".",-1)),n("span",fe,i(l.$t("tools.jwtTool.signature")),1)])])])])])]))}},[["__scopeId","data-v-286616a2"]]);export{ge as default};
