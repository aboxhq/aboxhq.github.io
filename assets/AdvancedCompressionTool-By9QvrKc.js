import{a as e,u as s,r as o,o as a,e as l,f as i,t,m as n,y as r,n as c,F as p,g as m,I as d,J as u,s as v,j as h}from"./vendor-GAldOsJ5.js";import{b as f,d as g,z as y,g as w,c as T,e as C,u as b,f as z}from"./browser-ti7604_i.js";import{s as k}from"./toast-bUE0oB92.js";import{_ as x}from"./index-vCRZDDw7.js";import"./qr-DE_AbQYC.js";const P=new class{algorithms=[{name:"gzip",displayName:"GZIP",description:"Standard GZIP compression, widely supported",extension:".gz",mimeType:"application/gzip"},{name:"deflate",displayName:"Deflate",description:"Raw DEFLATE compression, smaller overhead",extension:".deflate",mimeType:"application/octet-stream"},{name:"zip",displayName:"ZIP",description:"ZIP archive format with compression",extension:".zip",mimeType:"application/zip"},{name:"pako-gzip",displayName:"Pako GZIP",description:"High-performance GZIP using Pako library",extension:".gz",mimeType:"application/gzip"}];getAvailableAlgorithms(){return this.algorithms}async compressData(e,s,o={}){const a=performance.now(),l=e.length;let i;try{switch(s){case"gzip":i=await this.compressGzip(e,o);break;case"deflate":i=await this.compressDeflate(e,o);break;case"zip":i=await this.compressZip(e,o);break;case"pako-gzip":i=this.compressPakoGzip(e,o);break;default:throw new Error(`Unknown compression algorithm: ${s}`)}const t=performance.now()-a,n=i.length;return{originalSize:l,compressedSize:n,compressionRatio:(l-n)/l*100,compressionTime:t,algorithm:s,data:i}}catch(t){throw new Error(`Failed to compress using ${s}: ${t}`)}}async decompressData(e,s){try{switch(s){case"gzip":return await this.decompressGzip(e);case"deflate":return await this.decompressDeflate(e);case"zip":return await this.decompressZip(e);case"pako-gzip":return this.decompressPakoGzip(e);default:throw new Error(`Unknown decompression algorithm: ${s}`)}}catch(o){throw new Error(`Failed to decompress using ${s}: ${o}`)}}async compareAlgorithms(e,s){const o=s||this.algorithms.map(e=>e.name),a=[];for(const i of o)try{const s=await this.compressData(e,i),o=e.length/1048576/(s.compressionTime/1e3);a.push({algorithm:i,originalSize:s.originalSize,compressedSize:s.compressedSize,compressionRatio:s.compressionRatio,compressionTime:s.compressionTime,speedMbps:o})}catch(l){}return a.sort((e,s)=>s.compressionRatio-e.compressionRatio)}async compressFile(e,s,o={}){const a=await e.arrayBuffer(),l=new Uint8Array(a);return this.compressData(l,s,o)}async compressGzip(e,s){return new Promise((o,a)=>{f(e,{level:s.level||6},(e,s)=>{e?a(e):o(s)})})}async compressDeflate(e,s){return new Promise((o,a)=>{g(e,{level:s.level||6},(e,s)=>{e?a(e):o(s)})})}async compressZip(e,s){return new Promise((o,a)=>{y({"data.bin":e},{level:s.level||6},(e,s)=>{e?a(e):o(s)})})}compressPakoGzip(e,s){return w(e,{level:s.level||6,windowBits:s.windowBits||15,memLevel:s.memLevel||8,strategy:s.strategy||0})}async decompressGzip(e){return new Promise((s,o)=>{T(e,(e,a)=>{e?o(e):s(a)})})}async decompressDeflate(e){return new Promise((s,o)=>{C(e,(e,a)=>{e?o(e):s(a)})})}async decompressZip(e){return new Promise((s,o)=>{b(e,(e,a)=>{if(e)o(e);else{const e=Object.values(a);e.length>0?s(e[0]):o(new Error("No files found in ZIP archive"))}})})}decompressPakoGzip(e){return z(e)}formatBytes(e){if(0===e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB","GB"][s]}formatTime(e){return e<1?`${(1e3*e).toFixed(0)}Î¼s`:e<1e3?`${e.toFixed(1)}ms`:`${(e/1e3).toFixed(2)}s`}calculateEfficiency(e,s){return 100*(.7*Math.min(e/80,1)+.3*Math.min(s/100,1))}},R={class:"advanced-compression-tool"},D={class:"tool-header"},F={class:"tool-description"},A={class:"compression-container"},S={class:"upload-section"},B={class:"upload-content"},E={class:"upload-hint"},G={key:0,class:"main-content"},M={class:"algorithm-section"},N={class:"algorithm-grid"},I=["onClick"],U={class:"algorithm-meta"},Z={class:"extension"},$={key:0,class:"compression-options"},j={class:"options-grid"},L={class:"option-group"},_={class:"slider-container"},O={class:"value"},H={class:"option-hint"},q={class:"action-section"},J={class:"action-buttons"},K=["disabled"],V={key:0},Q={key:1},W=["disabled"],X={key:0,class:"results-section"},Y={class:"results-grid"},ee={class:"result-header"},se={class:"algorithm-badge"},oe={class:"result-stats"},ae={class:"stat"},le={class:"label"},ie={class:"value"},te={class:"stat"},ne={class:"label"},re={class:"value"},ce={class:"stat"},pe={class:"label"},me={class:"stat"},de={class:"label"},ue={class:"value"},ve={class:"result-actions"},he=["onClick"],fe={key:1,class:"comparison-section"},ge={class:"comparison-table"},ye={class:"algorithm-name"},we={class:"speed"},Te={class:"efficiency"},Ce={class:"efficiency-bar"},be={class:"size"},ze=x(e({__name:"AdvancedCompressionTool",setup(e){const{t:f}=s(),g=o(),y=o(!1),w=o([]),T=o([]),C=o(""),b=o(6),z=o(!1),x=o([]),ze=o([]),ke=()=>{g.value?.click()},xe=e=>{const s=Array.from(e.target.files||[]);w.value=s},Pe=e=>{e.preventDefault(),y.value=!1;const s=Array.from(e.dataTransfer?.files||[]);w.value=s},Re=e=>{e.preventDefault(),y.value=!0},De=e=>{e.preventDefault(),y.value=!1},Fe=async()=>{if(C.value&&0!==w.value.length){z.value=!0,x.value=[];try{for(const e of w.value){const s=await P.compressFile(e,C.value,{level:b.value});x.value.push({...s,fileName:e.name})}k.success(f("tools.advancedCompressionTool.compressionComplete"))}catch(e){k.error(f("tools.advancedCompressionTool.compressionError"))}finally{z.value=!1}}},Ae=async()=>{if(0!==w.value.length){z.value=!0,ze.value=[];try{const e=w.value[0],s=await e.arrayBuffer(),o=new Uint8Array(s),a=await P.compareAlgorithms(o);ze.value=a,k.success(f("tools.advancedCompressionTool.comparisonComplete"))}catch(e){k.error(f("tools.advancedCompressionTool.comparisonError"))}finally{z.value=!1}}},Se=e=>P.formatBytes(e),Be=e=>e>=60?"excellent":e>=40?"good":e>=20?"fair":"poor",Ee=(e,s)=>P.calculateEfficiency(e,s);return a(async()=>{try{T.value=P.getAvailableAlgorithms(),C.value=T.value[0]?.name||""}catch(e){k.error(f("tools.advancedCompressionTool.initError"))}}),(e,s)=>(h(),l("div",R,[i("div",D,[i("h1",null,t(n(f)("tools.advancedCompressionTool.title")),1),i("p",F,t(n(f)("tools.advancedCompressionTool.description")),1)]),i("div",A,[i("div",S,[i("div",{class:c(["upload-area",{"drag-over":y.value}]),onDrop:Pe,onDragover:Re,onDragleave:De},[i("input",{ref_key:"fileInput",ref:g,type:"file",multiple:"",class:"file-input",onChange:xe},null,544),i("div",B,[s[1]||(s[1]=i("div",{class:"upload-icon"}," ðŸ—œï¸ ",-1)),i("h3",null,t(n(f)("tools.advancedCompressionTool.dragDrop")),1),i("p",null,t(n(f)("common.or")),1),i("button",{class:"select-btn",onClick:ke},t(n(f)("tools.advancedCompressionTool.selectFiles")),1),i("p",E,t(n(f)("tools.advancedCompressionTool.supportedFormats")),1)])],34)]),w.value.length>0?(h(),l("div",G,[i("div",M,[i("h3",null,t(n(f)("tools.advancedCompressionTool.selectAlgorithm")),1),i("div",N,[(h(!0),l(p,null,m(T.value,e=>(h(),l("div",{key:e.name,class:c([{active:C.value===e.name},"algorithm-card"]),onClick:s=>C.value=e.name},[i("h4",null,t(e.displayName),1),i("p",null,t(e.description),1),i("div",U,[i("span",Z,t(e.extension),1)])],10,I))),128))]),C.value?(h(),l("div",$,[i("h4",null,t(n(f)("tools.advancedCompressionTool.compressionOptions")),1),i("div",j,[i("div",L,[i("label",null,t(n(f)("tools.advancedCompressionTool.compressionLevel")),1),i("div",_,[d(i("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>b.value=e),type:"range",min:"1",max:"9",class:"slider"},null,512),[[u,b.value]]),i("span",O,t(b.value),1)]),i("p",H,t(n(f)("tools.advancedCompressionTool.levelHint")),1)])])])):r("",!0)]),i("div",q,[i("div",J,[i("button",{disabled:!C.value||z.value,class:"compress-btn",onClick:Fe},[z.value?(h(),l("span",Q,t(n(f)("tools.advancedCompressionTool.processing")),1)):(h(),l("span",V,t(n(f)("tools.advancedCompressionTool.compress")),1))],8,K),i("button",{disabled:0===w.value.length||z.value,class:"compare-btn",onClick:Ae},t(n(f)("tools.advancedCompressionTool.compareAlgorithms")),9,W)])]),x.value.length>0?(h(),l("div",X,[i("h3",null,t(n(f)("tools.advancedCompressionTool.compressionResults")),1),i("div",Y,[(h(!0),l(p,null,m(x.value,(e,s)=>{return h(),l("div",{key:s,class:"result-card"},[i("div",ee,[i("h4",null,t(e.fileName),1),i("span",se,t(e.algorithm.toUpperCase()),1)]),i("div",oe,[i("div",ae,[i("span",le,t(n(f)("tools.advancedCompressionTool.originalSize"))+":",1),i("span",ie,t(Se(e.originalSize)),1)]),i("div",te,[i("span",ne,t(n(f)("tools.advancedCompressionTool.compressedSize"))+":",1),i("span",re,t(Se(e.compressedSize)),1)]),i("div",ce,[i("span",pe,t(n(f)("tools.advancedCompressionTool.compressionRatio"))+":",1),i("span",{class:c(["value ratio",Be(e.compressionRatio)])},t(e.compressionRatio.toFixed(1))+"% ",3)]),i("div",me,[i("span",de,t(n(f)("tools.advancedCompressionTool.processTime"))+":",1),i("span",ue,t((o=e.compressionTime,P.formatTime(o))),1)])]),i("div",ve,[i("button",{class:"download-btn",onClick:s=>(e=>{const s=T.value.find(s=>s.name===e.algorithm);if(!s)return;const o=new Blob([e.data],{type:s.mimeType}),a=URL.createObjectURL(o),l=document.createElement("a"),i=s.extension,t=e.fileName.includes(".")?e.fileName.substring(0,e.fileName.lastIndexOf("."))+i:e.fileName+i;l.href=a,l.download=t,l.click(),URL.revokeObjectURL(a),k.success(f("tools.advancedCompressionTool.downloadStarted"))})(e)},t(n(f)("tools.advancedCompressionTool.download")),9,he)])]);var o}),128))])])):r("",!0),ze.value.length>0?(h(),l("div",fe,[i("h3",null,t(n(f)("tools.advancedCompressionTool.algorithmComparison")),1),i("div",ge,[i("table",null,[i("thead",null,[i("tr",null,[i("th",null,t(n(f)("tools.advancedCompressionTool.algorithm")),1),i("th",null,t(n(f)("tools.advancedCompressionTool.compressionRatio")),1),i("th",null,t(n(f)("tools.advancedCompressionTool.speed")),1),i("th",null,t(n(f)("tools.advancedCompressionTool.efficiency")),1),i("th",null,t(n(f)("tools.advancedCompressionTool.compressedSize")),1)])]),i("tbody",null,[(h(!0),l(p,null,m(ze.value,(e,s)=>(h(),l("tr",{key:s},[i("td",ye,t(e.algorithm.toUpperCase()),1),i("td",{class:c(["ratio",Be(e.compressionRatio)])},t(e.compressionRatio.toFixed(1))+"% ",3),i("td",we,t(e.speedMbps.toFixed(1))+" MB/s ",1),i("td",Te,[i("div",Ce,[i("div",{class:"efficiency-fill",style:v({width:`${Ee(e.compressionRatio,e.speedMbps)}%`})},null,4)]),i("span",null,t(Ee(e.compressionRatio,e.speedMbps).toFixed(0))+"%",1)]),i("td",be,t(Se(e.compressedSize)),1)]))),128))])])])])):r("",!0)])):r("",!0)])]))}}),[["__scopeId","data-v-bf6f32ee"]]);export{ze as default};
