import{a as e,u as o,r as s,L as l,c as a,e as t,f as r,t as n,m as i,y as c,n as u,I as d,N as m,J as v,K as p,F as g,g as h,s as b,j as f}from"./vendor-GAldOsJ5.js";import{t as w}from"./toast-BhoKftcT.js";import{J as C}from"./jszip.min-BRAKGGYN.js";import{_ as y}from"./index-DcaCmn-e.js";import"./utils-CpTIjOSr.js";import"./qr-DE_AbQYC.js";const z={class:"modern-image-converter"},I={class:"tool-header"},k={class:"tool-description"},M={class:"converter-container"},U={class:"upload-section"},j={class:"upload-content"},L={class:"upload-hint"},V={key:0,class:"options-section"},x={class:"options-grid"},R={class:"option-group"},F={key:0,class:"option-group"},q={key:1,class:"option-group"},E={value:"low"},P={value:"medium"},D={value:"high"},O={key:2,class:"option-group"},$={class:"switch"},A={class:"option-group"},B={value:"none"},_={value:"width"},N={value:"height"},S={value:"percentage"},W={key:3,class:"option-group"},G=["min","max"],J={class:"action-buttons"},H=["disabled"],K={key:1,class:"files-section"},T={class:"file-grid"},Q={class:"file-preview"},X=["src","alt"],Y={class:"file-info"},Z={class:"file-name"},ee={class:"file-size"},oe={class:"file-dimensions"},se=["onClick"],le={key:0,class:"conversion-status"},ae={class:"progress-bar"},te={key:1,class:"conversion-status"},re={class:"size-comparison"},ne={class:"original-size"},ie={class:"converted-size"},ce={key:0,class:"savings"},ue=["onClick"],de={key:2,class:"conversion-status"},me={key:2,class:"overall-progress"},ve={class:"progress-bar"},pe={class:"progress-text"},ge=y(e({__name:"ModernImageConverter",setup(e){const{t:y}=o(),ge=s(),he=s([]),be=s([]),fe=s(!1),we=s(!1),Ce=s(0),ye=l({format:"webp",quality:85,compressionLevel:"medium",lossless:!1,resizeMode:"none",resizeValue:800}),ze=a(()=>{switch(ye.resizeMode){case"width":return"Width (px)";case"height":return"Height (px)";case"percentage":return"Percentage (%)";default:return"Size (px)"}}),Ie=a(()=>0===he.value.length?0:Ce.value/he.value.length*100),ke=()=>{ge.value?.click()},Me=e=>{const o=e.target,s=Array.from(o.files||[]);Ve(s)},Ue=e=>{e.preventDefault(),fe.value=!1;const o=Array.from(e.dataTransfer?.files||[]).filter(e=>e.type.startsWith("image/"));Ve(o)},je=e=>{e.preventDefault(),fe.value=!0},Le=()=>{fe.value=!1},Ve=async e=>{for(const o of e){const e=await xe(o),s=new FileReader;s.onload=s=>{he.value.push({file:o,name:o.name,size:o.size,width:e.width,height:e.height,preview:s.target?.result,status:"pending"})},s.readAsDataURL(o)}},xe=e=>new Promise(o=>{const s=new Image;s.onload=()=>{o({width:s.width,height:s.height})},s.src=URL.createObjectURL(e)}),Re=()=>{he.value=[],be.value=[],Ce.value=0},Fe=async()=>{if(0!==he.value.length){we.value=!0,Ce.value=0,be.value=[];for(let o=0;o<he.value.length;o++){const s=he.value[o];s.status="processing",s.progress=0;try{const e=await qe(s);s.result=e.blob,s.resultName=e.filename,s.resultSize=e.blob.size,s.savings=Math.round((s.size-e.blob.size)/s.size*100),s.status="completed",be.value.push(s)}catch(e){s.status="error",w.error(`${y("tools.modernImageConverter.conversionError")}: ${s.name}`)}Ce.value++,s.progress=100}we.value=!1,be.value.length>0&&w.success(y("tools.modernImageConverter.conversionSuccess",{count:be.value.length}))}},qe=async e=>new Promise((o,s)=>{const l=document.createElement("canvas"),a=l.getContext("2d"),t=new Image;t.onload=()=>{if(!a)return void s(new Error("Canvas context not available"));let{width:r,height:n}=t;"none"!==ye.resizeMode&&("width"===ye.resizeMode?(n=n*ye.resizeValue/r,r=ye.resizeValue):"height"===ye.resizeMode?(r=r*ye.resizeValue/n,n=ye.resizeValue):"percentage"===ye.resizeMode&&(r=r*ye.resizeValue/100,n=n*ye.resizeValue/100)),l.width=r,l.height=n,a.drawImage(t,0,0,r,n);let i="image/jpeg",c="jpg",u=ye.quality/100;switch(ye.format){case"png":i="image/png",c="png",u=1;break;case"webp":i="image/webp",c="webp",ye.lossless&&(u=1);break;case"avif":i="image/avif",c="avif",i="image/webp",c="webp"}l.toBlob(l=>{if(l){const s=e.name.split(".")[0];o({blob:l,filename:`${s}.${c}`})}else s(new Error("Failed to convert image"))},i,u)},t.onerror=()=>s(new Error("Failed to load image")),t.src=e.preview}),Ee=e=>{if(!e.result)return;const o=URL.createObjectURL(e.result),s=document.createElement("a");s.href=o,s.download=e.resultName||e.name,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o)},Pe=async()=>{if(0===be.value.length)return;if(1===be.value.length)return void Ee(be.value[0]);const e=new C;for(const a of be.value)a.result&&e.file(a.resultName||a.name,a.result);const o=await e.generateAsync({type:"blob"}),s=URL.createObjectURL(o),l=document.createElement("a");l.href=s,l.download="converted-images.zip",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)},De=e=>{if(0===e)return"0 B";const o=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,o)).toFixed(2))+" "+["B","KB","MB","GB"][o]};return(e,o)=>(f(),t("div",z,[r("div",I,[r("h1",null,n(i(y)("tools.modernImageConverter.title")),1),r("p",k,n(i(y)("tools.modernImageConverter.description")),1)]),r("div",M,[r("div",U,[r("div",{class:u(["upload-area",{"drag-over":fe.value}]),onDrop:Ue,onDragover:je,onDragleave:Le},[r("input",{ref_key:"fileInput",ref:ge,type:"file",multiple:"",accept:"image/*",class:"file-input",onChange:Me},null,544),r("div",j,[o[6]||(o[6]=r("div",{class:"upload-icon"}," ðŸ–¼ï¸ ",-1)),r("h3",null,n(i(y)("tools.modernImageConverter.dragDrop")),1),r("p",null,n(i(y)("common.or")),1),r("button",{class:"select-btn",onClick:ke},n(i(y)("tools.modernImageConverter.selectFiles")),1),r("p",L,n(i(y)("tools.modernImageConverter.supportedFormats")),1)])],34)]),he.value.length>0?(f(),t("div",V,[r("h3",null,n(i(y)("tools.modernImageConverter.conversionOptions")),1),r("div",x,[r("div",R,[r("label",null,n(i(y)("tools.modernImageConverter.outputFormat")),1),d(r("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>ye.format=e)},[...o[7]||(o[7]=[r("option",{value:"avif"}," AVIF ",-1),r("option",{value:"webp"}," WebP ",-1),r("option",{value:"jpeg"}," JPEG ",-1),r("option",{value:"png"}," PNG ",-1)])],512),[[m,ye.format]])]),"png"!==ye.format?(f(),t("div",F,[r("label",null,n(i(y)("tools.modernImageConverter.quality"))+" ("+n(ye.quality)+"%)",1),d(r("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>ye.quality=e),type:"range",min:"1",max:"100",class:"quality-slider"},null,512),[[v,ye.quality]])])):c("",!0),"avif"===ye.format?(f(),t("div",q,[r("label",null,n(i(y)("tools.modernImageConverter.compressionLevel")),1),d(r("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>ye.compressionLevel=e)},[r("option",E,n(i(y)("tools.modernImageConverter.low")),1),r("option",P,n(i(y)("tools.modernImageConverter.medium")),1),r("option",D,n(i(y)("tools.modernImageConverter.high")),1)],512),[[m,ye.compressionLevel]])])):c("",!0),"webp"===ye.format?(f(),t("div",O,[r("label",null,n(i(y)("tools.modernImageConverter.lossless")),1),r("label",$,[d(r("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>ye.lossless=e),type:"checkbox"},null,512),[[p,ye.lossless]]),o[8]||(o[8]=r("span",{class:"slider"},null,-1))])])):c("",!0),r("div",A,[r("label",null,n(i(y)("tools.modernImageConverter.resize")),1),d(r("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>ye.resizeMode=e)},[r("option",B,n(i(y)("tools.modernImageConverter.keepOriginal")),1),r("option",_,n(i(y)("tools.modernImageConverter.byWidth")),1),r("option",N,n(i(y)("tools.modernImageConverter.byHeight")),1),r("option",S,n(i(y)("tools.modernImageConverter.byPercentage")),1)],512),[[m,ye.resizeMode]])]),"none"!==ye.resizeMode?(f(),t("div",W,[r("label",null,n(ze.value),1),d(r("input",{"onUpdate:modelValue":o[5]||(o[5]=e=>ye.resizeValue=e),type:"number",min:"percentage"===ye.resizeMode?1:10,max:"percentage"===ye.resizeMode?100:4096,class:"size-input"},null,8,G),[[v,ye.resizeValue]])])):c("",!0)]),r("div",J,[r("button",{class:"convert-btn",disabled:we.value,onClick:Fe},n(we.value?i(y)("tools.modernImageConverter.converting"):i(y)("tools.modernImageConverter.convertImages")),9,H),r("button",{class:"clear-btn",onClick:Re},n(i(y)("common.buttons.clear")),1),be.value.length>0?(f(),t("button",{key:0,class:"download-all-btn",onClick:Pe},n(i(y)("tools.modernImageConverter.downloadAll")),1)):c("",!0)])])):c("",!0),he.value.length>0?(f(),t("div",K,[r("h3",null,n(i(y)("tools.modernImageConverter.selectedFiles"))+" ("+n(he.value.length)+")",1),r("div",T,[(f(!0),t(g,null,h(he.value,(e,s)=>(f(),t("div",{key:s,class:"file-item"},[r("div",Q,[r("img",{src:e.preview,alt:e.name},null,8,X),r("div",Y,[r("p",Z,n(e.name),1),r("p",ee,n(De(e.size)),1),r("p",oe,n(e.width)+" Ã— "+n(e.height)+"px ",1)]),r("button",{class:"remove-btn",onClick:e=>(e=>{he.value.splice(e,1)})(s)}," Ã— ",8,se)]),"processing"===e.status?(f(),t("div",le,[r("div",ae,[r("div",{class:"progress-fill",style:b({width:`${e.progress}%`})},null,4)]),r("span",null,n(i(y)("tools.modernImageConverter.processing")),1)])):"completed"===e.status?(f(),t("div",te,[o[10]||(o[10]=r("div",{class:"status-icon completed"}," âœ“ ",-1)),r("span",null,n(i(y)("tools.modernImageConverter.completed")),1),r("div",re,[r("span",ne,n(De(e.size)),1),o[9]||(o[9]=r("span",{class:"arrow"},"â†’",-1)),r("span",ie,n(De(e.resultSize||0)),1),e.savings?(f(),t("span",ce," ("+n(e.savings)+"% "+n(i(y)("tools.modernImageConverter.smaller"))+") ",1)):c("",!0)]),r("button",{class:"download-btn",onClick:o=>Ee(e)},n(i(y)("common.buttons.download")),9,ue)])):"error"===e.status?(f(),t("div",de,[o[11]||(o[11]=r("div",{class:"status-icon error"}," âœ— ",-1)),r("span",null,n(i(y)("tools.modernImageConverter.error")),1)])):c("",!0)]))),128))])])):c("",!0),we.value?(f(),t("div",me,[r("h4",null,n(i(y)("tools.modernImageConverter.overallProgress")),1),r("div",ve,[r("div",{class:"progress-fill",style:b({width:`${Ie.value}%`})},null,4)]),r("p",pe,n(i(y)("tools.modernImageConverter.processing"))+" "+n(Ce.value)+" / "+n(he.value.length),1)])):c("",!0)])]))}}),[["__scopeId","data-v-913ddac1"]]);export{ge as default};
