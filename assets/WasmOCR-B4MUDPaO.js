import{a as e,u as t,r as a,L as o,V as n,e as r,f as s,t as i,y as l,M as c,n as u,F as d,g as p,q as h,I as g,N as m,K as v,s as f,J as w,j as y}from"./vendor-sPCxxDNi.js";import{p as b,c as O}from"./utils-CpTIjOSr.js";import{s as L}from"./toast-CSo0l4e7.js";import{_ as R}from"./index-BFyA9hmL.js";import"./qr-DE_AbQYC.js";!function(e){var t=function(e){var t,a=Object.prototype,o=a.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function c(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(A){c=function(e,t,a){return e[t]=a}}function u(e,t,a,o){var r=t&&t.prototype instanceof f?t:f,s=Object.create(r.prototype),i=new _(o||[]);return n(s,"_invoke",{value:E(e,a,i)}),s}function d(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(A){return{type:"throw",arg:A}}}e.wrap=u;var p="suspendedStart",h="suspendedYield",g="executing",m="completed",v={};function f(){}function w(){}function y(){}var b={};c(b,s,function(){return this});var O=Object.getPrototypeOf,L=O&&O(O(I([])));L&&L!==a&&o.call(L,s)&&(b=L);var R=y.prototype=f.prototype=Object.create(b);function C(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function k(e,t){function a(n,r,s,i){var l=d(e[n],e,r);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==typeof u&&o.call(u,"__await")?t.resolve(u.__await).then(function(e){a("next",e,s,i)},function(e){a("throw",e,s,i)}):t.resolve(u).then(function(e){c.value=e,s(c)},function(e){return a("throw",e,s,i)})}i(l.arg)}var r;n(this,"_invoke",{value:function(e,o){function n(){return new t(function(t,n){a(e,o,t,n)})}return r=r?r.then(n,n):n()}})}function E(e,t,a){var o=p;return function(n,r){if(o===g)throw new Error("Generator is already running");if(o===m){if("throw"===n)throw r;return $()}for(a.method=n,a.arg=r;;){var s=a.delegate;if(s){var i=x(s,a);if(i){if(i===v)continue;return i}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(o===p)throw o=m,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);o=g;var l=d(e,t,a);if("normal"===l.type){if(o=a.done?m:h,l.arg===v)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(o=m,a.method="throw",a.arg=l.arg)}}}function x(e,a){var o=a.method,n=e.iterator[o];if(n===t)return a.delegate=null,"throw"===o&&e.iterator.return&&(a.method="return",a.arg=t,x(e,a),"throw"===a.method)||"return"!==o&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+o+"' method")),v;var r=d(n,e.iterator,a.arg);if("throw"===r.type)return a.method="throw",a.arg=r.arg,a.delegate=null,v;var s=r.arg;return s?s.done?(a[e.resultName]=s.value,a.next=e.nextLoc,"return"!==a.method&&(a.method="next",a.arg=t),a.delegate=null,v):s:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(e){if(e){var a=e[s];if(a)return a.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function a(){for(;++n<e.length;)if(o.call(e,n))return a.value=e[n],a.done=!1,a;return a.value=t,a.done=!0,a};return r.next=r}}return{next:$}}function $(){return{value:t,done:!0}}return w.prototype=y,n(R,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:w,configurable:!0}),w.displayName=c(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,l,"GeneratorFunction")),e.prototype=Object.create(R),e},e.awrap=function(e){return{__await:e}},C(k.prototype),c(k.prototype,i,function(){return this}),e.AsyncIterator=k,e.async=function(t,a,o,n,r){void 0===r&&(r=Promise);var s=new k(u(t,a,o,n),r);return e.isGeneratorFunction(a)?s:s.next().then(function(e){return e.done?e.value:s.next()})},C(R),c(R,l,"Generator"),c(R,s,function(){return this}),c(R,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),a=[];for(var o in t)a.push(o);return a.reverse(),function e(){for(;a.length;){var o=a.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=I,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var a in this)"t"===a.charAt(0)&&o.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var a=this;function n(o,n){return i.type="throw",i.arg=e,a.next=o,n&&(a.method="next",a.arg=t),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],i=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=o.call(s,"catchLoc"),c=o.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),T(a),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var o=a.completion;if("throw"===o.type){var n=o.arg;T(a)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,a,o){return this.delegate={iterator:I(e),resultName:a,nextLoc:o},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(a){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}({exports:{}});var C=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`;const k=C;let E=0;var x=({id:e,action:t,payload:a={}})=>{let o=e;return void 0===o&&(o=k("Job",E),E+=1),{id:o,action:t,payload:a}},S={};let T=!1;S.logging=T,S.setLogging=e=>{T=e},S.log=(...e)=>T?void 0:null;const _=x,{log:I}=S,$=C;let A=0;const M="browser"===(e=>{const t={};return"undefined"!=typeof WorkerGlobalScope?t.type="webworker":"object"==typeof document?t.type="browser":"object"==typeof b&&"function"==typeof O&&(t.type="node"),void 0===e?t:t[e]})("type")?e=>new URL(e,window.location.href).href:e=>e;var N={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};var P={...{workerBlobURL:!0,logger:()=>{}},workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${"6.0.1"}/dist/worker.min.js`};const U=e=>new Promise((t,a)=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.onerror=({target:{error:{code:e}}})=>{a(Error(`File could not be read! Code=${e}`))},o.readAsArrayBuffer(e)}),j=async e=>{let t=e;if(void 0===e)return"undefined";if("string"==typeof e)if(/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e))t=atob(e.split(",")[1]).split("").map(e=>e.charCodeAt(0));else{const a=await fetch(e);t=await a.arrayBuffer()}else if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)"IMG"===e.tagName&&(t=await j(e.src)),"VIDEO"===e.tagName&&(t=await j(e.poster)),"CANVAS"===e.tagName&&await new Promise(a=>{e.toBlob(async e=>{t=await U(e),a()})});else if("undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas){const a=await e.convertToBlob();t=await U(a)}else(e instanceof File||e instanceof Blob)&&(t=await U(e));return new Uint8Array(t)};var F={defaultOptions:P,spawnWorker:({workerPath:e,workerBlobURL:t})=>{let a;if(Blob&&URL&&t){const t=new Blob([`importScripts("${e}");`],{type:"application/javascript"});a=new Worker(URL.createObjectURL(t))}else a=new Worker(e);return a},terminateWorker:e=>{e.terminate()},onMessage:(e,t)=>{e.onmessage=({data:e})=>{t(e)}},send:async(e,t)=>{e.postMessage(t)},loadImage:j};const z=e=>{const t={...e};return["corePath","workerPath","langPath"].forEach(a=>{e[a]&&(t[a]=M(t[a]))}),t},G=x,{log:D}=S,B=C,W=N,{defaultOptions:K,spawnWorker:V,terminateWorker:H,onMessage:Y,loadImage:J,send:Z}=F;let q=0;var Q=async(e="eng",t=W.LSTM_ONLY,a={},o={})=>{const n=B("Worker",q),{logger:r,errorHandler:s,...i}=z({...K,...a}),l={},c="string"==typeof e?e.split("+"):e;let u=t,d=o;const p=[W.DEFAULT,W.LSTM_ONLY].includes(t)&&!i.legacyCore;let h,g;const m=new Promise((e,t)=>{g=e,h=t});let v=V(i);v.onerror=e=>{h(e.message)},q+=1;const f=({id:e,action:t,payload:a})=>new Promise((o,r)=>{D(`[${n}]: Start ${e}, action=${t}`);l[`${t}-${e}`]={resolve:o,reject:r},Z(v,{workerId:n,jobId:e,action:t,payload:a})}),w=(e,t)=>f(G({id:t,action:"loadLanguage",payload:{langs:e,options:{langPath:i.langPath,dataPath:i.dataPath,cachePath:i.cachePath,cacheMethod:i.cacheMethod,gzip:i.gzip,lstmOnly:[W.DEFAULT,W.LSTM_ONLY].includes(u)&&!i.legacyLang}}})),y=(e,t,a,o)=>f(G({id:o,action:"initialize",payload:{langs:e,oem:t,config:a}}));Y(v,({workerId:e,jobId:t,status:a,action:o,data:n})=>{const i=`${o}-${t}`;if("resolve"===a)D(`[${e}]: Complete ${t}`),l[i].resolve({jobId:t,data:n}),delete l[i];else if("reject"===a){if(l[i].reject(n),delete l[i],"load"===o&&h(n),!s)throw Error(n);s(n)}else"progress"===a&&r({...n,userJobId:t})});const b={id:n,worker:v,load:()=>{},writeText:(e,t,a)=>f(G({id:a,action:"FS",payload:{method:"writeFile",args:[e,t]}})),readText:(e,t)=>f(G({id:t,action:"FS",payload:{method:"readFile",args:[e,{encoding:"utf8"}]}})),removeFile:(e,t)=>f(G({id:t,action:"FS",payload:{method:"unlink",args:[e]}})),FS:(e,t,a)=>f(G({id:a,action:"FS",payload:{method:e,args:t}})),reinitialize:(e="eng",t,a,o)=>{if(p&&[W.TESSERACT_ONLY,W.TESSERACT_LSTM_COMBINED].includes(t))throw Error("Legacy model requested but code missing.");const n=t||u;u=n;const r=a||d;d=r;const s=("string"==typeof e?e.split("+"):e).filter(e=>!c.includes(e));return c.push(...s),s.length>0?w(s,o).then(()=>y(e,n,r,o)):y(e,n,r,o)},setParameters:(e={},t)=>f(G({id:t,action:"setParameters",payload:{params:e}})),recognize:async(e,t={},a={text:!0},o)=>f(G({id:o,action:"recognize",payload:{image:await J(e),options:t,output:a}})),detect:async(e,t)=>{if(p)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return f(G({id:t,action:"detect",payload:{image:await J(e)}}))},terminate:async()=>(null!==v&&(H(v),v=null),Promise.resolve())};var O;return f(G({id:O,action:"load",payload:{options:{lstmOnly:p,corePath:i.corePath,logging:i.logging}}})).then(()=>w(e)).then(()=>y(e,t,o)).then(()=>g(b)).catch(()=>{}),m};const X=Q;const ee=()=>{const e=$("Scheduler",A),t={},a={};let o=[];A+=1;const n=()=>Object.keys(t).length,r=()=>{if(0!==o.length){const e=Object.keys(t);for(let n=0;n<e.length;n+=1)if(void 0===a[e[n]]){o[0](t[e[n]]);break}}};return{addWorker:a=>(t[a.id]=a,I(`[${e}]: Add ${a.id}`),I(`[${e}]: Number of workers=${n()}`),r(),a.id),addJob:async(t,...s)=>{if(0===n())throw Error(`[${e}]: You need to have at least one worker before adding jobs`);return((t,n)=>new Promise((s,i)=>{const l=_({action:t,payload:n});o.push(async e=>{o.shift(),a[e.id]=l;try{s(await e[t].apply(void 0,[...n,l.id]))}catch(c){i(c)}finally{delete a[e.id],r()}}),I(`[${e}]: Add ${l.id} to JobQueue`),I(`[${e}]: JobQueue length=${o.length}`),r()}))(t,s)},terminate:async()=>{Object.keys(t).forEach(async e=>{await t[e].terminate()}),o=[]},getQueueLen:()=>o.length,getNumWorkers:n}},te=Q,ae={recognize:async(e,t,a)=>{const o=await X(t,1,a);return o.recognize(e).finally(async()=>{await o.terminate()})},detect:async(e,t)=>{const a=await X("osd",0,t);return a.detect(e).finally(async()=>{await a.terminate()})}},oe={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},ne=N,re={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"},{setLogging:se}=S;var ie={languages:oe,OEM:ne,PSM:re,createScheduler:ee,createWorker:te,setLogging:se,...ae};class le{worker=null;isInitialized=!1;initializationProgress=0;async initialize(e="eng",t){if(!this.isInitialized)try{this.worker=await ie.createWorker(e,1,{logger:e=>{}}),t?.(25),await new Promise(e=>setTimeout(e,100)),t?.(50),await new Promise(e=>setTimeout(e,100)),t?.(75),await new Promise(e=>setTimeout(e,100)),this.isInitialized=!0,this.initializationProgress=100,t?.(100)}catch(a){throw new Error(`Failed to initialize OCR: ${a}`)}}async recognizeText(e,t={},a){if(!this.isInitialized||!this.worker)throw new Error("OCR service not initialized");try{const o={...{language:"eng",engineMode:"DEFAULT",pageSegMode:"AUTO",preserveInterwordSpaces:!1,rotateAuto:!0,correctSkew:!0},...t};"AUTO"!==o.pageSegMode&&await this.worker.setParameters({tessedit_pageseg_mode:this.getPageSegModeValue(o.pageSegMode)}),o.preserveInterwordSpaces&&await this.worker.setParameters({preserve_interword_spaces:"1"});const n=await this.worker.recognize(e);a?.(100);const r={text:n.data.text.trim(),confidence:n.data.confidence||0,words:[],lines:[],paragraphs:[]};return n.data.words&&(r.words=n.data.words.map(e=>({text:e.text,confidence:e.confidence||0,bbox:{x0:e.bbox.x0,y0:e.bbox.y0,x1:e.bbox.x1,y1:e.bbox.y1}}))),n.data.lines&&(r.lines=n.data.lines.map(e=>({text:e.text,confidence:e.confidence||0,words:e.words?.map(e=>({text:e.text,confidence:e.confidence||0}))||[]}))),n.data.paragraphs&&(r.paragraphs=n.data.paragraphs.map(e=>({text:e.text,confidence:e.confidence||0,lines:e.lines?.length||0}))),r}catch(o){throw new Error(`Text recognition failed: ${o}`)}}async recognizeMultipleLanguages(e,t=["eng","chi_sim","chi_tra"],a){const o={};for(let r=0;r<t.length;r++){const s=t[r];try{this.worker&&await this.worker.terminate(),this.isInitialized=!1,await this.initialize(s,e=>{const o=r/t.length*100+e/t.length;a?.(Math.round(o))}),o[s]=await this.recognizeText(e,{language:s},e=>{const o=r/t.length*100+e/t.length;a?.(Math.round(o))})}catch(n){o[s]={text:"",confidence:0,words:[],lines:[],paragraphs:[]}}}return o}async enhanceImage(e,t={}){return new Promise((a,o)=>{const n=document.createElement("canvas"),r=n.getContext("2d"),s=new Image;s.onload=()=>{if(n.width=s.width,n.height=s.height,!r)return void o(new Error("Canvas context not available"));r.drawImage(s,0,0);let i=r.getImageData(0,0,n.width,n.height);t.grayscale&&(i=this.applyGrayscale(i)),t.contrast&&(i=this.applyContrast(i,1.5)),t.sharpen&&(i=this.applySharpen(i)),t.threshold&&(i=this.applyThreshold(i,128)),r.putImageData(i,0,0),n.toBlob(t=>{if(t){const o=new File([t],`enhanced_${e.name}`,{type:"image/png"});a(o)}else o(new Error("Failed to create enhanced image"))},"image/png")},s.onerror=()=>o(new Error("Failed to load image")),s.src=URL.createObjectURL(e)})}applyGrayscale(e){const t=e.data;for(let a=0;a<t.length;a+=4){const e=.299*t[a]+.587*t[a+1]+.114*t[a+2];t[a]=e,t[a+1]=e,t[a+2]=e}return e}applyContrast(e,t){const a=e.data,o=259*(255*t+255)/(255*(259-255*t));for(let n=0;n<a.length;n+=4)a[n]=Math.max(0,Math.min(255,o*(a[n]-128)+128)),a[n+1]=Math.max(0,Math.min(255,o*(a[n+1]-128)+128)),a[n+2]=Math.max(0,Math.min(255,o*(a[n+2]-128)+128));return e}applySharpen(e){const t=e.data,a=e.width,o=e.height,n=new Uint8ClampedArray(t),r=[0,-1,0,-1,5,-1,0,-1,0];for(let s=1;s<o-1;s++)for(let e=1;e<a-1;e++)for(let o=0;o<3;o++){let i=0;for(let n=-1;n<=1;n++)for(let l=-1;l<=1;l++){i+=t[4*((s+n)*a+(e+l))+o]*r[3*(n+1)+(l+1)]}n[4*(s*a+e)+o]=Math.max(0,Math.min(255,i))}return new ImageData(n,a,o)}applyThreshold(e,t){const a=e.data;for(let o=0;o<a.length;o+=4){const e=.299*a[o]+.587*a[o+1]+.114*a[o+2]>t?255:0;a[o]=e,a[o+1]=e,a[o+2]=e}return e}getPageSegModeValue(e){return{AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10"}[e]||"3"}getSupportedLanguages(){return[{code:"eng",name:"English"},{code:"chi_sim",name:"Chinese Simplified"},{code:"chi_tra",name:"Chinese Traditional"},{code:"jpn",name:"Japanese"},{code:"kor",name:"Korean"},{code:"fra",name:"French"},{code:"spa",name:"Spanish"},{code:"deu",name:"German"},{code:"ita",name:"Italian"},{code:"por",name:"Portuguese"},{code:"rus",name:"Russian"},{code:"ara",name:"Arabic"},{code:"hin",name:"Hindi"},{code:"tha",name:"Thai"},{code:"vie",name:"Vietnamese"}]}async getWorkerInfo(){return{isInitialized:this.isInitialized,initializationProgress:this.initializationProgress,supportedLanguages:this.getSupportedLanguages().map(e=>e.code)}}async dispose(){this.worker&&(await this.worker.terminate(),this.worker=null),this.isInitialized=!1,this.initializationProgress=0}}const ce={class:"wasm-ocr"},ue={class:"ocr-header"},de={class:"ocr-container"},pe={key:0,class:"upload-section"},he={class:"upload-content"},ge={class:"upload-text"},me={class:"sample-images"},ve={class:"sample-grid"},fe=["onClick"],we=["src","alt"],ye={key:1,class:"config-section"},be={class:"image-preview"},Oe=["src"],Le={class:"image-info"},Re={class:"ocr-options"},Ce={class:"option-group"},ke={class:"language-selector"},Ee=["value"],xe={class:"checkbox-label"},Se={class:"option-group"},Te={class:"processing-options"},_e={class:"checkbox-label"},Ie={class:"checkbox-label"},$e={class:"checkbox-label"},Ae={class:"checkbox-label"},Me={class:"option-group"},Ne={value:"AUTO"},Pe={value:"SINGLE_COLUMN"},Ue={value:"SINGLE_BLOCK"},je={value:"SINGLE_LINE"},Fe={value:"SINGLE_WORD"},ze={class:"action-buttons"},Ge=["disabled"],De={key:2,class:"processing-section"},Be={class:"processing-content"},We={class:"progress-bar"},Ke={class:"processing-tip"},Ve={key:3,class:"results-section"},He={class:"results-header"},Ye={class:"result-actions"},Je={key:0,class:"single-result"},Ze={class:"result-stats"},qe={class:"stat-item"},Qe={class:"stat-label"},Xe={class:"stat-value"},et={class:"stat-item"},tt={class:"stat-label"},at={class:"stat-value"},ot={class:"stat-item"},nt={class:"stat-label"},rt={class:"stat-value"},st={class:"text-output"},it={key:1,class:"multi-result"},lt={class:"language-tabs"},ct=["onClick"],ut={class:"confidence-badge"},dt={key:0,class:"tab-content"},pt={class:"result-stats"},ht={class:"stat-item"},gt={class:"stat-label"},mt={class:"stat-value"},vt={class:"stat-item"},ft={class:"stat-label"},wt={class:"stat-value"},yt={class:"text-output"},bt={key:4,class:"error-section"},Ot={class:"error-content"},Lt=e({__name:"WasmOCR",setup(e){const{t:b}=t(),O=a(),R=a(null),C=a(""),k=a(!1),E=a(!1),x=a(0),S=a(""),T=a(""),_=a(null),I=a({}),$=a(""),A=a("eng"),M=a(!1),N=a("AUTO"),P=o({grayscale:!0,contrast:!0,sharpen:!1,threshold:!1}),U=new le,j=[{code:"eng",name:"English"},{code:"chi_sim",name:"‰∏≠ÊñáÁÆÄ‰Ωì"},{code:"chi_tra",name:"‰∏≠ÊñáÁπÅÈ´î"},{code:"jpn",name:"Êó•Êú¨Ë™û"},{code:"kor",name:"ÌïúÍµ≠Ïñ¥"},{code:"fra",name:"Fran√ßais"},{code:"spa",name:"Espa√±ol"},{code:"deu",name:"Deutsch"},{code:"ita",name:"Italiano"},{code:"por",name:"Portugu√™s"},{code:"rus",name:"–†—É—Å—Å–∫–∏–π"},{code:"ara",name:"ÿßŸÑÿπÿ±ÿ®Ÿäÿ©"},{code:"hin",name:"‡§π‡§ø‡§®‡•ç‡§¶‡•Ä"}],F=[{name:b("tools.wasmOCR.sampleTypes.receipt"),url:"/sample-images/receipt.jpg"},{name:b("tools.wasmOCR.sampleTypes.document"),url:"/sample-images/document.jpg"},{name:b("tools.wasmOCR.sampleTypes.textbook"),url:"/sample-images/textbook.jpg"},{name:b("tools.wasmOCR.sampleTypes.handwritten"),url:"/sample-images/handwritten.jpg"}],z=e=>{const t=e.target;t.files&&t.files[0]&&B(t.files[0])},G=e=>{k.value=!1,e.dataTransfer?.files&&e.dataTransfer.files[0]&&B(e.dataTransfer.files[0])},D=()=>{O.value?.click()},B=e=>{e.type.startsWith("image/")?(R.value=e,C.value=URL.createObjectURL(e),J()):L.error(b("tools.wasmOCR.messages.invalidImageFile"))},W=async()=>{if(R.value){E.value=!0,x.value=0,S.value=b("tools.wasmOCR.processing.initializing"),T.value="";try{await U.initialize(A.value,e=>{x.value=Math.round(.3*e),S.value=`${b("tools.wasmOCR.processing.initializing")} ${Math.round(e)}%`});let e=R.value;if(Object.values(P).some(Boolean)&&(S.value=b("tools.wasmOCR.processing.preprocessing"),x.value=30,e=await U.enhanceImage(R.value,P),x.value=40),S.value=b("tools.wasmOCR.processing.recognizing"),M.value){const t=[A.value,"eng","chi_sim"].filter((e,t,a)=>a.indexOf(e)===t);I.value=await U.recognizeMultipleLanguages(e,t,e=>{x.value=40+Math.round(.6*e),S.value=`${b("tools.wasmOCR.processing.recognizing")} ${Math.round(e)}%`});let a=A.value,o=0;Object.entries(I.value).forEach(([e,t])=>{t.confidence>o&&(o=t.confidence,a=e)}),$.value=a}else _.value=await U.recognizeText(e,{language:A.value,pageSegMode:N.value},e=>{x.value=40+Math.round(.6*e),S.value=`${b("tools.wasmOCR.processing.recognizing")} ${Math.round(e)}%`});x.value=100,S.value=b("tools.wasmOCR.processing.completed"),setTimeout(()=>{E.value=!1},1e3),L.success(b("tools.wasmOCR.messages.recognitionSuccess"))}catch(e){T.value=`${b("tools.wasmOCR.messages.recognitionFailed")}: ${e}`,E.value=!1,L.error(b("tools.wasmOCR.messages.recognitionFailed"))}}},K=async()=>{let e="";if(M.value&&$.value?e=I.value[$.value]?.text||"":_.value&&(e=_.value.text),e)try{await navigator.clipboard.writeText(e),L.success(b("tools.wasmOCR.messages.textCopied"))}catch(t){L.error(b("tools.wasmOCR.messages.copyFailed"))}},V=()=>{let e="",t="ocr_results.txt";if(M.value&&$.value?(e=I.value[$.value]?.text||"",t=`ocr_results_${$.value}.txt`):_.value&&(e=_.value.text),e){const a=new Blob([e],{type:"text/plain"}),o=URL.createObjectURL(a),n=document.createElement("a");n.href=o,n.download=t,n.click(),URL.revokeObjectURL(o),L.success(b("tools.wasmOCR.messages.downloadSuccess"))}},H=()=>{Y()},Y=()=>{R.value=null,C.value="",J(),O.value&&(O.value.value="")},J=()=>{_.value=null,I.value={},$.value="",T.value=""},Z=()=>{T.value="",Y()},q=e=>{const t=["B","KB","MB","GB"];let a=e,o=0;for(;a>=1024&&o<t.length-1;)a/=1024,o++;return`${a.toFixed(1)} ${t[o]}`},Q=e=>j.find(t=>t.code===e)?.name||e;return n(async()=>{await U.dispose()}),(e,t)=>(y(),r("div",ce,[s("div",ue,[s("h1",null,i(e.$t("tools.wasmOCR.title")),1),s("p",null,i(e.$t("tools.wasmOCR.description")),1)]),s("div",de,[R.value||E.value?l("",!0):(y(),r("div",pe,[s("div",{class:u(["upload-area",{"drag-over":k.value}]),onDrop:c(G,["prevent"]),onDragover:t[0]||(t[0]=c(e=>k.value=!0,["prevent"])),onDragleave:t[1]||(t[1]=e=>k.value=!1),onClick:D},[s("input",{ref_key:"fileInput",ref:O,type:"file",accept:"image/*",style:{display:"none"},onChange:z},null,544),s("div",he,[t[12]||(t[12]=s("div",{class:"upload-icon"}," üìÑ ",-1)),s("div",ge,[s("p",null,[s("strong",null,i(e.$t("tools.wasmOCR.dropImage")),1)]),s("p",null,i(e.$t("tools.wasmOCR.supportedFormats")),1),t[11]||(t[11]=s("small",null,"PNG, JPG, JPEG, GIF, BMP, TIFF",-1))])])],34),s("div",me,[s("h3",null,i(e.$t("tools.wasmOCR.sampleImages")),1),s("div",ve,[(y(),r(d,null,p(F,e=>s("button",{key:e.name,class:"sample-btn",onClick:t=>(async e=>{try{const t=await fetch(e.url),a=await t.blob(),o=new File([a],`${e.name.toLowerCase()}.jpg`,{type:"image/jpeg"});B(o)}catch(t){L.error(b("tools.wasmOCR.messages.failedToLoadSample"))}})(e)},[s("img",{src:e.url,alt:e.name},null,8,we),s("span",null,i(e.name),1)],8,fe)),64))])])])),R.value&&!E.value?(y(),r("div",ye,[s("div",be,[s("img",{src:C.value,alt:"Selected image"},null,8,Oe),s("div",Le,[s("p",null,[s("strong",null,i(e.$t("tools.wasmOCR.fileName"))+":",1),h(" "+i(R.value.name),1)]),s("p",null,[s("strong",null,i(e.$t("tools.wasmOCR.fileSize"))+":",1),h(" "+i(q(R.value.size)),1)])])]),s("div",Re,[s("div",Ce,[s("h3",null,i(e.$t("tools.wasmOCR.languageOptions")),1),s("div",ke,[g(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>A.value=e),class:"select-input"},[(y(),r(d,null,p(j,e=>s("option",{key:e.code,value:e.code},i(e.name),9,Ee)),64))],512),[[m,A.value]]),s("label",xe,[g(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>M.value=e),type:"checkbox"},null,512),[[v,M.value]]),h(" "+i(e.$t("tools.wasmOCR.multiLanguage")),1)])])]),s("div",Se,[s("h3",null,i(e.$t("tools.wasmOCR.processingOptions")),1),s("div",Te,[s("label",_e,[g(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>P.grayscale=e),type:"checkbox"},null,512),[[v,P.grayscale]]),h(" "+i(e.$t("tools.wasmOCR.grayscale")),1)]),s("label",Ie,[g(s("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>P.contrast=e),type:"checkbox"},null,512),[[v,P.contrast]]),h(" "+i(e.$t("tools.wasmOCR.enhanceContrast")),1)]),s("label",$e,[g(s("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>P.sharpen=e),type:"checkbox"},null,512),[[v,P.sharpen]]),h(" "+i(e.$t("tools.wasmOCR.sharpen")),1)]),s("label",Ae,[g(s("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>P.threshold=e),type:"checkbox"},null,512),[[v,P.threshold]]),h(" "+i(e.$t("tools.wasmOCR.threshold")),1)])])]),s("div",Me,[s("h3",null,i(e.$t("tools.wasmOCR.recognitionMode")),1),g(s("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>N.value=e),class:"select-input"},[s("option",Ne,i(e.$t("tools.wasmOCR.autoMode")),1),s("option",Pe,i(e.$t("tools.wasmOCR.singleColumn")),1),s("option",Ue,i(e.$t("tools.wasmOCR.singleBlock")),1),s("option",je,i(e.$t("tools.wasmOCR.singleLine")),1),s("option",Fe,i(e.$t("tools.wasmOCR.singleWord")),1)],512),[[m,N.value]])]),s("div",ze,[s("button",{class:"primary-btn",disabled:!R.value,onClick:W},i(e.$t("tools.wasmOCR.startRecognition")),9,Ge),s("button",{class:"secondary-btn",onClick:Y},i(e.$t("tools.wasmOCR.selectAnother")),1)])])])):l("",!0),E.value?(y(),r("div",De,[s("div",Be,[t[13]||(t[13]=s("div",{class:"processing-animation"},[s("div",{class:"spinner"})],-1)),s("h3",null,i(S.value),1),s("div",We,[s("div",{class:"progress-fill",style:f({width:`${x.value}%`})},null,4)]),s("p",null,i(x.value)+"%",1),s("p",Ke,i(e.$t("tools.wasmOCR.processingTip")),1)])])):l("",!0),_.value&&!E.value?(y(),r("div",Ve,[s("div",He,[s("h3",null,i(e.$t("tools.wasmOCR.results")),1),s("div",Ye,[s("button",{class:"action-btn",onClick:K},i(e.$t("tools.wasmOCR.copyText")),1),s("button",{class:"action-btn",onClick:V},i(e.$t("tools.wasmOCR.downloadText")),1),s("button",{class:"action-btn",onClick:H},i(e.$t("tools.wasmOCR.processAnother")),1)])]),M.value?(y(),r("div",it,[s("div",lt,[(y(!0),r(d,null,p(I.value,(e,t)=>(y(),r("button",{key:String(t),class:u([{active:$.value===String(t)},"language-tab"]),onClick:e=>$.value=String(t)},[h(i(Q(String(t)))+" ",1),s("span",ut,i(Math.round(e.confidence))+"%",1)],10,ct))),128))]),$.value&&I.value[$.value]?(y(),r("div",dt,[s("div",pt,[s("div",ht,[s("span",gt,i(e.$t("tools.wasmOCR.confidence"))+":",1),s("span",mt,i(Math.round(I.value[$.value].confidence))+"%",1)]),s("div",vt,[s("span",ft,i(e.$t("tools.wasmOCR.wordsFound"))+":",1),s("span",wt,i(I.value[$.value].words?.length||0),1)])]),s("div",yt,[s("h4",null,i(e.$t("tools.wasmOCR.extractedText"))+" ("+i(Q($.value))+")",1),g(s("textarea",{"onUpdate:modelValue":t[10]||(t[10]=e=>I.value[$.value].text=e),class:"result-textarea",readonly:""},null,512),[[w,I.value[$.value].text]])])])):l("",!0)])):(y(),r("div",Je,[s("div",Ze,[s("div",qe,[s("span",Qe,i(e.$t("tools.wasmOCR.confidence"))+":",1),s("span",Xe,i(Math.round(_.value.confidence))+"%",1)]),s("div",et,[s("span",tt,i(e.$t("tools.wasmOCR.wordsFound"))+":",1),s("span",at,i(_.value.words?.length||0),1)]),s("div",ot,[s("span",nt,i(e.$t("tools.wasmOCR.linesFound"))+":",1),s("span",rt,i(_.value.lines?.length||0),1)])]),s("div",st,[s("h4",null,i(e.$t("tools.wasmOCR.extractedText")),1),g(s("textarea",{"onUpdate:modelValue":t[9]||(t[9]=e=>_.value.text=e),class:"result-textarea",readonly:""},null,512),[[w,_.value.text]])])]))])):l("",!0),T.value?(y(),r("div",bt,[s("div",Ot,[t[14]||(t[14]=s("div",{class:"error-icon"}," ‚ö†Ô∏è ",-1)),s("h3",null,i(e.$t("tools.wasmOCR.error")),1),s("p",null,i(T.value),1),s("button",{class:"primary-btn",onClick:Z},i(e.$t("tools.wasmOCR.tryAgain")),1)])])):l("",!0)])]))}}),Rt=R(Lt,[["__scopeId","data-v-31ddbd46"]]);export{Rt as default};
