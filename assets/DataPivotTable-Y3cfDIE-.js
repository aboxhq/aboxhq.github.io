import{a as t,u as e,r as a,c as o,e as l,f as s,t as n,y as r,F as i,g as c,n as u,I as v,J as d,x as p,q as g,G as b,M as h,N as P,j as m,H as y}from"./vendor-sPCxxDNi.js";import{s as k}from"./toast-CSo0l4e7.js";import{_ as S}from"./index-BFyA9hmL.js";import"./qr-DE_AbQYC.js";const f={class:"tool-container"},C={class:"tool-header"},T={class:"tool-content"},$={class:"data-import-section"},D={class:"import-tabs"},x=["onClick"],w={key:0,class:"csv-import"},Q={class:"import-actions"},E={class:"csv-text-area"},U=["placeholder"],R={key:1,class:"sample-data"},j={class:"sample-datasets"},B=["onClick"],L={class:"sample-info"},N={key:0,class:"pivot-config-section"},M={class:"config-grid"},F={class:"field-list"},H={class:"fields"},V=["onDragstart"],I={class:"pivot-areas"},A={class:"pivot-area"},_=["onClick"],z={key:0,class:"drop-placeholder"},J={class:"pivot-area"},O=["onClick"],W={key:0,class:"drop-placeholder"},q={class:"pivot-area"},G=["onUpdate:modelValue"],Z={value:"sum"},K={value:"count"},X={value:"avg"},Y={value:"min"},tt={value:"max"},et=["onClick"],at={key:0,class:"drop-placeholder"},ot={class:"pivot-area"},lt=["onUpdate:modelValue"],st={value:""},nt=["value"],rt=["onClick"],it={key:0,class:"drop-placeholder"},ct={class:"config-actions"},ut={key:1,class:"raw-data-section"},vt={class:"data-table-container"},dt={class:"data-table"},pt={key:0,class:"table-footer"},gt={key:2,class:"pivot-result-section"},bt={class:"result-header"},ht={class:"result-actions"},Pt={class:"pivot-table-container"},mt={class:"pivot-table"},yt={key:3,class:"getting-started"},kt={class:"getting-started-content"},St={class:"quick-start-steps"},ft={class:"step"},Ct={class:"step-content"},Tt={class:"step"},$t={class:"step-content"},Dt={class:"step"},xt={class:"step-content"},wt=S(t({__name:"DataPivotTable",setup(t){const{t:S}=e(),wt=()=>y("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[y("path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"})]),Qt=()=>y("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[y("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),y("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),y("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),y("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]),Et=a("csv"),Ut=a(""),Rt=a([]),jt=a({rows:[],columns:[],values:[],filters:[],aggregations:[]}),Bt=a({}),Lt=a([]),Nt=a([]),Mt=a(),Ft=[{key:"csv"},{key:"sample"}],Ht=[{key:"sales",data:[{Region:"North",Product:"Laptop",Quarter:"Q1",Sales:15e3,Units:50},{Region:"North",Product:"Laptop",Quarter:"Q2",Sales:18e3,Units:60},{Region:"North",Product:"Phone",Quarter:"Q1",Sales:12e3,Units:120},{Region:"North",Product:"Phone",Quarter:"Q2",Sales:14e3,Units:140},{Region:"South",Product:"Laptop",Quarter:"Q1",Sales:13e3,Units:45},{Region:"South",Product:"Laptop",Quarter:"Q2",Sales:16e3,Units:55},{Region:"South",Product:"Phone",Quarter:"Q1",Sales:11e3,Units:110},{Region:"South",Product:"Phone",Quarter:"Q2",Sales:13500,Units:135},{Region:"East",Product:"Laptop",Quarter:"Q1",Sales:14e3,Units:48},{Region:"East",Product:"Laptop",Quarter:"Q2",Sales:17e3,Units:58},{Region:"East",Product:"Phone",Quarter:"Q1",Sales:10500,Units:105},{Region:"East",Product:"Phone",Quarter:"Q2",Sales:12500,Units:125},{Region:"West",Product:"Laptop",Quarter:"Q1",Sales:16e3,Units:52},{Region:"West",Product:"Laptop",Quarter:"Q2",Sales:19e3,Units:62},{Region:"West",Product:"Phone",Quarter:"Q1",Sales:13e3,Units:130},{Region:"West",Product:"Phone",Quarter:"Q2",Sales:15e3,Units:150}]},{key:"employees",data:[{Department:"IT",Position:"Developer",Experience:"Senior",Salary:8e4,Count:5},{Department:"IT",Position:"Developer",Experience:"Junior",Salary:5e4,Count:8},{Department:"IT",Position:"Manager",Experience:"Senior",Salary:1e5,Count:2},{Department:"Sales",Position:"Representative",Experience:"Senior",Salary:6e4,Count:6},{Department:"Sales",Position:"Representative",Experience:"Junior",Salary:4e4,Count:10},{Department:"Sales",Position:"Manager",Experience:"Senior",Salary:9e4,Count:3},{Department:"Marketing",Position:"Specialist",Experience:"Senior",Salary:65e3,Count:4},{Department:"Marketing",Position:"Specialist",Experience:"Junior",Salary:45e3,Count:6},{Department:"Marketing",Position:"Manager",Experience:"Senior",Salary:95e3,Count:2}]},{key:"inventory",data:[{Category:"Electronics",Brand:"Apple",Product:"iPhone",Stock:150,Price:999},{Category:"Electronics",Brand:"Apple",Product:"iPad",Stock:80,Price:599},{Category:"Electronics",Brand:"Samsung",Product:"Galaxy",Stock:120,Price:899},{Category:"Electronics",Brand:"Samsung",Product:"Tablet",Stock:60,Price:499},{Category:"Clothing",Brand:"Nike",Product:"Shoes",Stock:200,Price:129},{Category:"Clothing",Brand:"Nike",Product:"Shirt",Stock:300,Price:49},{Category:"Clothing",Brand:"Adidas",Product:"Shoes",Stock:180,Price:119},{Category:"Clothing",Brand:"Adidas",Product:"Shirt",Stock:250,Price:45},{Category:"Books",Brand:"Penguin",Product:"Fiction",Stock:100,Price:15},{Category:"Books",Brand:"Penguin",Product:"Non-Fiction",Stock:80,Price:20},{Category:"Books",Brand:"Harper",Product:"Fiction",Stock:90,Price:18},{Category:"Books",Brand:"Harper",Product:"Non-Fiction",Stock:70,Price:22}]}],Vt=o(()=>0===Rt.value.length?[]:Object.keys(Rt.value[0])),It=t=>{const e=t.target.files?.[0];if(e){const t=new FileReader;t.onload=t=>{Ut.value=t.target?.result,At()},t.readAsText(e)}},At=()=>{if(Ut.value.trim())try{const t=Ut.value.trim().split("\n"),e=t[0].split(",").map(t=>t.trim().replace(/"/g,"")),a=[];for(let o=1;o<t.length;o++){const l=t[o].split(",").map(t=>t.trim().replace(/"/g,"")),s={};e.forEach((t,e)=>{const a=l[e]||"",o=Number(a);s[t]=isNaN(o)||""===a?a:o}),a.push(s)}Rt.value=a,Jt(),k.success(S("tools.dataPivotTable.messages.dataLoaded",{count:a.length}))}catch(t){k.error(S("tools.dataPivotTable.messages.parseError"))}},_t=(t,e)=>{t.preventDefault();const a=t.dataTransfer?.getData("text/plain");a&&!jt.value[e].includes(a)&&(jt.value[e].push(a),"values"===e&&jt.value.aggregations.push("sum"),Wt())},zt=(t,e)=>{if(jt.value[t].splice(e,1),"values"===t&&jt.value.aggregations.splice(e,1),"filters"===t){const t=jt.value.filters[e];delete Bt.value[t]}Wt()},Jt=()=>{jt.value={rows:[],columns:[],values:[],filters:[],aggregations:[]},Bt.value={},Lt.value=[],Nt.value=[]},Ot=t=>{const e=Rt.value.map(e=>String(e[t]));return[...new Set(e)].sort()},Wt=()=>{if(0===Rt.value.length||0===jt.value.values.length)return Lt.value=[],void(Nt.value=[]);let t=Rt.value;Object.entries(Bt.value).forEach(([e,a])=>{a&&(t=t.filter(t=>String(t[e])===a))});const e=qt(t),{table:a,headers:o}=Gt(e);Lt.value=a,Nt.value=o},qt=t=>{const e={};return t.forEach(t=>{const a=`${jt.value.rows.map(e=>t[e]).join("|")}::${jt.value.columns.map(e=>t[e]).join("|")}`;e[a]||(e[a]=[]),e[a].push(t)}),e},Gt=t=>{const e=Zt("rows"),a=Zt("columns"),o=[...jt.value.rows,...a.map(t=>t||"(blank)")],l=[];return e.forEach(e=>{const o=[],s=e.split("|");o.push(...s),a.forEach(a=>{const l=t[`${e}::${a}`]||[],s=jt.value.values.map((t,e)=>{const a=jt.value.aggregations[e];return Kt(l,t,a)});o.push(1===s.length?s[0]:s.join(" / "))}),l.push(o)}),{table:l,headers:o}},Zt=t=>{const e=jt.value[t];if(0===e.length)return[""];const a=new Set;return Rt.value.forEach(t=>{const o=e.map(e=>t[e]).join("|");a.add(o)}),Array.from(a).sort()},Kt=(t,e,a)=>{if(0===t.length)return 0;const o=t.map(t=>Number(t[e])||0);switch(a){case"sum":return o.reduce((t,e)=>t+e,0);case"count":return t.length;case"avg":return o.reduce((t,e)=>t+e,0)/o.length;case"min":return Math.min(...o);case"max":return Math.max(...o);default:return 0}},Xt=()=>{if(0===Lt.value.length)return;const t=[Nt.value.join(","),...Lt.value.map(t=>t.map(t=>`"${t}"`).join(","))].join("\n"),e=new Blob([t],{type:"text/csv"}),a=URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download=`pivot-table-${Date.now()}.csv`,o.click(),URL.revokeObjectURL(a)},Yt=async()=>{if(0===Lt.value.length)return;const t=[Nt.value.join("\t"),...Lt.value.map(t=>t.join("\t"))].join("\n");try{await navigator.clipboard.writeText(t),k.success(S("tools.dataPivotTable.messages.tableCopied"))}catch(e){}};return(t,e)=>(m(),l("div",f,[s("div",C,[s("h1",null,n(t.$t("tools.dataPivotTable.title")),1),s("p",null,n(t.$t("tools.dataPivotTable.description")),1)]),s("div",T,[s("div",$,[s("h3",null,n(t.$t("tools.dataPivotTable.dataImport.title")),1),s("div",D,[(m(),l(i,null,c(Ft,e=>s("button",{key:e.key,class:u(["tab-button",{active:Et.value===e.key}]),onClick:t=>Et.value=e.key},n(t.$t(`tools.dataPivotTable.importTabs.${e.key}`)),11,x)),64))]),"csv"===Et.value?(m(),l("div",w,[s("div",Q,[s("input",{ref_key:"csvFileInput",ref:Mt,type:"file",accept:".csv",class:"file-input",onChange:It},null,544),s("button",{class:"btn btn-secondary",onClick:e[0]||(e[0]=t=>Mt.value?.click())},n(t.$t("tools.dataPivotTable.buttons.uploadCSV")),1)]),s("div",E,[v(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>Ut.value=t),placeholder:t.$t("tools.dataPivotTable.csvImport.placeholder"),class:"csv-textarea",rows:"8"},null,8,U),[[d,Ut.value]]),s("button",{class:"btn btn-primary",onClick:At},n(t.$t("tools.dataPivotTable.buttons.parseData")),1)])])):r("",!0),"sample"===Et.value?(m(),l("div",R,[s("div",j,[(m(),l(i,null,c(Ht,e=>s("div",{key:e.key,class:"sample-card",onClick:t=>(t=>{Rt.value=[...t.data],Jt(),Et.value="csv"})(e)},[s("h4",null,n(t.$t(`tools.dataPivotTable.sampleData.${e.key}`)),1),s("p",null,n(t.$t(`tools.dataPivotTable.sampleData.${e.key}Description`)),1),s("div",L,n(e.data.length)+" "+n(t.$t("tools.dataPivotTable.sampleData.rows")),1)],8,B)),64))])])):r("",!0)]),Rt.value.length>0?(m(),l("div",N,[s("h3",null,n(t.$t("tools.dataPivotTable.pivotConfig.title")),1),s("div",M,[s("div",F,[s("h4",null,n(t.$t("tools.dataPivotTable.pivotConfig.availableFields")),1),s("div",H,[(m(!0),l(i,null,c(Vt.value,t=>(m(),l("div",{key:t,class:"field-item",draggable:"true",onDragstart:e=>((t,e)=>{t.dataTransfer&&t.dataTransfer.setData("text/plain",e)})(e,t)},[(m(),p(b(Qt),{class:"field-icon"})),g(" "+n(t),1)],40,V))),128))])]),s("div",I,[s("div",A,[s("h4",null,n(t.$t("tools.dataPivotTable.pivotConfig.rows")),1),s("div",{class:"drop-zone",onDrop:e[2]||(e[2]=t=>_t(t,"rows")),onDragover:e[3]||(e[3]=h(()=>{},["prevent"])),onDragenter:e[4]||(e[4]=h(()=>{},["prevent"]))},[(m(!0),l(i,null,c(jt.value.rows,(t,e)=>(m(),l("div",{key:`row-${e}`,class:"field-tag"},[g(n(t)+" ",1),s("button",{class:"remove-btn",onClick:t=>zt("rows",e)}," × ",8,_)]))),128)),0===jt.value.rows.length?(m(),l("div",z,n(t.$t("tools.dataPivotTable.pivotConfig.dropHere")),1)):r("",!0)],32)]),s("div",J,[s("h4",null,n(t.$t("tools.dataPivotTable.pivotConfig.columns")),1),s("div",{class:"drop-zone",onDrop:e[5]||(e[5]=t=>_t(t,"columns")),onDragover:e[6]||(e[6]=h(()=>{},["prevent"])),onDragenter:e[7]||(e[7]=h(()=>{},["prevent"]))},[(m(!0),l(i,null,c(jt.value.columns,(t,e)=>(m(),l("div",{key:`col-${e}`,class:"field-tag"},[g(n(t)+" ",1),s("button",{class:"remove-btn",onClick:t=>zt("columns",e)}," × ",8,O)]))),128)),0===jt.value.columns.length?(m(),l("div",W,n(t.$t("tools.dataPivotTable.pivotConfig.dropHere")),1)):r("",!0)],32)]),s("div",q,[s("h4",null,n(t.$t("tools.dataPivotTable.pivotConfig.values")),1),s("div",{class:"drop-zone",onDrop:e[8]||(e[8]=t=>_t(t,"values")),onDragover:e[9]||(e[9]=h(()=>{},["prevent"])),onDragenter:e[10]||(e[10]=h(()=>{},["prevent"]))},[(m(!0),l(i,null,c(jt.value.values,(e,a)=>(m(),l("div",{key:`val-${a}`,class:"field-tag"},[g(n(e)+" ",1),v(s("select",{"onUpdate:modelValue":t=>jt.value.aggregations[a]=t,class:"aggregation-select",onChange:Wt},[s("option",Z,n(t.$t("tools.dataPivotTable.aggregations.sum")),1),s("option",K,n(t.$t("tools.dataPivotTable.aggregations.count")),1),s("option",X,n(t.$t("tools.dataPivotTable.aggregations.avg")),1),s("option",Y,n(t.$t("tools.dataPivotTable.aggregations.min")),1),s("option",tt,n(t.$t("tools.dataPivotTable.aggregations.max")),1)],40,G),[[P,jt.value.aggregations[a]]]),s("button",{class:"remove-btn",onClick:t=>zt("values",a)}," × ",8,et)]))),128)),0===jt.value.values.length?(m(),l("div",at,n(t.$t("tools.dataPivotTable.pivotConfig.dropHere")),1)):r("",!0)],32)]),s("div",ot,[s("h4",null,n(t.$t("tools.dataPivotTable.pivotConfig.filters")),1),s("div",{class:"drop-zone",onDrop:e[11]||(e[11]=t=>_t(t,"filters")),onDragover:e[12]||(e[12]=h(()=>{},["prevent"])),onDragenter:e[13]||(e[13]=h(()=>{},["prevent"]))},[(m(!0),l(i,null,c(jt.value.filters,(e,a)=>(m(),l("div",{key:`filter-${a}`,class:"field-tag"},[g(n(e)+" ",1),v(s("select",{"onUpdate:modelValue":t=>Bt.value[e]=t,class:"filter-select",onChange:Wt},[s("option",st,n(t.$t("tools.dataPivotTable.filters.all")),1),(m(!0),l(i,null,c(Ot(e),t=>(m(),l("option",{key:t,value:t},n(t),9,nt))),128))],40,lt),[[P,Bt.value[e]]]),s("button",{class:"remove-btn",onClick:t=>zt("filters",a)}," × ",8,rt)]))),128)),0===jt.value.filters.length?(m(),l("div",it,n(t.$t("tools.dataPivotTable.pivotConfig.dropHere")),1)):r("",!0)],32)])])]),s("div",ct,[s("button",{class:"btn btn-primary",onClick:Wt},n(t.$t("tools.dataPivotTable.buttons.generateTable")),1),s("button",{class:"btn btn-secondary",onClick:Jt},n(t.$t("tools.dataPivotTable.buttons.clearConfig")),1)])])):r("",!0),Rt.value.length>0?(m(),l("div",ut,[s("h3",null,n(t.$t("tools.dataPivotTable.rawData.title"))+" ("+n(Rt.value.length)+" "+n(t.$t("tools.dataPivotTable.rawData.rows"))+")",1),s("div",vt,[s("table",dt,[s("thead",null,[s("tr",null,[(m(!0),l(i,null,c(Vt.value,t=>(m(),l("th",{key:t},n(t),1))),128))])]),s("tbody",null,[(m(!0),l(i,null,c(Rt.value.slice(0,10),(t,e)=>(m(),l("tr",{key:e},[(m(!0),l(i,null,c(Vt.value,e=>(m(),l("td",{key:e},n(t[e]),1))),128))]))),128))])]),Rt.value.length>10?(m(),l("div",pt,n(t.$t("tools.dataPivotTable.rawData.showingFirst10")),1)):r("",!0)])])):r("",!0),Lt.value.length>0?(m(),l("div",gt,[s("div",bt,[s("h3",null,n(t.$t("tools.dataPivotTable.pivotResult.title")),1),s("div",ht,[s("button",{class:"btn btn-secondary",onClick:Xt},n(t.$t("tools.dataPivotTable.buttons.exportCSV")),1),s("button",{class:"btn btn-secondary",onClick:Yt},n(t.$t("tools.dataPivotTable.buttons.copyTable")),1)])]),s("div",Pt,[s("table",mt,[s("thead",null,[s("tr",null,[(m(!0),l(i,null,c(Nt.value,(t,e)=>(m(),l("th",{key:e,class:u({"row-header":e<jt.value.rows.length})},n(t),3))),128))])]),s("tbody",null,[(m(!0),l(i,null,c(Lt.value,(t,e)=>(m(),l("tr",{key:e},[(m(!0),l(i,null,c(t,(t,e)=>{return m(),l("td",{key:e,class:u({"row-header":e<jt.value.rows.length,numeric:e>=jt.value.rows.length&&"number"==typeof t})},n("number"==typeof(a=t)?a.toLocaleString(void 0,{maximumFractionDigits:2}):String(a)),3);var a}),128))]))),128))])])])])):0===Rt.value.length?(m(),l("div",yt,[s("div",kt,[(m(),p(b(wt),{class:"getting-started-icon"})),s("h3",null,n(t.$t("tools.dataPivotTable.gettingStarted.title")),1),s("p",null,n(t.$t("tools.dataPivotTable.gettingStarted.description")),1),s("div",St,[s("div",ft,[e[14]||(e[14]=s("div",{class:"step-number"}," 1 ",-1)),s("div",Ct,[s("h4",null,n(t.$t("tools.dataPivotTable.gettingStarted.step1")),1),s("p",null,n(t.$t("tools.dataPivotTable.gettingStarted.step1Description")),1)])]),s("div",Tt,[e[15]||(e[15]=s("div",{class:"step-number"}," 2 ",-1)),s("div",$t,[s("h4",null,n(t.$t("tools.dataPivotTable.gettingStarted.step2")),1),s("p",null,n(t.$t("tools.dataPivotTable.gettingStarted.step2Description")),1)])]),s("div",Dt,[e[16]||(e[16]=s("div",{class:"step-number"}," 3 ",-1)),s("div",xt,[s("h4",null,n(t.$t("tools.dataPivotTable.gettingStarted.step3")),1),s("p",null,n(t.$t("tools.dataPivotTable.gettingStarted.step3Description")),1)])])])])])):r("",!0)])]))}}),[["__scopeId","data-v-b1da5ad5"]]);export{wt as default};
