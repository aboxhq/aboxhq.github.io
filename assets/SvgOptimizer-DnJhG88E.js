import{a as e,u as t,r as o,L as s,c as i,e as l,f as a,t as n,y as r,M as c,n as p,I as v,J as u,q as d,K as m,F as g,g as f,k as z,j as h}from"./vendor-sPCxxDNi.js";import{t as y}from"./toast-CSo0l4e7.js";import{_ as b}from"./index-BFyA9hmL.js";import"./qr-DE_AbQYC.js";const k={class:"svg-optimizer"},O={class:"tool-header"},C={class:"optimizer-container"},x={class:"upload-content"},$={class:"upload-text"},w={class:"upload-hint"},U={class:"optimization-options"},M={class:"options-grid"},L={class:"option-group"},D={class:"value"},j={class:"option-group"},S={class:"option-group"},B={class:"option-group"},R={class:"option-group"},_={class:"option-group"},A={key:0,class:"files-section"},E={class:"files-list"},T={class:"file-info"},H={class:"file-details"},V={class:"file-name"},F={class:"file-size"},P={key:0,class:"size-reduction"},I={class:"file-status"},q={key:0,class:"status optimizing"},K={key:1,class:"status completed"},G={key:2,class:"status error"},J=["onClick"],Y={class:"action-buttons"},Z=["disabled"],N={key:1,class:"preview-section"},Q={class:"preview-container"},W={class:"preview-item"},X=["innerHTML"],ee={class:"preview-item"},te=["innerHTML"],oe=b(e({__name:"SvgOptimizer",setup(e){const{t:b}=t(),oe=o([]),se=o(!1),ie=o(!1),le=o(),ae=o(null),ne=s({precision:3,removeComments:!0,removeMetadata:!0,removeUnusedDefs:!0,mergePaths:!1,convertColors:!1}),re=i(()=>oe.value.some(e=>"completed"===e.status));function ce(e){if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]}function pe(e){e.preventDefault(),se.value=!0}function ve(e){e.preventDefault(),se.value=!1}function ue(e){e.preventDefault(),se.value=!1;Array.from(e.dataTransfer?.files||[]).filter(e=>"image/svg+xml"===e.type).forEach(e=>me(e))}function de(e){Array.from(e.target.files||[]).forEach(e=>me(e))}function me(e){const t=new FileReader;t.onload=t=>{const o=t.target?.result,s={file:e,name:e.name,originalSize:e.size,status:"pending",originalContent:o};oe.value.push(s),1===oe.value.length&&(ae.value=s,ge(s))},t.readAsText(e)}async function ge(e){e.status="optimizing";try{let t=e.originalContent;ne.removeComments&&(t=t.replace(/<!--[\s\S]*?-->/g,"")),ne.removeMetadata&&(t=t.replace(/<\?xml[^>]*\?>/g,""),t=t.replace(/<!DOCTYPE[^>]*>/g,"")),ne.removeUnusedDefs&&(t=t.replace(/<defs[^>]*>\s*<\/defs>/g,"")),t=t.replace(/\s+/g," "),t=t.replace(/>\s+</g,"><"),t=t.replace(/\s+\/>/g,"/>"),ne.precision>0&&(t=t.replace(/(\d*\.\d+)/g,e=>parseFloat(e).toFixed(ne.precision))),ne.convertColors&&(t=t.replace(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/g,(e,t,o,s)=>"#"+[t,o,s].map(e=>{const t=parseInt(e).toString(16);return 1===t.length?"0"+t:t}).join(""))),e.optimizedContent=t,e.optimizedSize=new Blob([t]).size,e.status="completed",y.success(b("tools.svgOptimizer.optimizationSuccess",{name:e.name}))}catch(t){e.status="error",e.error=t instanceof Error?t.message:"Unknown error",y.error(b("tools.svgOptimizer.optimizationError",{name:e.name}))}}async function fe(){ie.value=!0;const e=oe.value.filter(e=>"pending"===e.status);for(const t of e)await ge(t);ie.value=!1}function ze(e){if(!e.optimizedContent)return;const t=new Blob([e.optimizedContent],{type:"image/svg+xml"}),o=URL.createObjectURL(t),s=document.createElement("a");s.href=o,s.download=`optimized_${e.name}`,s.click(),URL.revokeObjectURL(o)}function he(){const e=oe.value.filter(e=>"completed"===e.status);if(0===e.length)return;if(1===e.length)return void ze(e[0]);const t=new(require("jszip"));e.forEach(e=>{e.optimizedContent&&t.file(`optimized_${e.name}`,e.optimizedContent)}),t.generateAsync({type:"blob"}).then(e=>{const t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download="optimized_svgs.zip",o.click(),URL.revokeObjectURL(t)})}function ye(){oe.value=[],ae.value=null,le.value&&(le.value.value="")}return(e,t)=>(h(),l("div",k,[a("div",O,[a("h1",null,n(e.$t("tools.svgOptimizer.title")),1),a("p",null,n(e.$t("tools.svgOptimizer.description")),1)]),a("div",C,[a("div",{class:p(["upload-area",{"drag-over":se.value}]),onDrop:c(ue,["prevent"]),onDragover:c(pe,["prevent"]),onDragleave:c(ve,["prevent"]),onClick:t[0]||(t[0]=e=>le.value?.click())},[a("input",{ref_key:"fileInput",ref:le,type:"file",accept:".svg",multiple:"",class:"file-input",onChange:de},null,544),a("div",x,[t[7]||(t[7]=a("svg",{class:"upload-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[a("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a("polyline",{points:"17 8 12 3 7 8"}),a("line",{x1:"12",y1:"3",x2:"12",y2:"15"})],-1)),a("p",$,n(e.$t("tools.svgOptimizer.uploadText")),1),a("p",w,n(e.$t("tools.svgOptimizer.uploadHint")),1)])],34),a("div",U,[a("h3",null,n(e.$t("tools.svgOptimizer.optimizationOptions")),1),a("div",M,[a("div",L,[a("label",null,n(e.$t("tools.svgOptimizer.precision")),1),v(a("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>ne.precision=e),type:"range",min:"1",max:"10",step:"1",class:"slider"},null,512),[[u,ne.precision,void 0,{number:!0}]]),a("span",D,n(ne.precision),1)]),a("div",j,[a("label",null,[v(a("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>ne.removeComments=e),type:"checkbox",class:"checkbox"},null,512),[[m,ne.removeComments]]),d(" "+n(e.$t("tools.svgOptimizer.removeComments")),1)])]),a("div",S,[a("label",null,[v(a("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>ne.removeMetadata=e),type:"checkbox",class:"checkbox"},null,512),[[m,ne.removeMetadata]]),d(" "+n(e.$t("tools.svgOptimizer.removeMetadata")),1)])]),a("div",B,[a("label",null,[v(a("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>ne.removeUnusedDefs=e),type:"checkbox",class:"checkbox"},null,512),[[m,ne.removeUnusedDefs]]),d(" "+n(e.$t("tools.svgOptimizer.removeUnusedDefs")),1)])]),a("div",R,[a("label",null,[v(a("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>ne.mergePaths=e),type:"checkbox",class:"checkbox"},null,512),[[m,ne.mergePaths]]),d(" "+n(e.$t("tools.svgOptimizer.mergePaths")),1)])]),a("div",_,[a("label",null,[v(a("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>ne.convertColors=e),type:"checkbox",class:"checkbox"},null,512),[[m,ne.convertColors]]),d(" "+n(e.$t("tools.svgOptimizer.convertColors")),1)])])])]),oe.value.length>0?(h(),l("div",A,[a("h3",null,n(e.$t("tools.svgOptimizer.filesList"))+" ("+n(oe.value.length)+")",1),a("div",E,[(h(!0),l(g,null,f(oe.value,o=>{return h(),l("div",{key:o.name,class:"file-item"},[a("div",T,[t[8]||(t[8]=z('<svg class="file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-40d09c0c><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-40d09c0c></path><polyline points="14 2 14 8 20 8" data-v-40d09c0c></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-40d09c0c></line><line x1="16" y1="17" x2="8" y2="17" data-v-40d09c0c></line><polyline points="10 9 9 9 8 9" data-v-40d09c0c></polyline></svg>',1)),a("div",H,[a("div",V,n(o.name),1),a("div",F,[d(n(ce(o.originalSize))+" ",1),o.optimizedSize?(h(),l("span",P," â†’ "+n(ce(o.optimizedSize))+" ("+n((s=o.originalSize,i=o.optimizedSize,Math.round(100*(1-i/s))))+"%) ",1)):r("",!0)])])]),a("div",I,["optimizing"===o.status?(h(),l("span",q,n(e.$t("tools.svgOptimizer.optimizing")),1)):"completed"===o.status?(h(),l("span",K,n(e.$t("tools.svgOptimizer.completed")),1)):"error"===o.status?(h(),l("span",G,n(e.$t("tools.svgOptimizer.error")),1)):r("",!0),"completed"===o.status?(h(),l("button",{key:3,class:"download-btn",onClick:e=>ze(o)},n(e.$t("tools.svgOptimizer.download")),9,J)):r("",!0)])]);var s,i}),128))]),a("div",Y,[a("button",{disabled:ie.value,class:"primary-btn",onClick:fe},n(ie.value?e.$t("tools.svgOptimizer.optimizingAll"):e.$t("tools.svgOptimizer.optimizeAll")),9,Z),re.value?(h(),l("button",{key:0,class:"secondary-btn",onClick:he},n(e.$t("tools.svgOptimizer.downloadAll")),1)):r("",!0),a("button",{class:"secondary-btn",onClick:ye},n(e.$t("tools.svgOptimizer.clearAll")),1)])])):r("",!0),ae.value?(h(),l("div",N,[a("h3",null,n(e.$t("tools.svgOptimizer.preview")),1),a("div",Q,[a("div",W,[a("h4",null,n(e.$t("tools.svgOptimizer.original")),1),a("div",{class:"svg-preview",innerHTML:ae.value.originalContent},null,8,X)]),a("div",ee,[a("h4",null,n(e.$t("tools.svgOptimizer.optimized")),1),ae.value.optimizedContent?(h(),l("div",{key:0,class:"svg-preview",innerHTML:ae.value.optimizedContent},null,8,te)):r("",!0)])])])):r("",!0)])]))}}),[["__scopeId","data-v-40d09c0c"]]);export{oe as default};
