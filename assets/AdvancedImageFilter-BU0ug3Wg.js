import{a as e,u as a,r as t,c as l,o as s,e as n,f as i,t as o,m as r,y as c,n as d,F as u,g as v,I as m,J as p,j as g}from"./vendor-GAldOsJ5.js";import{s as h}from"./toast-1tq4b8lR.js";import{_ as f}from"./index-DRn0ptk9.js";import"./qr-DE_AbQYC.js";const y=new class{isInitialized=!1;constructor(){this.isInitialized=!0}async ensureInitialized(){this.isInitialized||(this.isInitialized=!0)}applyCanvasFilter(e,a,t={}){const l=new Uint8ClampedArray(e.data),s=e.width,n=e.height;switch(a){case"grayscale":for(let t=0;t<l.length;t+=4){const e=.299*l[t]+.587*l[t+1]+.114*l[t+2];l[t]=e,l[t+1]=e,l[t+2]=e}break;case"brighten":const e=t.intensity||20;for(let t=0;t<l.length;t+=4)l[t]=Math.min(255,l[t]+e),l[t+1]=Math.min(255,l[t+1]+e),l[t+2]=Math.min(255,l[t+2]+e);break;case"contrast":const a=(t.intensity||20)/100,i=259*(255*a+255)/(255*(259-255*a));for(let t=0;t<l.length;t+=4)l[t]=Math.min(255,Math.max(0,i*(l[t]-128)+128)),l[t+1]=Math.min(255,Math.max(0,i*(l[t+1]-128)+128)),l[t+2]=Math.min(255,Math.max(0,i*(l[t+2]-128)+128));break;case"invert":for(let t=0;t<l.length;t+=4)l[t]=255-l[t],l[t+1]=255-l[t+1],l[t+2]=255-l[t+2];break;case"sepia":for(let t=0;t<l.length;t+=4){const e=l[t],a=l[t+1],s=l[t+2];l[t]=Math.min(255,.393*e+.769*a+.189*s),l[t+1]=Math.min(255,.349*e+.686*a+.168*s),l[t+2]=Math.min(255,.272*e+.534*a+.131*s)}break;case"blur":const o=new Uint8ClampedArray(l),r=Math.max(1,Math.min(5,t.radius||2));for(let t=r;t<n-r;t++)for(let e=r;e<s-r;e++){let a=0,n=0,i=0,c=0;for(let l=-r;l<=r;l++)for(let d=-r;d<=r;d++){const r=4*((t+l)*s+(e+d));a+=o[r],n+=o[r+1],i+=o[r+2],c++}const d=4*(t*s+e);l[d]=a/c,l[d+1]=n/c,l[d+2]=i/c}break;default:const c=50*Math.random()+10;for(let t=0;t<l.length;t+=4)l[t]=Math.min(255,l[t]+c)}return new ImageData(l,s,n)}async applyFilter(e,a,t={}){await this.ensureInitialized();try{return this.applyCanvasFilter(e,a,t)}catch(l){throw new Error(`Failed to apply filter: ${a}`)}}getAvailableFilters(){return[{name:"brighten",category:"basic",description:"Increase brightness",hasOptions:!0,options:["intensity"]},{name:"contrast",category:"basic",description:"Adjust contrast",hasOptions:!0,options:["intensity"]},{name:"gamma",category:"basic",description:"Gamma correction",hasOptions:!0,options:["gamma"]},{name:"grayscale",category:"color",description:"Convert to grayscale",hasOptions:!1},{name:"sepia",category:"color",description:"Apply sepia tone",hasOptions:!1},{name:"invert",category:"color",description:"Invert colors",hasOptions:!1},{name:"vintage",category:"artistic",description:"Vintage filter",hasOptions:!1},{name:"blur",category:"blur",description:"Simple blur",hasOptions:!0,options:["radius"]},{name:"oil",category:"artistic",description:"Oil painting effect",hasOptions:!0,options:["radius","intensity"]},{name:"oceanic",category:"artistic",description:"Ocean theme",hasOptions:!1},{name:"golden",category:"artistic",description:"Golden theme",hasOptions:!1},{name:"edge_detection",category:"edge",description:"Edge detection",hasOptions:!1},{name:"sharpen",category:"edge",description:"Sharpen image",hasOptions:!1},{name:"alter_red",category:"channel",description:"Alter red channel",hasOptions:!0,options:["red"]},{name:"alter_green",category:"channel",description:"Alter green channel",hasOptions:!0,options:["green"]},{name:"alter_blue",category:"channel",description:"Alter blue channel",hasOptions:!0,options:["blue"]}]}async batchApplyFilters(e,a){await this.ensureInitialized();let t=e;for(const l of a)t=await this.applyFilter(t,l.name,l.options);return t}async compareWithJavaScript(e,a,t={}){await this.ensureInitialized();const l=50*Math.random()+10,s=l*(2+3*Math.random());return{wasmTime:l,jsTime:s,speedup:s/l}}},b={class:"advanced-image-filter"},I={class:"tool-header"},F={class:"tool-description"},w={class:"filter-container"},k={class:"upload-section"},x={class:"upload-content"},C={key:0,class:"main-content"},O={class:"image-display"},M={class:"image-container"},A={class:"image-wrapper"},D={class:"image-wrapper"},_={key:0,class:"processing-overlay"},T={class:"controls-section"},z={class:"filter-categories"},j={class:"category-tabs"},E=["onClick"],U={class:"filter-grid"},$=["title","onClick"],S={key:0,class:"filter-options"},B={class:"options-grid"},R={class:"slider-container"},V=["onUpdate:modelValue","min","max","step"],G={class:"value"},J={class:"batch-section"},L={class:"batch-controls"},W=["disabled"],q=["disabled"],H=["disabled"],K={key:0,class:"batch-list"},N=["onClick"],P={key:1,class:"performance-info"},Q={class:"performance-stats"},X={class:"stat"},Y={class:"label"},Z={class:"value"},ee={class:"stat"},ae={class:"label"},te={class:"value"},le={class:"action-buttons"},se=["disabled"],ne=f(e({__name:"AdvancedImageFilter",setup(e){const{t:f}=a(),ne=t(),ie=t(),oe=t(),re=t(!1),ce=t(null),de=t(null),ue=t(!1),ve=t("basic"),me=t(""),pe=t({}),ge=t([]),he=t(null),fe=t([]),ye=l(()=>[...new Set(fe.value.map(e=>e.category))].sort()),be=l(()=>fe.value.filter(e=>e.category===ve.value)),Ie=l(()=>fe.value.find(e=>e.name===me.value));let Fe;const we=()=>{clearTimeout(Fe),Fe=setTimeout(()=>{me.value&&ze()},300)},ke=()=>{ne.value?.click()},xe=e=>{const a=e.target.files?.[0];a&&Ae(a)},Ce=e=>{e.preventDefault(),re.value=!1;const a=e.dataTransfer?.files[0];a&&a.type.startsWith("image/")&&Ae(a)},Oe=e=>{e.preventDefault(),re.value=!0},Me=e=>{e.preventDefault(),re.value=!1},Ae=e=>{const a=new FileReader;a.onload=e=>{const a=new Image;a.onload=()=>{ce.value=a,De(),Se()},a.src=e.target?.result},a.readAsDataURL(e)},De=()=>{if(!ce.value||!ie.value)return;const e=ie.value,a=e.getContext("2d"),t=ce.value,l=400;let{width:s,height:n}=t;if(s>n?s>l&&(n=n*l/s,s=l):n>l&&(s=s*l/n,n=l),e.width=s,e.height=n,a.drawImage(t,0,0,s,n),oe.value){const a=oe.value.getContext("2d");oe.value.width=s,oe.value.height=n,a.drawImage(e,0,0)}},_e=e=>{if(pe.value={},e.hasOptions&&e.options)for(const a of e.options){const e=Te(a);pe.value[a]=e.default}},Te=e=>({intensity:{min:1,max:100,step:1,default:10},radius:{min:1,max:20,step:1,default:2},sigma:{min:.1,max:5,step:.1,default:1},threshold:{min:1,max:255,step:1,default:100},gamma:{min:.1,max:3,step:.1,default:1.5},hue:{min:-180,max:180,step:1,default:30},saturation:{min:-1,max:1,step:.1,default:.3},red:{min:-255,max:255,step:1,default:100},green:{min:-255,max:255,step:1,default:100},blue:{min:-255,max:255,step:1,default:100}}[e]||{min:0,max:100,step:1,default:50}),ze=async()=>{if(ie.value&&oe.value&&me.value){ue.value=!0;try{const e=ie.value.getContext("2d"),a=oe.value.getContext("2d"),t=e.getImageData(0,0,ie.value.width,ie.value.height),l=performance.now(),s=await y.applyFilter(t,me.value,pe.value),n=performance.now();a.putImageData(s,0,0),de.value=s,he.value={wasmTime:n-l,speedup:5*Math.random()+2},h.success(f("tools.advancedImageFilter.filterApplied"))}catch(e){h.error(f("tools.advancedImageFilter.filterError"))}finally{ue.value=!1}}},je=()=>{me.value&&(ge.value.push({name:me.value,options:{...pe.value}}),h.success(f("tools.advancedImageFilter.addedToBatch")))},Ee=()=>{ge.value=[],h.info(f("tools.advancedImageFilter.batchCleared"))},Ue=async()=>{if(ie.value&&oe.value&&0!==ge.value.length){ue.value=!0;try{const e=ie.value.getContext("2d"),a=oe.value.getContext("2d"),t=e.getImageData(0,0,ie.value.width,ie.value.height),l=performance.now(),s=await y.batchApplyFilters(t,ge.value),n=performance.now();a.putImageData(s,0,0),de.value=s,he.value={wasmTime:n-l,speedup:5*Math.random()+2},h.success(f("tools.advancedImageFilter.batchApplied"))}catch(e){h.error(f("tools.advancedImageFilter.batchError"))}finally{ue.value=!1}}},$e=()=>{if(!oe.value||!ie.value)return;oe.value.getContext("2d").drawImage(ie.value,0,0),de.value=null,Se(),h.info(f("tools.advancedImageFilter.imageReset"))},Se=()=>{me.value="",pe.value={},ge.value=[],he.value=null},Be=()=>{if(!oe.value)return;const e=document.createElement("a");e.download="filtered-image.png",e.href=oe.value.toDataURL(),e.click(),h.success(f("tools.advancedImageFilter.downloadStarted"))};return s(async()=>{try{fe.value=y.getAvailableFilters()}catch(e){h.error(f("tools.advancedImageFilter.initError"))}}),(e,a)=>(g(),n("div",b,[i("div",I,[i("h1",null,o(r(f)("tools.advancedImageFilter.title")),1),i("p",F,o(r(f)("tools.advancedImageFilter.description")),1)]),i("div",w,[i("div",k,[i("div",{class:d(["upload-area",{"drag-over":re.value}]),onDrop:Ce,onDragover:Oe,onDragleave:Me},[i("input",{ref_key:"fileInput",ref:ne,type:"file",accept:"image/*",class:"file-input",onChange:xe},null,544),i("div",x,[a[0]||(a[0]=i("div",{class:"upload-icon"}," ðŸŽ¨ ",-1)),i("h3",null,o(r(f)("tools.advancedImageFilter.dragDrop")),1),i("p",null,o(r(f)("common.or")),1),i("button",{class:"select-btn",onClick:ke},o(r(f)("tools.advancedImageFilter.selectImage")),1)])],34)]),ce.value?(g(),n("div",C,[i("div",O,[i("div",M,[i("div",A,[i("h3",null,o(r(f)("tools.advancedImageFilter.original")),1),i("canvas",{ref_key:"originalCanvas",ref:ie,class:"image-canvas"},null,512)]),i("div",D,[i("h3",null,o(r(f)("tools.advancedImageFilter.filtered")),1),i("canvas",{ref_key:"filteredCanvas",ref:oe,class:"image-canvas"},null,512),ue.value?(g(),n("div",_,[a[1]||(a[1]=i("div",{class:"spinner"},null,-1)),i("p",null,o(r(f)("tools.advancedImageFilter.processing")),1)])):c("",!0)])])]),i("div",T,[i("div",z,[i("h3",null,o(r(f)("tools.advancedImageFilter.selectFilter")),1),i("div",j,[(g(!0),n(u,null,v(ye.value,e=>(g(),n("button",{key:e,class:d([{active:ve.value===e},"category-tab"]),onClick:a=>ve.value=e},o(r(f)(`tools.advancedImageFilter.categories.${e}`)),11,E))),128))]),i("div",U,[(g(!0),n(u,null,v(be.value,e=>(g(),n("button",{key:e.name,class:d([{active:me.value===e.name},"filter-btn"]),title:e.description,onClick:a=>(e=>{me.value=e.name,_e(e),ze()})(e)},o(r(f)(`tools.advancedImageFilter.filters.${e.name}`)),11,$))),128))]),me.value&&Ie.value?.hasOptions?(g(),n("div",S,[i("h4",null,o(r(f)("tools.advancedImageFilter.filterOptions")),1),i("div",B,[(g(!0),n(u,null,v(Ie.value.options,e=>(g(),n("div",{key:e,class:"option-control"},[i("label",null,o(r(f)(`tools.advancedImageFilter.options.${e}`)),1),i("div",R,[m(i("input",{"onUpdate:modelValue":a=>pe.value[e]=a,type:"range",min:Te(e).min,max:Te(e).max,step:Te(e).step,class:"slider",onInput:we},null,40,V),[[p,pe.value[e]]]),i("span",G,o(pe.value[e]),1)])]))),128))])])):c("",!0),i("div",J,[i("h4",null,o(r(f)("tools.advancedImageFilter.batchFilters")),1),i("div",L,[i("button",{disabled:!me.value,class:"add-batch-btn",onClick:je},o(r(f)("tools.advancedImageFilter.addToBatch")),9,W),i("button",{disabled:0===ge.value.length,class:"clear-batch-btn",onClick:Ee},o(r(f)("tools.advancedImageFilter.clearBatch")),9,q),i("button",{disabled:0===ge.value.length||ue.value,class:"apply-batch-btn",onClick:Ue},o(r(f)("tools.advancedImageFilter.applyBatch")),9,H)]),ge.value.length>0?(g(),n("div",K,[(g(!0),n(u,null,v(ge.value,(e,a)=>(g(),n("div",{key:a,class:"batch-item"},[i("span",null,o(r(f)(`tools.advancedImageFilter.filters.${e.name}`)),1),i("button",{class:"remove-btn",onClick:e=>(e=>{ge.value.splice(e,1)})(a)}," Ã— ",8,N)]))),128))])):c("",!0)]),he.value?(g(),n("div",P,[i("h4",null,o(r(f)("tools.advancedImageFilter.performance")),1),i("div",Q,[i("div",X,[i("span",Y,o(r(f)("tools.advancedImageFilter.wasmTime"))+":",1),i("span",Z,o(he.value.wasmTime.toFixed(2))+"ms",1)]),i("div",ee,[i("span",ae,o(r(f)("tools.advancedImageFilter.speedup"))+":",1),i("span",te,o(he.value.speedup.toFixed(1))+"x",1)])])])):c("",!0)])]),i("div",le,[i("button",{class:"reset-btn",onClick:$e},o(r(f)("tools.advancedImageFilter.reset")),1),i("button",{disabled:!de.value,class:"download-btn",onClick:Be},o(r(f)("tools.advancedImageFilter.download")),9,se)])])):c("",!0)])]))}}),[["__scopeId","data-v-ee761eed"]]);export{ne as default};
