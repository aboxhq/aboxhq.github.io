import{a as e,u as a,c as s,r as t,o as l,V as o,e as r,f as i,t as n,y as c,M as u,n as d,k as p,q as v,I as m,O as y,F as g,g as h,J as f,N as w,K as b,s as k,j as P}from"./vendor-sPCxxDNi.js";import{s as M}from"./toast-CSo0l4e7.js";import{P as x}from"./PDFButton-CqQYl2ho.js";import{_ as C}from"./index-BFyA9hmL.js";import"./qr-DE_AbQYC.js";class D{worker=null;isInitialized=!1;wasmLoaded=!1;async initialize(){if(!this.isInitialized)try{this.worker=new Worker(new URL("/assets/pdfcpuWorker-DCSWcq0S.js",import.meta.url),{type:"module"}),await new Promise((e,a)=>{const s=setTimeout(()=>{a(new Error("pdfcpu WASM 初始化超时"))},3e4);this.worker.onmessage=t=>{const{type:l,success:o,error:r}=t.data;"init"===l&&(clearTimeout(s),o?(this.isInitialized=!0,this.wasmLoaded=!0,e()):a(new Error(r||"pdfcpu WASM 初始化失败")))},this.worker.onerror=e=>{clearTimeout(s);const t=e.message||e.error?.message||"Worker 初始化失败";a(new Error(`Worker 错误: ${t}`))},this.worker.postMessage({type:"init"})})}catch(e){throw e}}async getPdfInfo(e,a){if(!this.isInitialized||!this.worker)throw new Error("pdfcpu 服务未初始化");return new Promise((s,t)=>{const l=setTimeout(()=>{t(new Error("PDF 信息获取超时"))},6e4);this.worker.onmessage=e=>{const{type:o,success:r,data:i,error:n,progress:c}=e.data;switch(o){case"progress":a&&a({stage:c.stage,progress:c.progress,message:c.message});break;case"info_complete":clearTimeout(l),r?s(i):t(new Error(n||"PDF 信息获取失败"));break;case"error":clearTimeout(l);const o=new Error(n||"未知错误");e.data.stderr&&(o.stderr=e.data.stderr),void 0!==e.data.exitCode&&(o.exitCode=e.data.exitCode),t(o)}},this.worker.onerror=e=>{clearTimeout(l),t(new Error(`Worker 错误: ${e.message}`))},this.worker.postMessage({type:"info",data:e},[e.buffer])})}async optimizePDF(e,a={mode:"optimize"},s){if(!this.isInitialized||!this.worker)throw new Error("pdfcpu 服务未初始化");const t=Date.now(),l=e.byteLength;return new Promise((o,r)=>{const i=setTimeout(()=>{r(new Error("PDF 优化超时"))},3e5);this.worker.onmessage=e=>{const{type:a,success:n,data:c,error:u,progress:d,stats:p}=e.data;switch(a){case"progress":s&&s({stage:d.stage,progress:d.progress,message:d.message});break;case"optimize_complete":if(clearTimeout(i),n){const e=Date.now()-t,a=c.byteLength,s=Math.round((l-a)/l*100);o({compressedData:new Uint8Array(c),originalSize:l,compressedSize:a,compressionRatio:s,processingTime:e,stats:p})}else r(new Error(u||"PDF 优化失败"));break;case"error":clearTimeout(i),r(new Error(u||"未知错误"))}},this.worker.onerror=e=>{clearTimeout(i),r(new Error(`Worker 错误: ${e.message}`))},this.worker.postMessage({type:"optimize",data:e,options:a},[e.buffer])})}getSupportedModes(){return[{value:"optimize",label:"优化压缩",description:"优化 PDF 结构，移除冗余数据，减小文件大小",category:"compression"},{value:"compress",label:"深度压缩",description:"最大程度压缩文件大小，可能影响质量",category:"compression"},{value:"info",label:"文件信息",description:"获取 PDF 文件详细信息和属性",category:"analysis"},{value:"validate",label:"文件验证",description:"验证 PDF 文件结构是否符合标准",category:"analysis"},{value:"stats",label:"统计分析",description:"获取 PDF 文件统计数据和使用情况",category:"analysis"},{value:"decrypt",label:"解除加密",description:"移除 PDF 文件的密码保护",category:"security"},{value:"encrypt",label:"加密保护",description:"为 PDF 文件添加密码保护",category:"security"},{value:"split",label:"拆分文件",description:"将 PDF 文件拆分成多个单独的文件",category:"manipulation"},{value:"merge",label:"合并文件",description:"将多个 PDF 文件合并成一个文件",category:"manipulation"},{value:"extract",label:"内容提取",description:"提取 PDF 中的图片、字体或页面内容",category:"manipulation"}]}getDefaultOptions(){return{mode:"optimize",imageQuality:75,removeBookmarks:!1,removeAnnotations:!1,removeFormFields:!1,removeLinks:!1,removeMetadata:!0,removePageThumbnails:!0,removeUnusedObjects:!0,linearize:!0}}static isWasmSupported(){return"object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate}getStatus(){return{isInitialized:this.isInitialized,wasmLoaded:this.wasmLoaded,workerReady:null!==this.worker}}async executePdfcpuCommand(e,a,s={},t){if(!this.isInitialized||!this.worker)throw new Error("pdfcpu 服务未初始化");const l=Date.now(),o=Array.isArray(e)?e.reduce((e,a)=>e+a.byteLength,0):e.byteLength;return new Promise((r,i)=>{const n=setTimeout(()=>{i(new Error("pdfcpu 命令执行超时"))},3e5);this.worker.onmessage=e=>{const{type:a,success:s,data:c,error:u,progress:d,stats:p}=e.data;switch(a){case"progress":t&&t({stage:d.stage,progress:d.progress,message:d.message});break;case"command_complete":if(clearTimeout(n),s){const e=Date.now()-l,a=c?.byteLength||0,s=o>0?Math.round((o-a)/o*100):0;r({compressedData:c?new Uint8Array(c):new Uint8Array(0),originalSize:o,compressedSize:a,compressionRatio:s,processingTime:e,stats:p})}else i(new Error(u||"pdfcpu 命令执行失败"));break;case"error":clearTimeout(n);const a=new Error(u||"未知错误");e.data.stderr&&(a.stderr=e.data.stderr),void 0!==e.data.exitCode&&(a.exitCode=e.data.exitCode),i(a)}},this.worker.onerror=e=>{clearTimeout(n),i(new Error(`Worker 错误: ${e.message}`))};const c=[];Array.isArray(e)?e.forEach(e=>c.push(e.buffer)):c.push(e.buffer),this.worker.postMessage({type:"execute_command",command:a,data:e,options:{mode:a,...s}},c)})}async validatePDF(e,a){const s=await this.executePdfcpuCommand(e,"validate",{},a);return{isValid:s.stats?.isValid||!1,errors:s.stats?.errors||[],warnings:s.stats?.warnings||[]}}async encryptPDF(e,a,s,t){return this.executePdfcpuCommand(e,"encrypt",{password:a,permissions:s},t)}async decryptPDF(e,a,s){return this.executePdfcpuCommand(e,"decrypt",{password:a},s)}async splitPDF(e,a,s){return this.executePdfcpuCommand(e,"split",{pages:a},s)}async mergePDFs(e,a){return this.executePdfcpuCommand(e,"merge",{},a)}async extractFromPDF(e,a="images",s,t){return this.executePdfcpuCommand(e,"extract",{outputFormat:a,pages:s},t)}dispose(){this.worker&&(this.worker.terminate(),this.worker=null),this.isInitialized=!1,this.wasmLoaded=!1}}const F=new D,z={class:"pdf-compressor"},V={class:"tool-header"},A={class:"header-content"},T={class:"header-text"},L={class:"tool-content"},S={class:"upload-section"},$={key:0,class:"upload-placeholder"},U={class:"upload-text"},H={class:"file-types"},j={class:"file-info"},E={key:1,class:"file-info"},B={class:"file-details"},W={class:"file-meta"},I={class:"file-name"},R={class:"file-stats"},q={class:"file-size"},O={key:0,class:"compression-settings"},_={class:"settings-header"},K={class:"setting-group"},Z={class:"engine-options"},N={class:"radio-option"},G=["disabled"],J={key:0},Q={key:1},X={key:2,class:"engine-unavailable-text"},Y={key:3,class:"engine-status loading"},ee={key:4,class:"engine-status available"},ae={key:5,class:"engine-status unavailable"},se={key:0,class:"setting-group"},te={style:{background:"#f0f0f0",padding:"10px",margin:"10px 0","border-radius":"5px","font-size":"12px"}},le={class:"pdfcpu-operations"},oe={class:"operation-categories"},re=["onClick"],ie={class:"category-icon"},ne={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},ce=["d"],ue={class:"category-info"},de={class:"operation-modes"},pe=["value"],ve={class:"mode-title"},me={class:"mode-description"},ye={key:1,class:"setting-group"},ge={key:0,class:"command-options"},he={class:"option-row"},fe={class:"option-row"},we={class:"option-row"},be={class:"option-row"},ke={class:"option-row"},Pe={key:1,class:"command-options"},Me={class:"option-row"},xe={key:2,class:"command-options"},Ce={class:"option-row"},De={key:3,class:"command-options"},Fe={class:"option-row"},ze={class:"radio-group"},Ve={class:"radio-option-inline"},Ae={class:"radio-option-inline"},Te={key:2,class:"pdf-lib-options"},Le={class:"setting-group"},Se={class:"quality-options"},$e={class:"radio-option"},Ue={class:"radio-option"},He={class:"radio-option"},je={class:"setting-group"},Ee={class:"checkbox-option"},Be={class:"setting-group"},We={class:"checkbox-option"},Ie={key:1,class:"compression-progress"},Re={class:"progress-header"},qe={class:"progress-percentage"},Oe={class:"progress-bar"},_e={class:"progress-stage"},Ke={class:"progress-engine"},Ze={key:2,class:"action-buttons"},Ne=["disabled"],Ge={class:"btn-content"},Je={key:0,class:"loading-icon",viewBox:"0 0 24 24"},Qe={key:1,class:"compress-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Xe={class:"btn-content"},Ye={key:3,class:"compression-result"},ea={class:"result-header"},aa={class:"result-stats"},sa={class:"stat-item original-size"},ta={class:"stat-content"},la={class:"stat-label"},oa={class:"stat-value"},ra={class:"stat-item compressed-size"},ia={class:"stat-content"},na={class:"stat-label"},ca={class:"stat-value"},ua={class:"stat-item compression-ratio-item"},da={class:"ratio-circle"},pa={class:"ratio-progress",viewBox:"0 0 36 36"},va=["stroke-dasharray"],ma={class:"ratio-text"},ya={class:"ratio-number"},ga={class:"stat-label"},ha={key:4,class:"error-message"},fa=C(e({__name:"PDFCompressor",setup(e){const{t:C}=a(),fa=s(()=>[{key:"compression",name:"压缩优化",description:"减小文件大小，优化性能",icon:"M3 12h18m-9-9l9 9-9 9M8 8l4-4 4 4M8 16l4 4 4-4"},{key:"analysis",name:"分析检测",description:"获取文件信息和验证",icon:"M12 2a3 3 0 0 0 3 3v6a3 3 0 1 0-6 0V5a3 3 0 0 0 3-3zM21 12h-6M15 12H9M3 12h6"},{key:"security",name:"安全加密",description:"加密保护和权限管理",icon:"M12 1a6 6 0 0 1 6 6v3h1a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h1V7a6 6 0 0 1 6-6zM8 10V7a4 4 0 1 1 8 0v3H8z"},{key:"manipulation",name:"内容处理",description:"拆分合并和内容提取",icon:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM14 2v6h6M16 13H8M16 17H8M10 9H8"}]),wa=s(()=>F.getSupportedModes()),ba=s(()=>wa.value.filter(e=>e.category===Ha.value)),ka=s(()=>["encrypt","decrypt","split","extract"].includes(ja.value)),Pa=t(),Ma=t(null),xa=t(null),Ca=t(!1),Da=t(!1),Fa=t("medium"),za=t("pdf-lib"),Va=t(!0),Aa=t(!0),Ta=t(null),La=t(!1),Sa=t(!1),$a=t(""),Ua=t(null),Ha=t("compression"),ja=t("optimize"),Ea=t(""),Ba=t(""),Wa=t("all"),Ia=t("aes"),Ra=t(256),qa=t(""),Oa=t(""),_a=t("images"),Ka=()=>{Pa.value?.click()},Za=e=>{e.preventDefault(),Ca.value=!1;const a=e.dataTransfer?.files;if(a&&a.length>0){const e=a[0];"application/pdf"===e.type?(Ma.value=e,$a.value=""):$a.value=C("tools.pdfCompressor.errors.invalidFileType")}},Na=e=>{const a=e.target,s=a.files?.[0];s&&("application/pdf"===s.type?(Ma.value=s,$a.value=""):$a.value=C("tools.pdfCompressor.errors.invalidFileType"))},Ga=()=>{Ma.value=null,xa.value=null,Ua.value=null,$a.value="",Pa.value&&(Pa.value.value="")},Ja=e=>{if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]},Qa=async()=>{if(Ma.value){Da.value=!0,$a.value="",Ta.value=null;try{const a=Ma.value.size;let s,t,l;if("pdfcpu"===za.value&&La.value)try{const e=await Xa();s=e.bytes,t=e.size,l=e.ratio}catch(e){let a="pdfcpu 命令执行失败";if(e&&"object"==typeof e&&"stderr"in e){const s=e.stderr;if(s&&"string"==typeof s)if(s.includes("incompatible version"))a+="：PDF版本不兼容";else if(s.includes("parseTrailerDict"))a+="：PDF文件结构解析失败";else if(s.includes("xRefTable failed"))a+="：PDF交叉引用表损坏";else{a+=`：${s.substring(0,100).replace(/\n/g," ")}${s.length>100?"...":""}`}}if(["info","validate","encrypt","decrypt","split","merge","extract"].includes(ja.value))throw new Error(a);M.warning(a+"，已自动切换到 PDF-lib 引擎");const o=await Ya();s=o.bytes,t=o.size,l=o.ratio}else{"pdfcpu"!==za.value||La.value||M.info("pdfcpu 引擎不可用，已自动切换到 PDF-lib 引擎");const e=await Ya();s=e.bytes,t=e.size,l=e.ratio}xa.value=new Blob([s],{type:"application/pdf"}),Ua.value={originalSize:a,compressedSize:t,ratio:l},M.success(C("tools.pdfCompressor.messages.compressionSuccess"))}catch(e){let a=C("tools.pdfCompressor.errors.compressionFailed");if(e&&"object"==typeof e&&"stderr"in e){const s=e.stderr;if(s&&"string"==typeof s)if(s.includes("incompatible version"))a+="：PDF版本不兼容，请尝试使用其他PDF编辑器重新保存文件";else if(s.includes("parseTrailerDict"))a+="：PDF文件结构损坏，无法解析";else if(s.includes("xRefTable failed"))a+="：PDF交叉引用表损坏，文件可能已损坏";else{a+=`：${s.substring(0,150).replace(/\n/g," ")}${s.length>150?"...":""}`}}else a+=": "+e.message;$a.value=a,M.error(a)}finally{Da.value=!1,Ta.value=null}}},Xa=async()=>{if(!Ma.value)throw new Error("No file selected");const e=await Ma.value.arrayBuffer(),a=new Uint8Array(e),s={mode:ja.value,imageQuality:"high"===Fa.value?50:"medium"===Fa.value?75:90,removeMetadata:Aa.value,removePageThumbnails:!0,removeUnusedObjects:!0,linearize:Va.value};let t;switch("encrypt"===ja.value&&Ea.value?(s.password=Ea.value,s.userPassword=Ba.value,s.permissions=Wa.value,s.encryptionMode=Ia.value,s.keyLength=Ra.value):"decrypt"===ja.value&&qa.value?s.password=qa.value:["split","extract"].includes(ja.value)&&Oa.value&&(s.pages=Oa.value),"extract"===ja.value&&(s.outputFormat=_a.value),ja.value){case"validate":const e=await F.validatePDF(a,e=>{Ta.value=e});return e.isValid?M.success("PDF 文件验证通过"):M.warning(`PDF 文件验证失败：${e.errors.join(", ")}`),{bytes:new Uint8Array(0),size:0,ratio:0};case"encrypt":if(!Ea.value)throw new Error("加密操作需要设置密码");t=await F.encryptPDF(a,Ea.value,Wa.value,e=>{Ta.value=e});break;case"decrypt":if(!qa.value)throw new Error("解密操作需要输入密码");t=await F.decryptPDF(a,qa.value,e=>{Ta.value=e});break;case"split":t=await F.splitPDF(a,Oa.value,e=>{Ta.value=e});break;case"extract":t=await F.extractFromPDF(a,_a.value,Oa.value,e=>{Ta.value=e});break;case"info":await F.getPdfInfo(a,e=>{Ta.value=e});return M.success("PDF 信息获取完成，请查看控制台"),{bytes:new Uint8Array(0),size:0,ratio:0};default:t=await F.optimizePDF(a,s,e=>{Ta.value=e})}return{bytes:t.compressedData,size:t.compressedSize,ratio:t.compressionRatio}},Ya=async()=>{if(!Ma.value)throw new Error("No file selected");const e=await Ma.value.arrayBuffer(),a=[];try{const s=await es(e);a.push({...s,strategy:"基础优化"})}catch(s){}try{const s=await as(e);a.push({...s,strategy:"激进重构"})}catch(s){}try{const s=await ss(e);a.push({...s,strategy:"内容简化"})}catch(s){}try{const s=await is(e);a.push({...s,strategy:"极限压缩"})}catch(s){}if(a.length>0){return a.reduce((e,a)=>a.ratio>e.ratio?a:e)}return await ts(e)},es=async e=>{const a=await x.load(e);if(Aa.value)try{a.setTitle(""),a.setAuthor(""),a.setSubject(""),a.setKeywords([]),a.setProducer("WebTool PDF Compressor"),a.setCreator("WebTool")}catch(i){}const s=a.getPages();for(let n=0;n<s.length;n++){const e=s[n];try{const{width:a,height:s}=e.getSize();if(a>1e3||s>1e3){const a="high"===Fa.value?.85:.95;e.scale(a,a)}}catch(i){}}const t=await a.save({useObjectStreams:!0,objectsPerTick:50,updateFieldAppearances:!1}),l=t.byteLength,o=e.byteLength,r=Math.round((o-l)/o*100);return{bytes:t,size:l,ratio:Math.max(r,0)}},as=async e=>{const a=await x.load(e),s=await x.create(),t=a.getPageCount();for(let c=0;c<t;c++)try{const[e]=await s.copyPages(a,[c]),{width:t,height:l}=e.getSize();let o=1;o="high"===Fa.value?Math.min(.6,1e3/Math.max(t,l)):"medium"===Fa.value?Math.min(.75,1300/Math.max(t,l)):Math.min(.85,1600/Math.max(t,l)),o<1&&e.scale(o,o),s.addPage(e)}catch(n){}try{s.setTitle(""),s.setAuthor(""),s.setSubject(""),s.setKeywords([]),s.setProducer("WebTool"),s.setCreator("WebTool")}catch(n){}const l=await s.save({useObjectStreams:!0,objectsPerTick:300,updateFieldAppearances:!1}),o=l.byteLength,r=e.byteLength,i=Math.round((r-o)/r*100);return{bytes:l,size:o,ratio:Math.max(i,0)}},ss=async e=>{const a=await x.load(e),s=a.getPages();for(let n=0;n<s.length;n++){const e=s[n];try{const{width:a,height:s}=e.getSize(),t="high"===Fa.value?800:1200;if(a>t||s>t){const l=t/Math.max(a,s);e.scale(l,l)}}catch(i){}}if(Aa.value)try{a.setTitle(""),a.setAuthor(""),a.setSubject(""),a.setKeywords([]),a.setProducer(""),a.setCreator("")}catch(i){}const t=await a.save({useObjectStreams:!0,objectsPerTick:100,updateFieldAppearances:!1}),l=t.byteLength,o=e.byteLength,r=Math.round((o-l)/o*100);return{bytes:t,size:l,ratio:Math.max(r,0)}},ts=async e=>{try{const a=await x.load(e),s=await a.save({useObjectStreams:!0,objectsPerTick:500,updateFieldAppearances:!1}),t=s.byteLength,l=e.byteLength,o=Math.round((l-t)/l*100);return{bytes:s,size:t,ratio:Math.max(o,0)}}catch(a){return{bytes:new Uint8Array(e),size:e.byteLength,ratio:0}}},ls=()=>{if("pdfcpu"!==za.value)return C("tools.pdfCompressor.actions.compress");switch(ja.value){case"optimize":return"优化 PDF";case"compress":return"压缩 PDF";case"info":return"获取信息";case"validate":return"验证文件";case"encrypt":return"加密文件";case"decrypt":return"解密文件";case"split":return"拆分文件";case"merge":return"合并文件";case"extract":return"提取内容";default:return"处理文件"}},os=()=>{if("pdfcpu"!==za.value)return C("tools.pdfCompressor.actions.compressing");switch(ja.value){case"optimize":return"正在优化...";case"compress":return"正在压缩...";case"info":return"正在分析...";case"validate":return"正在验证...";case"encrypt":return"正在加密...";case"decrypt":return"正在解密...";case"split":return"正在拆分...";case"merge":return"正在合并...";case"extract":return"正在提取...";default:return"正在处理..."}},rs=()=>{if(!xa.value||!Ma.value)return;const e=URL.createObjectURL(xa.value),a=document.createElement("a");a.href=e,a.download=Ma.value.name.replace(".pdf","_compressed.pdf"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(e),M.success(C("tools.pdfCompressor.messages.downloadSuccess"))},is=async e=>{const a=await x.load(e),s=await x.create(),t=a.getPageCount();for(let c=0;c<t;c++)try{const[e]=await s.copyPages(a,[c]),{width:t,height:l}=e.getSize();let o=.5;const r=Math.max(t,l);r>2e3?o=.3:r>1500?o=.4:r<500&&(o=.7),e.scale(o,o),s.addPage(e)}catch(n){}try{s.setTitle(""),s.setAuthor(""),s.setSubject(""),s.setKeywords([]),s.setProducer(""),s.setCreator("")}catch(n){}const l=await s.save({useObjectStreams:!0,objectsPerTick:500,updateFieldAppearances:!1}),o=l.byteLength,r=e.byteLength,i=Math.round((r-o)/r*100);return{bytes:l,size:o,ratio:Math.max(i,0)}};return l(async()=>{(async()=>{Sa.value=!0;try{if(!D.isWasmSupported())return void(La.value=!1);await F.initialize(),La.value=!0,M.success("pdfcpu 引擎初始化成功，现在可以使用高性能压缩")}catch(e){La.value=!1,"pdfcpu"===za.value&&(za.value="pdf-lib",M.warning("pdfcpu 引擎初始化失败，已自动切换到 PDF-lib 引擎"))}finally{Sa.value=!1}})().catch(console.error)}),o(()=>{F.dispose()}),(e,a)=>(P(),r("div",z,[i("div",V,[i("div",A,[a[19]||(a[19]=i("div",{class:"header-icon"},[i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[i("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"}),i("path",{d:"M8 12h8M8 16h8M8 8h2","stroke-width":"1.5","stroke-linecap":"round"})])],-1)),i("div",T,[i("h1",null,n(e.$t("tools.pdfCompressor.title")),1),i("p",null,n(e.$t("tools.pdfCompressor.description")),1)])]),a[20]||(a[20]=i("div",{class:"header-decoration"},[i("div",{class:"decoration-circle circle-1"}),i("div",{class:"decoration-circle circle-2"}),i("div",{class:"decoration-circle circle-3"})],-1))]),i("div",L,[i("div",S,[i("div",{class:d(["upload-area",{"drag-over":Ca.value,"has-file":Ma.value,uploading:Da.value}]),onDrop:Za,onDragover:a[0]||(a[0]=u(e=>Ca.value=!0,["prevent"])),onDragleave:a[1]||(a[1]=e=>Ca.value=!1),onClick:Ka},[a[26]||(a[26]=i("div",{class:"upload-background"},[i("div",{class:"upload-pattern"})],-1)),i("input",{ref_key:"fileInput",ref:Pa,type:"file",accept:".pdf",style:{display:"none"},onChange:Na},null,544),Ma.value?(P(),r("div",E,[a[25]||(a[25]=p('<div class="file-preview" data-v-4dc1cd59><div class="file-icon-wrapper" data-v-4dc1cd59><svg class="file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-4dc1cd59><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" data-v-4dc1cd59></path></svg><div class="file-type-label" data-v-4dc1cd59> PDF </div></div></div>',1)),i("div",B,[i("div",W,[i("h4",I,n(Ma.value.name),1),i("div",R,[i("span",q,n(Ja(Ma.value.size)),1),a[23]||(a[23]=i("span",{class:"file-status"},"✓ 已选择",-1))])]),i("button",{class:"remove-file",onClick:u(Ga,["stop"])},[a[24]||(a[24]=i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[i("path",{d:"M18 6L6 18M6 6l12 12"})],-1)),v(" "+n(e.$t("common.remove")),1)])])])):(P(),r("div",$,[a[22]||(a[22]=p('<div class="upload-icon-container" data-v-4dc1cd59><svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-4dc1cd59><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" data-v-4dc1cd59></path><polyline points="7,10 12,15 17,10" data-v-4dc1cd59></polyline><line x1="12" y1="15" x2="12" y2="3" data-v-4dc1cd59></line></svg><div class="upload-pulse" data-v-4dc1cd59></div></div>',1)),i("div",U,[i("h3",null,n(e.$t("tools.pdfCompressor.uploadArea.title")),1),i("p",null,n(e.$t("tools.pdfCompressor.uploadArea.description")),1),i("div",H,[a[21]||(a[21]=i("span",{class:"file-type-badge"},"PDF",-1)),i("span",j,n(e.$t("tools.pdfCompressor.uploadArea.supportedFormats")),1)])])]))],34)]),Ma.value?(P(),r("div",O,[i("div",_,[a[27]||(a[27]=i("div",{class:"settings-icon"},[i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[i("circle",{cx:"12",cy:"12",r:"3"}),i("path",{d:"M12 1v6m0 6v6m11-7h-6m-6 0H1"})])],-1)),i("h3",null,n(e.$t("tools.pdfCompressor.settings.title")),1)]),i("div",K,[i("label",null,n(e.$t("tools.pdfCompressor.settings.engine")),1),i("div",Z,[i("label",N,[m(i("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>za.value=e),type:"radio",value:"pdf-lib"},null,512),[[y,za.value]]),a[28]||(a[28]=i("span",null,"PDF-lib",-1)),a[29]||(a[29]=i("small",null,"轻量级 JavaScript 引擎，快速处理",-1)),a[30]||(a[30]=i("span",{class:"engine-status available"},"✓ 可用",-1))]),i("label",{class:d(["radio-option",{disabled:!La.value,loading:Sa.value}])},[m(i("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>za.value=e),type:"radio",value:"pdfcpu",disabled:!La.value||Sa.value},null,8,G),[[y,za.value]]),a[31]||(a[31]=i("span",null,"PDFcpu",-1)),Sa.value?(P(),r("small",J,"正在初始化 Go WASM 引擎...")):La.value?(P(),r("small",Q,"Go 语言 WASM 引擎，高性能处理")):(P(),r("small",X,"初始化失败，已回退到 PDF-lib")),Sa.value?(P(),r("span",Y,"⏳ 加载中")):La.value?(P(),r("span",ee,"✓ 可用")):(P(),r("span",ae,"✗ 不可用"))],2)])]),"pdfcpu"===za.value?(P(),r("div",se,[a[33]||(a[33]=i("label",null,"pdfcpu 操作",-1)),i("div",te,[a[32]||(a[32]=i("p",null,[i("strong",null,"调试信息:")],-1)),i("p",null,"引擎: "+n(za.value),1),i("p",null,"选择的类别: "+n(Ha.value),1),i("p",null,"操作类别数量: "+n(fa.value.length),1),i("p",null,"过滤后的模式数量: "+n(ba.value.length),1),i("p",null,"当前 pdfcpu 模式: "+n(ja.value),1)]),i("div",le,[i("div",oe,[(P(!0),r(g,null,h(fa.value,e=>(P(),r("div",{key:e.key,class:d(["operation-category",{active:Ha.value===e.key}]),onClick:a=>Ha.value=e.key},[i("div",ie,[(P(),r("svg",ne,[i("path",{d:e.icon},null,8,ce)]))]),i("div",ue,[i("h4",null,n(e.name),1),i("p",null,n(e.description),1)])],10,re))),128))]),i("div",de,[(P(!0),r(g,null,h(ba.value,e=>(P(),r("label",{key:e.value,class:"radio-option mode-option"},[m(i("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>ja.value=e),type:"radio",value:e.value},null,8,pe),[[y,ja.value]]),i("span",ve,n(e.label),1),i("small",me,n(e.description),1)]))),128))])])])):c("",!0),"pdfcpu"===za.value&&ka.value?(P(),r("div",ye,[a[50]||(a[50]=i("label",null,"命令选项",-1)),"encrypt"===ja.value?(P(),r("div",ge,[i("div",he,[a[34]||(a[34]=i("label",null,"拥有者密码 (必需)",-1)),m(i("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>Ea.value=e),type:"password",placeholder:"设置拥有者密码",class:"option-input",required:""},null,512),[[f,Ea.value]]),a[35]||(a[35]=i("small",null,"拥有者密码用于完全访问 PDF",-1))]),i("div",fe,[a[36]||(a[36]=i("label",null,"用户密码 (可选)",-1)),m(i("input",{"onUpdate:modelValue":a[6]||(a[6]=e=>Ba.value=e),type:"password",placeholder:"设置用户密码",class:"option-input"},null,512),[[f,Ba.value]]),a[37]||(a[37]=i("small",null,"用户密码用于查看受限制的 PDF",-1))]),i("div",we,[a[39]||(a[39]=i("label",null,"加密模式",-1)),m(i("select",{"onUpdate:modelValue":a[7]||(a[7]=e=>Ia.value=e),class:"option-select"},a[38]||(a[38]=[i("option",{value:"aes"}," AES (推荐) ",-1),i("option",{value:"rc4"}," RC4 (兼容旧版) ",-1)]),512),[[w,Ia.value]])]),i("div",be,[a[41]||(a[41]=i("label",null,"密钥长度",-1)),m(i("select",{"onUpdate:modelValue":a[8]||(a[8]=e=>Ra.value=e),class:"option-select"},a[40]||(a[40]=[i("option",{value:"256"}," 256 位 (最强) ",-1),i("option",{value:"128"}," 128 位 (标准) ",-1),i("option",{value:"40"}," 40 位 (兼容) ",-1)]),512),[[w,Ra.value]])]),i("div",ke,[a[43]||(a[43]=i("label",null,"权限",-1)),m(i("select",{"onUpdate:modelValue":a[9]||(a[9]=e=>Wa.value=e),class:"option-select"},a[42]||(a[42]=[i("option",{value:"all"}," 允许所有操作 ",-1),i("option",{value:"print"}," 仅允许打印 ",-1),i("option",{value:"none"}," 禁止所有操作 ",-1)]),512),[[w,Wa.value]])])])):c("",!0),"decrypt"===ja.value?(P(),r("div",Pe,[i("div",Me,[a[44]||(a[44]=i("label",null,"密码",-1)),m(i("input",{"onUpdate:modelValue":a[10]||(a[10]=e=>qa.value=e),type:"password",placeholder:"输入 PDF 密码",class:"option-input"},null,512),[[f,qa.value]])])])):c("",!0),["split","extract"].includes(ja.value)?(P(),r("div",xe,[i("div",Ce,[a[45]||(a[45]=i("label",null,"页面选择",-1)),m(i("input",{"onUpdate:modelValue":a[11]||(a[11]=e=>Oa.value=e),type:"text",placeholder:"例如: 1-5,10,15-20",class:"option-input"},null,512),[[f,Oa.value]]),a[46]||(a[46]=i("small",null,"支持范围 (1-5) 和单页 (10)，用逗号分隔",-1))])])):c("",!0),"extract"===ja.value?(P(),r("div",De,[i("div",Fe,[a[49]||(a[49]=i("label",null,"提取内容",-1)),i("div",ze,[i("label",Ve,[m(i("input",{"onUpdate:modelValue":a[12]||(a[12]=e=>_a.value=e),type:"radio",value:"images"},null,512),[[y,_a.value]]),a[47]||(a[47]=i("span",null,"图片",-1))]),i("label",Ae,[m(i("input",{"onUpdate:modelValue":a[13]||(a[13]=e=>_a.value=e),type:"radio",value:"text"},null,512),[[y,_a.value]]),a[48]||(a[48]=i("span",null,"文本",-1))])])])])):c("",!0)])):c("",!0),"pdf-lib"===za.value?(P(),r("div",Te,[i("div",Le,[i("label",null,n(e.$t("tools.pdfCompressor.settings.quality")),1),i("div",Se,[i("label",$e,[m(i("input",{"onUpdate:modelValue":a[14]||(a[14]=e=>Fa.value=e),type:"radio",value:"low"},null,512),[[y,Fa.value]]),i("span",null,n(e.$t("tools.pdfCompressor.settings.qualityLevels.low")),1),i("small",null,n(e.$t("tools.pdfCompressor.settings.qualityLevels.lowDesc")),1)]),i("label",Ue,[m(i("input",{"onUpdate:modelValue":a[15]||(a[15]=e=>Fa.value=e),type:"radio",value:"medium"},null,512),[[y,Fa.value]]),i("span",null,n(e.$t("tools.pdfCompressor.settings.qualityLevels.medium")),1),i("small",null,n(e.$t("tools.pdfCompressor.settings.qualityLevels.mediumDesc")),1)]),i("label",He,[m(i("input",{"onUpdate:modelValue":a[16]||(a[16]=e=>Fa.value=e),type:"radio",value:"high"},null,512),[[y,Fa.value]]),i("span",null,n(e.$t("tools.pdfCompressor.settings.qualityLevels.high")),1),i("small",null,n(e.$t("tools.pdfCompressor.settings.qualityLevels.highDesc")),1)])])]),i("div",je,[i("label",Ee,[m(i("input",{"onUpdate:modelValue":a[17]||(a[17]=e=>Va.value=e),type:"checkbox"},null,512),[[b,Va.value]]),i("span",null,n(e.$t("tools.pdfCompressor.settings.optimizeImages")),1)])]),i("div",Be,[i("label",We,[m(i("input",{"onUpdate:modelValue":a[18]||(a[18]=e=>Aa.value=e),type:"checkbox"},null,512),[[b,Aa.value]]),i("span",null,n(e.$t("tools.pdfCompressor.settings.removeMetadata")),1)])])])):c("",!0)])):c("",!0),Da.value&&Ta.value?(P(),r("div",Ie,[i("div",Re,[i("h4",null,n(Ta.value.message||"正在处理..."),1),i("span",qe,n(Math.round(Ta.value.progress||0))+"%",1)]),i("div",Oe,[i("div",{class:"progress-fill",style:k({width:`${Ta.value.progress||0}%`})},null,4)]),i("div",_e,n(Ta.value.stage||"处理中"),1),i("div",Ke," 引擎: "+n("pdfcpu"===za.value?"PDFcpu":"PDF-lib"),1)])):c("",!0),Ma.value?(P(),r("div",Ze,[i("button",{class:d(["btn btn-primary compress-btn",{loading:Da.value}]),disabled:Da.value,onClick:Qa},[i("div",Ge,[Da.value?(P(),r("svg",Je,a[51]||(a[51]=[i("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor","stroke-width":"2",opacity:"0.3"},null,-1),i("path",{d:"M12,2 A10,10 0 0,1 22,12",fill:"none",stroke:"currentColor","stroke-width":"2"},[i("animateTransform",{attributeName:"transform",type:"rotate",dur:"1s",repeatCount:"indefinite",values:"0 12 12;360 12 12"})],-1)]))):(P(),r("svg",Qe,a[52]||(a[52]=[i("path",{d:"M3 12h18m-9-9l9 9-9 9"},null,-1),i("path",{d:"M8 8l4-4 4 4M8 16l4 4 4-4"},null,-1)]))),i("span",null,n(Da.value?os():ls()),1)]),a[53]||(a[53]=i("div",{class:"btn-shine"},null,-1))],10,Ne),xa.value?(P(),r("button",{key:0,class:"btn btn-success download-btn",onClick:rs},[i("div",Xe,[a[54]||(a[54]=i("svg",{class:"download-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[i("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),i("polyline",{points:"7,10 12,15 17,10"}),i("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1)),i("span",null,n(e.$t("tools.pdfCompressor.actions.download")),1)]),a[55]||(a[55]=i("div",{class:"btn-shine"},null,-1))])):c("",!0)])):c("",!0),Ua.value?(P(),r("div",Ye,[i("div",ea,[a[56]||(a[56]=i("div",{class:"result-icon"},[i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[i("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),i("polyline",{points:"22,4 12,14.01 9,11.01"})])],-1)),i("h3",null,n(e.$t("tools.pdfCompressor.results.title")),1)]),i("div",aa,[i("div",sa,[a[57]||(a[57]=i("div",{class:"stat-icon"},[i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[i("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})])],-1)),i("div",ta,[i("span",la,n(e.$t("tools.pdfCompressor.results.originalSize")),1),i("span",oa,n(Ja(Ua.value.originalSize)),1)])]),a[60]||(a[60]=i("div",{class:"stat-arrow"},[i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[i("path",{d:"M5 12h14m-7-7l7 7-7 7"})])],-1)),i("div",ra,[a[58]||(a[58]=i("div",{class:"stat-icon"},[i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[i("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"}),i("path",{d:"M8 12h8M8 16h6"})])],-1)),i("div",ia,[i("span",na,n(e.$t("tools.pdfCompressor.results.compressedSize")),1),i("span",ca,n(Ja(Ua.value.compressedSize)),1)])]),i("div",ua,[i("div",da,[(P(),r("svg",pa,[a[59]||(a[59]=i("path",{class:"circle-bg",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"},null,-1)),i("path",{class:"circle","stroke-dasharray":`${Math.abs(Ua.value.ratio)}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"},null,8,va)])),i("div",ma,[i("span",ya,n(Math.abs(Ua.value.ratio))+"%",1)])]),i("span",ga,n(e.$t("tools.pdfCompressor.results.compressionRatio")),1)])])])):c("",!0),$a.value?(P(),r("div",ha,[a[61]||(a[61]=i("svg",{class:"error-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[i("circle",{cx:"12",cy:"12",r:"10"}),i("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),i("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1)),i("p",null,n($a.value),1)])):c("",!0)])]))}}),[["__scopeId","data-v-4dc1cd59"]]);export{fa as default};
