import{a as e,u as t,r as s,c as a,e as l,f as n,t as o,y as r,I as u,J as c,Q as i,M as d,F as m,g as p,n as v,x,G as y,j as g,H as A}from"./vendor-GAldOsJ5.js";import{s as h}from"./toast-BhoKftcT.js";import{_ as b}from"./index-DcaCmn-e.js";import"./qr-DE_AbQYC.js";const T={class:"tool-container"},E={class:"tool-header"},C={class:"tool-content"},f={class:"formula-input-section"},k={class:"formula-editor"},D={class:"editor-header"},R={for:"formula-input"},$={class:"editor-actions"},F=["placeholder","onKeydown"],S={class:"formula-help"},B={class:"function-categories"},O={class:"category-tabs"},I=["onClick"],N={class:"function-grid"},M=["title","onClick"],U={class:"function-name"},w={class:"function-syntax"},L={class:"test-data-section"},V={class:"data-tabs"},G=["onClick"],H={key:0,class:"manual-data"},P={class:"spreadsheet-container"},j={class:"spreadsheet"},K=["onUpdate:modelValue","placeholder","onInput"],_={class:"spreadsheet-actions"},Y={key:1,class:"sample-data"},W={class:"sample-datasets"},Q=["onClick"],X={class:"sample-preview"},z={key:0,class:"results-section"},q={class:"result-display"},Z={class:"result-header"},J={class:"result-label"},ee={class:"formula-display"},te={class:"result-content"},se={key:0,class:"success-result"},ae={class:"result-value"},le={class:"value-label"},ne={class:"value-content"},oe={key:0,class:"result-type"},re={class:"type-label"},ue={class:"type-content"},ce={key:1,class:"calculation-steps"},ie={class:"steps-list"},de={class:"step-number"},me={class:"step-description"},pe={key:1,class:"error-result"},ve={class:"error-message"},xe={key:0,class:"error-suggestions"},ye={class:"suggestions-list"},ge={class:"result-actions"},Ae={class:"examples-section"},he={class:"examples-grid"},be=["onClick"],Te={class:"example-formula"},Ee={key:1,class:"getting-started"},Ce={class:"getting-started-content"},fe={class:"quick-start-steps"},ke={class:"step"},De={class:"step-content"},Re={class:"step"},$e={class:"step-content"},Fe={class:"step"},Se={class:"step-content"},Be=b(e({__name:"ExcelFormulaTester",setup(e){const{t:b}=t(),Be=()=>A("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[A("path",{d:"M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]),Oe=()=>A("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[A("circle",{cx:"12",cy:"12",r:"10"}),A("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),A("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]),Ie=s(""),Ne=s("math"),Me=s("manual"),Ue=s({}),we=s(null),Le=s(["A","B","C","D","E"]),Ve=s([1,2,3,4,5]),Ge=[{key:"math"},{key:"text"},{key:"logical"},{key:"date"},{key:"lookup"}],He=[{key:"manual"},{key:"sample"}],Pe={math:[{name:"SUM",syntax:"SUM(range)",description:"Adds all numbers in a range"},{name:"AVERAGE",syntax:"AVERAGE(range)",description:"Calculates the average of numbers"},{name:"COUNT",syntax:"COUNT(range)",description:"Counts cells containing numbers"},{name:"MAX",syntax:"MAX(range)",description:"Returns the largest value"},{name:"MIN",syntax:"MIN(range)",description:"Returns the smallest value"},{name:"ROUND",syntax:"ROUND(number, digits)",description:"Rounds a number to specified digits"},{name:"ABS",syntax:"ABS(number)",description:"Returns absolute value"},{name:"SQRT",syntax:"SQRT(number)",description:"Returns square root"},{name:"POWER",syntax:"POWER(base, exponent)",description:"Returns base raised to exponent"},{name:"MOD",syntax:"MOD(number, divisor)",description:"Returns remainder after division"}],text:[{name:"CONCATENATE",syntax:"CONCATENATE(text1, text2, ...)",description:"Joins text strings"},{name:"LEFT",syntax:"LEFT(text, num_chars)",description:"Returns leftmost characters"},{name:"RIGHT",syntax:"RIGHT(text, num_chars)",description:"Returns rightmost characters"},{name:"MID",syntax:"MID(text, start, length)",description:"Returns middle characters"},{name:"LEN",syntax:"LEN(text)",description:"Returns length of text"},{name:"UPPER",syntax:"UPPER(text)",description:"Converts to uppercase"},{name:"LOWER",syntax:"LOWER(text)",description:"Converts to lowercase"},{name:"TRIM",syntax:"TRIM(text)",description:"Removes extra spaces"},{name:"FIND",syntax:"FIND(find_text, within_text)",description:"Finds position of text"},{name:"SUBSTITUTE",syntax:"SUBSTITUTE(text, old, new)",description:"Replaces text"}],logical:[{name:"IF",syntax:"IF(condition, true_value, false_value)",description:"Returns value based on condition"},{name:"AND",syntax:"AND(condition1, condition2, ...)",description:"Returns TRUE if all conditions are true"},{name:"OR",syntax:"OR(condition1, condition2, ...)",description:"Returns TRUE if any condition is true"},{name:"NOT",syntax:"NOT(condition)",description:"Reverses logical value"},{name:"ISNUMBER",syntax:"ISNUMBER(value)",description:"Tests if value is a number"},{name:"ISTEXT",syntax:"ISTEXT(value)",description:"Tests if value is text"},{name:"ISBLANK",syntax:"ISBLANK(value)",description:"Tests if cell is empty"},{name:"ISERROR",syntax:"ISERROR(value)",description:"Tests if value is an error"}],date:[{name:"TODAY",syntax:"TODAY()",description:"Returns current date"},{name:"NOW",syntax:"NOW()",description:"Returns current date and time"},{name:"DATE",syntax:"DATE(year, month, day)",description:"Creates date from components"},{name:"YEAR",syntax:"YEAR(date)",description:"Extracts year from date"},{name:"MONTH",syntax:"MONTH(date)",description:"Extracts month from date"},{name:"DAY",syntax:"DAY(date)",description:"Extracts day from date"},{name:"WEEKDAY",syntax:"WEEKDAY(date)",description:"Returns day of week"},{name:"DATEDIF",syntax:"DATEDIF(start, end, unit)",description:"Calculates difference between dates"}],lookup:[{name:"VLOOKUP",syntax:"VLOOKUP(lookup, table, col, exact)",description:"Vertical lookup"},{name:"HLOOKUP",syntax:"HLOOKUP(lookup, table, row, exact)",description:"Horizontal lookup"},{name:"INDEX",syntax:"INDEX(array, row, col)",description:"Returns value at position"},{name:"MATCH",syntax:"MATCH(lookup, array, type)",description:"Returns position of value"},{name:"CHOOSE",syntax:"CHOOSE(index, value1, value2, ...)",description:"Chooses value by index"}]},je=[{key:"sales",size:"5x4",data:{A1:"Product",B1:"Q1",C1:"Q2",D1:"Q3",E1:"Q4",A2:"Laptop",B2:"15000",C2:"18000",D2:"22000",E2:"25000",A3:"Phone",B3:"12000",C3:"14000",D3:"16000",E3:"18000",A4:"Tablet",B4:"8000",C4:"9000",D4:"10000",E4:"11000",A5:"Total",B5:"=SUM(B2:B4)",C5:"=SUM(C2:C4)",D5:"=SUM(D2:D4)",E5:"=SUM(E2:E4)"}},{key:"grades",size:"6x4",data:{A1:"Student",B1:"Math",C1:"Science",D1:"English",E1:"Average",A2:"Alice",B2:"85",C2:"92",D2:"88",E2:"=AVERAGE(B2:D2)",A3:"Bob",B3:"78",C3:"85",D3:"82",E3:"=AVERAGE(B3:D3)",A4:"Carol",B4:"92",C4:"89",D4:"94",E4:"=AVERAGE(B4:D4)",A5:"David",B5:"88",C5:"91",D5:"87",E5:"=AVERAGE(B5:D5)",A6:"Class Avg",B6:"=AVERAGE(B2:B5)",C6:"=AVERAGE(C2:C5)",D6:"=AVERAGE(D2:D5)",E6:"=AVERAGE(E2:E5)"}},{key:"budget",size:"8x3",data:{A1:"Category",B1:"Budget",C1:"Actual",D1:"Variance",A2:"Housing",B2:"2000",C2:"1950",D2:"=C2-B2",A3:"Food",B3:"600",C3:"650",D3:"=C3-B3",A4:"Transport",B4:"400",C4:"380",D4:"=C4-B4",A5:"Entertainment",B5:"300",C5:"320",D5:"=C5-B5",A6:"Utilities",B6:"200",C6:"180",D6:"=C6-B6",A7:"Other",B7:"500",C7:"520",D7:"=C7-B7",A8:"Total",B8:"=SUM(B2:B7)",C8:"=SUM(C2:C7)",D8:"=SUM(D2:D7)"}}],Ke=[{name:"Basic Sum",description:"Calculate total of a range",formula:"=SUM(A1:A5)"},{name:"Conditional Logic",description:"Grade based on score",formula:'=IF(A1>=90,"A",IF(A1>=80,"B",IF(A1>=70,"C","F")))'},{name:"Text Manipulation",description:"Combine first and last name",formula:'=CONCATENATE(A1," ",B1)'},{name:"Date Calculation",description:"Calculate age from birthdate",formula:'=DATEDIF(A1,TODAY(),"Y")'},{name:"Lookup Function",description:"Find value in table",formula:"=VLOOKUP(A1,B:D,2,FALSE)"},{name:"Statistical Analysis",description:"Calculate standard deviation",formula:"=SQRT(AVERAGE((A1:A10-AVERAGE(A1:A10))^2))"}],_e=a(()=>Pe[Ne.value]||[]),Ye=()=>{const e=Math.max(...Ve.value)+1;Ve.value.push(e)},We=()=>{const e=Le.value[Le.value.length-1],t=String.fromCharCode(e.charCodeAt(0)+1);Le.value.push(t)},Qe=()=>{Ue.value={}},Xe=()=>{Ie.value="",we.value=null},ze=()=>{if(Ie.value.trim())try{const e=qe(Ie.value);we.value={success:!0,formula:Ie.value,result:e.value,type:e.type,steps:e.steps||[]}}catch(e){we.value={success:!1,formula:Ie.value,error:e.message,suggestions:st(e.message)}}else we.value=null},qe=e=>{const t=e.startsWith("=")?e.substring(1):e,s=Ze(t);try{const t=Je(s);return{value:t,type:typeof t,steps:[`Original: ${e}`,`Processed: ${s}`,`Result: ${t}`]}}catch(a){throw new Error(`Formula evaluation error: ${a}`)}},Ze=e=>e.replace(/([A-Z]+)(\d+)/g,e=>{const t=Ue.value[e]||"0";return isNaN(Number(t))?`"${t}"`:t}),Je=e=>{e=et(e);try{return Function(`"use strict"; return (${e})`)()}catch(t){throw new Error("Invalid expression")}},et=e=>e=(e=(e=(e=(e=e.replace(/SUM\(([^)]+)\)/g,(e,t)=>tt(t).reduce((e,t)=>e+(Number(t)||0),0).toString())).replace(/AVERAGE\(([^)]+)\)/g,(e,t)=>{const s=tt(t);return(s.reduce((e,t)=>e+(Number(t)||0),0)/s.length).toString()})).replace(/COUNT\(([^)]+)\)/g,(e,t)=>tt(t).filter(e=>!isNaN(Number(e))).length.toString())).replace(/MAX\(([^)]+)\)/g,(e,t)=>{const s=tt(t).map(e=>Number(e)||0);return Math.max(...s).toString()})).replace(/MIN\(([^)]+)\)/g,(e,t)=>{const s=tt(t).map(e=>Number(e)||0);return Math.min(...s).toString()}),tt=e=>{if(e.includes(":")){const[t,s]=e.split(":"),a=t.match(/[A-Z]+/)?.[0]||"A",l=parseInt(t.match(/\d+/)?.[0]||"1"),n=s.match(/[A-Z]+/)?.[0]||"A",o=parseInt(s.match(/\d+/)?.[0]||"1"),r=[];for(let e=l;e<=o;e++)for(let t=a.charCodeAt(0);t<=n.charCodeAt(0);t++){const s=`${String.fromCharCode(t)}${e}`;r.push(Ue.value[s]||"0")}return r}return e.split(",").map(e=>{const t=e.trim();return Ue.value[t]||t})},st=e=>{const t=[];return e.includes("reference")&&(t.push("Check that all cell references exist in your data"),t.push("Make sure cell references use correct format (e.g., A1, B2)")),e.includes("syntax")&&(t.push("Check for missing parentheses or commas"),t.push("Verify function names are spelled correctly")),e.includes("evaluation")&&(t.push("Ensure all referenced cells contain valid data"),t.push("Check for circular references")),t},at=async()=>{try{await navigator.clipboard.writeText(Ie.value),h.success(b("tools.excelFormulaTester.messages.formulaCopied"))}catch(e){}},lt=async()=>{if(we.value?.success)try{await navigator.clipboard.writeText(String(we.value.result)),h.success(b("tools.excelFormulaTester.messages.resultCopied"))}catch(e){}},nt=()=>{if(!we.value)return;const e=`Excel Formula Test Report\nGenerated: ${(new Date).toLocaleString()}\n\nFormula: ${we.value.formula}\nSuccess: ${we.value.success}\n${we.value.success?`Result: ${we.value.result}`:`Error: ${we.value.error}`}\n\nTest Data:\n${Object.entries(Ue.value).map(([e,t])=>`${e}: ${t}`).join("\n")}\n`,t=new Blob([e],{type:"text/plain"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`excel-formula-test-${Date.now()}.txt`,a.click(),URL.revokeObjectURL(s)};return(e,t)=>{return g(),l("div",T,[n("div",E,[n("h1",null,o(e.$t("tools.excelFormulaTester.title")),1),n("p",null,o(e.$t("tools.excelFormulaTester.description")),1)]),n("div",C,[n("div",f,[n("h3",null,o(e.$t("tools.excelFormulaTester.formulaInput.title")),1),n("div",k,[n("div",D,[n("label",R,o(e.$t("tools.excelFormulaTester.formulaInput.label")),1),n("div",$,[n("button",{class:"btn btn-sm btn-secondary",onClick:Xe},o(e.$t("tools.excelFormulaTester.buttons.clear")),1),n("button",{class:"btn btn-sm btn-primary",onClick:ze},o(e.$t("tools.excelFormulaTester.buttons.test")),1)])]),u(n("textarea",{id:"formula-input","onUpdate:modelValue":t[0]||(t[0]=e=>Ie.value=e),placeholder:e.$t("tools.excelFormulaTester.formulaInput.placeholder"),class:"formula-textarea",rows:"4",onKeydown:i(d(ze,["ctrl"]),["enter"])},null,40,F),[[c,Ie.value]]),n("div",S,o(e.$t("tools.excelFormulaTester.formulaInput.help")),1)]),n("div",B,[n("h4",null,o(e.$t("tools.excelFormulaTester.functions.title")),1),n("div",O,[(g(),l(m,null,p(Ge,t=>n("button",{key:t.key,class:v(["tab-button",{active:Ne.value===t.key}]),onClick:e=>Ne.value=t.key},o(e.$t(`tools.excelFormulaTester.functions.categories.${t.key}`)),11,I)),64))]),n("div",N,[(g(!0),l(m,null,p(_e.value,e=>(g(),l("button",{key:e.name,class:"function-button",title:e.description,onClick:t=>(e=>{const t=document.getElementById("formula-input")?.selectionStart||0,s=Ie.value.substring(0,t),a=Ie.value.substring(t);Ie.value=s+e.syntax+a})(e)},[n("span",U,o(e.name),1),n("span",w,o(e.syntax),1)],8,M))),128))])])]),n("div",L,[n("h3",null,o(e.$t("tools.excelFormulaTester.testData.title")),1),n("div",V,[(g(),l(m,null,p(He,t=>n("button",{key:t.key,class:v(["tab-button",{active:Me.value===t.key}]),onClick:e=>Me.value=t.key},o(e.$t(`tools.excelFormulaTester.testData.tabs.${t.key}`)),11,G)),64))]),"manual"===Me.value?(g(),l("div",H,[n("div",P,[n("table",j,[n("thead",null,[n("tr",null,[t[1]||(t[1]=n("th",null,null,-1)),(g(!0),l(m,null,p(Le.value,e=>(g(),l("th",{key:e},o(e),1))),128))])]),n("tbody",null,[(g(!0),l(m,null,p(Ve.value,e=>(g(),l("tr",{key:e},[n("th",null,o(e),1),(g(!0),l(m,null,p(Le.value,t=>(g(),l("td",{key:`${t}${e}`},[u(n("input",{"onUpdate:modelValue":s=>Ue.value[`${t}${e}`]=s,type:"text",class:"cell-input",placeholder:`${t}${e}`,onInput:s=>((e,t)=>{const s=t.target;Ue.value[e]=s.value})(`${t}${e}`,s)},null,40,K),[[c,Ue.value[`${t}${e}`]]])]))),128))]))),128))])])]),n("div",_,[n("button",{class:"btn btn-secondary",onClick:Ye},o(e.$t("tools.excelFormulaTester.buttons.addRow")),1),n("button",{class:"btn btn-secondary",onClick:We},o(e.$t("tools.excelFormulaTester.buttons.addColumn")),1),n("button",{class:"btn btn-secondary",onClick:Qe},o(e.$t("tools.excelFormulaTester.buttons.clearData")),1)])])):r("",!0),"sample"===Me.value?(g(),l("div",Y,[n("div",W,[(g(),l(m,null,p(je,t=>n("div",{key:t.key,class:"sample-card",onClick:e=>(e=>{Ue.value={...e.data},Me.value="manual";const t=Math.max(...Object.keys(e.data).map(e=>parseInt(e.match(/\d+/)?.[0]||"1"))),s=Math.max(...Object.keys(e.data).map(e=>e.charCodeAt(0)-64));for(;Ve.value.length<t;)Ye();for(;Le.value.length<s;)We()})(t)},[n("h4",null,o(e.$t(`tools.excelFormulaTester.sampleData.${t.key}`)),1),n("p",null,o(e.$t(`tools.excelFormulaTester.sampleData.${t.key}Description`)),1),n("div",X,o(t.size),1)],8,Q)),64))])])):r("",!0)]),we.value?(g(),l("div",z,[n("h3",null,o(e.$t("tools.excelFormulaTester.results.title")),1),n("div",q,[n("div",Z,[n("span",J,o(e.$t("tools.excelFormulaTester.results.formula")),1),n("span",{class:v(["result-status",we.value.success?"success":"error"])},o(we.value.success?e.$t("tools.excelFormulaTester.results.success"):e.$t("tools.excelFormulaTester.results.error")),3)]),n("div",ee,[n("code",null,o(we.value.formula),1)]),n("div",te,[we.value.success?(g(),l("div",se,[n("div",ae,[n("span",le,o(e.$t("tools.excelFormulaTester.results.value")),1),n("span",ne,o((s=we.value.result,"number"==typeof s?s.toLocaleString(void 0,{maximumFractionDigits:6}):String(s))),1)]),we.value.type?(g(),l("div",oe,[n("span",re,o(e.$t("tools.excelFormulaTester.results.type")),1),n("span",ue,o(we.value.type),1)])):r("",!0),we.value.steps&&we.value.steps.length>0?(g(),l("div",ce,[n("h4",null,o(e.$t("tools.excelFormulaTester.results.steps")),1),n("div",ie,[(g(!0),l(m,null,p(we.value.steps,(e,t)=>(g(),l("div",{key:t,class:"step-item"},[n("span",de,o(t+1),1),n("span",me,o(e),1)]))),128))])])):r("",!0)])):(g(),l("div",pe,[n("div",ve,[(g(),x(y(Oe),{class:"error-icon"})),n("span",null,o(we.value.error),1)]),we.value.suggestions&&we.value.suggestions.length>0?(g(),l("div",xe,[n("h4",null,o(e.$t("tools.excelFormulaTester.results.suggestions")),1),n("ul",ye,[(g(!0),l(m,null,p(we.value.suggestions,e=>(g(),l("li",{key:e},o(e),1))),128))])])):r("",!0)]))])]),n("div",ge,[n("button",{class:"btn btn-secondary",onClick:at},o(e.$t("tools.excelFormulaTester.buttons.copyFormula")),1),n("button",{class:"btn btn-secondary",onClick:lt},o(e.$t("tools.excelFormulaTester.buttons.copyResult")),1),n("button",{class:"btn btn-secondary",onClick:nt},o(e.$t("tools.excelFormulaTester.buttons.exportTest")),1)])])):r("",!0),n("div",Ae,[n("h3",null,o(e.$t("tools.excelFormulaTester.examples.title")),1),n("div",he,[(g(),l(m,null,p(Ke,e=>n("div",{key:e.name,class:"example-card",onClick:t=>(e=>{Ie.value=e.formula,ze()})(e)},[n("h4",null,o(e.name),1),n("p",null,o(e.description),1),n("code",Te,o(e.formula),1)],8,be)),64))])]),Ie.value||we.value?r("",!0):(g(),l("div",Ee,[n("div",Ce,[(g(),x(y(Be),{class:"getting-started-icon"})),n("h3",null,o(e.$t("tools.excelFormulaTester.gettingStarted.title")),1),n("p",null,o(e.$t("tools.excelFormulaTester.gettingStarted.description")),1),n("div",fe,[n("div",ke,[t[2]||(t[2]=n("div",{class:"step-number"}," 1 ",-1)),n("div",De,[n("h4",null,o(e.$t("tools.excelFormulaTester.gettingStarted.step1")),1),n("p",null,o(e.$t("tools.excelFormulaTester.gettingStarted.step1Description")),1)])]),n("div",Re,[t[3]||(t[3]=n("div",{class:"step-number"}," 2 ",-1)),n("div",$e,[n("h4",null,o(e.$t("tools.excelFormulaTester.gettingStarted.step2")),1),n("p",null,o(e.$t("tools.excelFormulaTester.gettingStarted.step2Description")),1)])]),n("div",Fe,[t[4]||(t[4]=n("div",{class:"step-number"}," 3 ",-1)),n("div",Se,[n("h4",null,o(e.$t("tools.excelFormulaTester.gettingStarted.step3")),1),n("p",null,o(e.$t("tools.excelFormulaTester.gettingStarted.step3Description")),1)])])])])]))])]);var s}}}),[["__scopeId","data-v-6d6ae17e"]]);export{Be as default};
